2024-12-07 15:24:55,613 - INFO - Training cifar100_test_seed1 with the following settings:
2024-12-07 15:24:55,622 - INFO - Command-line arguments: output_dir=exp
 experiment_name=cifar100_test_seed1
 seed=1
 evaluate=False
 dataset_name=cifar100
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 80)
 unlabeled_classes=range(80, 100)
 num_labeled_classes=80
 num_unlabeled_classes=20
 log_path=exp/cifar100_test_seed1-2024-12-07-15-24/logs/log.txt
 model_path=exp/cifar100_test_seed1-2024-12-07-15-24/models/model.pth
 device=cuda
2024-12-07 15:24:55,640 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-07 15:24:58,064 - INFO - Building custom CLIP
2024-12-07 15:24:59,226 - INFO - Turning off gradients in both the image and the text encoder
2024-12-07 15:24:59,228 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 15:25:04,529 - INFO - len of train dataset: 50000
2024-12-07 15:25:04,529 - INFO - len of test dataset: 30000
2024-12-07 15:25:04,538 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 15:25:04,539 - INFO - Selecting 180 high-confidence samples for co-teaching.
2024-12-07 15:26:29,222 - INFO - Before Train Accuracies: All 0.1263 | Old 0.0737 | New 0.2313
2024-12-07 15:26:29,223 - INFO - Before Train Accuracies: All 0.0723 | Old 0.0168 | New 0.1835
2024-12-07 15:31:40,932 - INFO - Epoch 1/200, Total Loss: 6.6241, Base Loss: 4.9864, Con Loss: 1.6377, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 15:31:40,932 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 15:31:40,932 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 15:32:59,454 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.6672 | Old 0.7615 | New 0.4785
2024-12-07 15:32:59,455 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.5570 | Old 0.6562 | New 0.3585
2024-12-07 15:34:17,730 - INFO - Weighted Accuracies: All 0.6539 | Old 0.7167 | New 0.5284
2024-12-07 15:34:18,335 - INFO - Saved model!
2024-12-07 15:39:35,548 - INFO - Epoch 2/200, Total Loss: 4.2256, Base Loss: 2.6983, Con Loss: 1.5273, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 15:39:35,548 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 15:39:35,548 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 15:40:56,622 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.6990 | Old 0.7876 | New 0.5218
2024-12-07 15:40:56,622 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.5986 | Old 0.6883 | New 0.4194
2024-12-07 15:42:17,611 - INFO - Weighted Accuracies: All 0.6511 | Old 0.7615 | New 0.4301
2024-12-07 15:47:35,953 - INFO - Epoch 3/200, Total Loss: 3.8875, Base Loss: 2.4363, Con Loss: 1.4511, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 15:47:35,953 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 15:47:35,953 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 15:48:57,065 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.7281 | Old 0.8052 | New 0.5740
2024-12-07 15:48:57,065 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.6032 | Old 0.7337 | New 0.3422
2024-12-07 15:50:18,152 - INFO - Weighted Accuracies: All 0.6607 | Old 0.7783 | New 0.4255
2024-12-07 15:50:19,010 - INFO - Saved model!
2024-12-07 15:55:38,489 - INFO - Epoch 4/200, Total Loss: 3.7310, Base Loss: 2.3208, Con Loss: 1.4102, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 15:55:38,490 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 15:55:38,490 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 15:56:59,467 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.7247 | Old 0.7980 | New 0.5781
2024-12-07 15:56:59,467 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.6252 | Old 0.7544 | New 0.3667
2024-12-07 15:58:19,895 - INFO - Weighted Accuracies: All 0.6594 | Old 0.7975 | New 0.3832
2024-12-07 16:03:37,789 - INFO - Epoch 5/200, Total Loss: 3.6559, Base Loss: 2.2736, Con Loss: 1.3823, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 16:03:37,789 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 16:03:37,789 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 16:04:59,168 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.7123 | Old 0.8142 | New 0.5085
2024-12-07 16:04:59,168 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.6284 | Old 0.7626 | New 0.3601
2024-12-07 16:06:20,449 - INFO - Weighted Accuracies: All 0.6541 | Old 0.7976 | New 0.3670
2024-12-07 16:11:33,212 - INFO - Epoch 6/200, Total Loss: 3.5545, Base Loss: 2.2089, Con Loss: 1.3456, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 16:11:33,212 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 16:11:33,212 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 16:12:52,273 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.7230 | Old 0.8037 | New 0.5615
2024-12-07 16:12:52,274 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.6437 | Old 0.7759 | New 0.3794
2024-12-07 16:14:11,133 - INFO - Weighted Accuracies: All 0.6519 | Old 0.7825 | New 0.3906
2024-12-07 16:19:22,663 - INFO - Epoch 7/200, Total Loss: 3.5110, Base Loss: 2.1800, Con Loss: 1.3310, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 16:19:22,663 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-07 16:19:22,663 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 16:20:41,923 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.7024 | Old 0.8029 | New 0.5013
2024-12-07 16:20:41,923 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.6630 | Old 0.7779 | New 0.4332
2024-12-07 16:22:00,899 - INFO - Weighted Accuracies: All 0.6490 | Old 0.7862 | New 0.3747
2024-12-07 16:27:11,711 - INFO - Epoch 8/200, Total Loss: 3.4513, Base Loss: 2.1376, Con Loss: 1.3136, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 16:27:11,711 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-07 16:27:11,711 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 16:28:30,667 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.7048 | Old 0.8181 | New 0.4783
2024-12-07 16:28:30,667 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.6713 | Old 0.7768 | New 0.4603
2024-12-07 16:29:50,681 - INFO - Weighted Accuracies: All 0.6420 | Old 0.8121 | New 0.3019
2024-12-07 16:35:09,201 - INFO - Epoch 9/200, Total Loss: 3.3974, Base Loss: 2.1052, Con Loss: 1.2922, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 16:35:09,201 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-07 16:35:09,201 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 16:36:29,799 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.7143 | Old 0.8225 | New 0.4980
2024-12-07 16:36:29,799 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.6725 | Old 0.7880 | New 0.4415
2024-12-07 16:37:51,195 - INFO - Weighted Accuracies: All 0.6446 | Old 0.8057 | New 0.3224
2024-12-07 16:43:09,966 - INFO - Epoch 10/200, Total Loss: 3.3719, Base Loss: 2.0840, Con Loss: 1.2879, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 16:43:09,966 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-07 16:43:09,966 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 16:44:31,248 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.7250 | Old 0.8214 | New 0.5321
2024-12-07 16:44:31,248 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.6712 | Old 0.7899 | New 0.4338
2024-12-07 16:45:52,208 - INFO - Weighted Accuracies: All 0.6418 | Old 0.7725 | New 0.3802
2024-12-07 16:51:10,540 - INFO - Epoch 11/200, Total Loss: 3.3315, Base Loss: 2.0620, Con Loss: 1.2695, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 16:51:10,540 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-07 16:51:10,540 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 16:52:31,833 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.7157 | Old 0.8185 | New 0.5103
2024-12-07 16:52:31,833 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.6821 | Old 0.7910 | New 0.4643
2024-12-07 16:53:53,008 - INFO - Weighted Accuracies: All 0.6462 | Old 0.8003 | New 0.3381
2024-12-07 16:55:13,923 - INFO - len of text selected samples: 18000
2024-12-07 17:00:34,003 - INFO - Epoch 12/200, Total Loss: 4.2573, Base Loss: 2.0248, Con Loss: 1.2776, Pseudo Loss Image: 0.9549, Pseudo Loss Text: 0.0000
2024-12-07 17:00:34,003 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-07 17:00:34,003 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 17:01:54,542 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.7316 | Old 0.8148 | New 0.5653
2024-12-07 17:01:54,542 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.7156 | Old 0.8011 | New 0.5447
2024-12-07 17:03:13,697 - INFO - Weighted Accuracies: All 0.7675 | Old 0.8620 | New 0.5784
2024-12-07 17:03:14,410 - INFO - Saved model!
2024-12-07 17:04:33,423 - INFO - len of text selected samples: 18000
2024-12-07 17:09:46,283 - INFO - Epoch 13/200, Total Loss: 3.9483, Base Loss: 1.9940, Con Loss: 1.2692, Pseudo Loss Image: 0.6851, Pseudo Loss Text: 0.0000
2024-12-07 17:09:46,283 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-12-07 17:09:46,283 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 17:11:05,287 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.7395 | Old 0.8178 | New 0.5828
2024-12-07 17:11:05,287 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.7335 | Old 0.8103 | New 0.5799
2024-12-07 17:12:24,510 - INFO - Weighted Accuracies: All 0.7828 | Old 0.8572 | New 0.6338
2024-12-07 17:12:25,214 - INFO - Saved model!
2024-12-07 17:13:44,480 - INFO - len of text selected samples: 18000
