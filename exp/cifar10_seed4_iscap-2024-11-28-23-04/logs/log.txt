2024-11-28 23:04:15,110 - INFO - Training cifar10_seed4_iscap with the following settings:
2024-11-28 23:04:15,110 - INFO - Command-line arguments: output_dir=exp
 experiment_name=cifar10_seed4_iscap
 seed=4
 evaluate=False
 dataset_name=cifar10
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.1
 tau_t_start=0.07
 tau_t_end=0.04
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 5)
 unlabeled_classes=range(5, 10)
 num_labeled_classes=5
 num_unlabeled_classes=5
 log_path=exp/cifar10_seed4_iscap-2024-11-28-23-04/logs/log.txt
 model_path=exp/cifar10_seed4_iscap-2024-11-28-23-04/models/model.pth
 device=cuda
2024-11-28 23:04:15,123 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-11-28 23:04:17,506 - INFO - Building custom CLIP
2024-11-28 23:04:18,600 - INFO - Turning off gradients in both the image and the text encoder
2024-11-28 23:04:18,602 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-11-28 23:04:23,543 - INFO - len of train dataset: 50000
2024-11-28 23:04:23,544 - INFO - len of test dataset: 37500
2024-11-28 23:04:23,555 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-11-28 23:04:23,556 - INFO - Selecting 2250 high-confidence samples for co-teaching.
2024-11-28 23:06:09,381 - INFO - Before Train Accuracies: All 0.3549 | Old 0.0432 | New 0.5107
2024-11-28 23:06:09,381 - INFO - Before Train Accuracies: All 0.2665 | Old 0.0086 | New 0.3954
2024-11-28 23:11:21,556 - INFO - Epoch 1/200, Total Loss: 3.5292, Base Loss: 1.4725, Con Loss: 2.0567, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-28 23:11:21,556 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-11-28 23:11:21,557 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-28 23:12:59,258 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.9203 | Old 0.9555 | New 0.9027
2024-11-28 23:12:59,258 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.9507 | Old 0.9294 | New 0.9613
2024-11-28 23:14:36,900 - INFO - Weighted Accuracies: All 0.7299 | Old 0.9746 | New 0.6075
2024-11-28 23:14:37,515 - INFO - Saved model!
2024-11-28 23:19:48,945 - INFO - Epoch 2/200, Total Loss: 2.5110, Base Loss: 0.6324, Con Loss: 1.8785, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-28 23:19:48,945 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-11-28 23:19:48,945 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-28 23:21:26,962 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.9696 | Old 0.9518 | New 0.9786
2024-11-28 23:21:26,962 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.9448 | Old 0.9282 | New 0.9531
2024-11-28 23:23:04,562 - INFO - Weighted Accuracies: All 0.7407 | Old 0.9789 | New 0.6216
2024-11-28 23:23:05,270 - INFO - Saved model!
2024-11-28 23:28:16,433 - INFO - Epoch 3/200, Total Loss: 2.3851, Base Loss: 0.5763, Con Loss: 1.8087, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-28 23:28:16,433 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-11-28 23:28:16,433 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-28 23:29:54,178 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.9698 | Old 0.9443 | New 0.9826
2024-11-28 23:29:54,178 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.9526 | Old 0.9139 | New 0.9719
2024-11-28 23:31:32,025 - INFO - Weighted Accuracies: All 0.6981 | Old 0.9748 | New 0.5598
2024-11-28 23:36:44,180 - INFO - Epoch 4/200, Total Loss: 2.2823, Base Loss: 0.5339, Con Loss: 1.7484, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-28 23:36:44,181 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-11-28 23:36:44,181 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-28 23:38:22,088 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.9707 | Old 0.9462 | New 0.9829
2024-11-28 23:38:22,088 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.9536 | Old 0.9149 | New 0.9730
2024-11-28 23:39:59,876 - INFO - Weighted Accuracies: All 0.7267 | Old 0.9761 | New 0.6021
2024-11-28 23:45:10,880 - INFO - Epoch 5/200, Total Loss: 2.2186, Base Loss: 0.5232, Con Loss: 1.6954, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-28 23:45:10,880 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-11-28 23:45:10,880 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-28 23:46:48,687 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.9701 | Old 0.9481 | New 0.9811
2024-11-28 23:46:48,687 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.9501 | Old 0.9308 | New 0.9597
2024-11-28 23:48:26,461 - INFO - Weighted Accuracies: All 0.7396 | Old 0.9798 | New 0.6195
2024-11-28 23:53:38,067 - INFO - Epoch 6/200, Total Loss: 2.1615, Base Loss: 0.5109, Con Loss: 1.6506, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-28 23:53:38,067 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-11-28 23:53:38,067 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-28 23:55:15,856 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.9630 | Old 0.9190 | New 0.9850
2024-11-28 23:55:15,856 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.9493 | Old 0.9003 | New 0.9738
2024-11-28 23:56:53,887 - INFO - Weighted Accuracies: All 0.7407 | Old 0.9702 | New 0.6260
2024-11-28 23:56:54,601 - INFO - Saved model!
2024-11-29 00:02:06,317 - INFO - Epoch 7/200, Total Loss: 2.1179, Base Loss: 0.4989, Con Loss: 1.6190, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-29 00:02:06,317 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-11-29 00:02:06,317 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:03:44,408 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.9722 | Old 0.9519 | New 0.9824
2024-11-29 00:03:44,409 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.9612 | Old 0.9361 | New 0.9738
2024-11-29 00:05:22,341 - INFO - Weighted Accuracies: All 0.7328 | Old 0.9814 | New 0.6084
2024-11-29 00:10:34,129 - INFO - Epoch 8/200, Total Loss: 2.0840, Base Loss: 0.4904, Con Loss: 1.5936, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-29 00:10:34,130 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-11-29 00:10:34,130 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:12:12,073 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.9693 | Old 0.9421 | New 0.9829
2024-11-29 00:12:12,073 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.9604 | Old 0.9314 | New 0.9749
2024-11-29 00:13:49,833 - INFO - Weighted Accuracies: All 0.7349 | Old 0.9791 | New 0.6128
2024-11-29 00:19:02,027 - INFO - Epoch 9/200, Total Loss: 2.0573, Base Loss: 0.4844, Con Loss: 1.5730, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-29 00:19:02,027 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-11-29 00:19:02,027 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:20:39,875 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.9690 | Old 0.9397 | New 0.9837
2024-11-29 00:20:39,875 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.9585 | Old 0.9246 | New 0.9754
2024-11-29 00:22:18,233 - INFO - Weighted Accuracies: All 0.7344 | Old 0.9783 | New 0.6124
2024-11-29 00:27:30,315 - INFO - Epoch 10/200, Total Loss: 2.0343, Base Loss: 0.4837, Con Loss: 1.5506, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-29 00:27:30,315 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-11-29 00:27:30,315 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:29:08,365 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.9701 | Old 0.9434 | New 0.9834
2024-11-29 00:29:08,365 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.9601 | Old 0.9383 | New 0.9710
2024-11-29 00:30:46,066 - INFO - Weighted Accuracies: All 0.7347 | Old 0.9821 | New 0.6110
2024-11-29 00:35:58,122 - INFO - Epoch 11/200, Total Loss: 1.9947, Base Loss: 0.4664, Con Loss: 1.5283, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-29 00:35:58,122 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-11-29 00:35:58,122 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:37:36,152 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.9707 | Old 0.9438 | New 0.9842
2024-11-29 00:37:36,152 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.9616 | Old 0.9314 | New 0.9767
2024-11-29 00:39:13,919 - INFO - Weighted Accuracies: All 0.7297 | Old 0.9791 | New 0.6049
2024-11-29 00:40:51,870 - INFO - len of text selected samples: 22500
2024-11-29 00:46:04,693 - INFO - Epoch 12/200, Total Loss: 2.2212, Base Loss: 0.4866, Con Loss: 1.5102, Pseudo Loss Image: 0.2243, Pseudo Loss Image: 0.2243
2024-11-29 00:46:04,694 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-11-29 00:46:04,694 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:47:42,756 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.9698 | Old 0.9401 | New 0.9846
2024-11-29 00:47:42,756 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.9592 | Old 0.9441 | New 0.9667
2024-11-29 00:49:20,836 - INFO - Weighted Accuracies: All 0.9806 | Old 0.9634 | New 0.9892
2024-11-29 00:49:21,556 - INFO - Saved model!
2024-11-29 00:50:59,323 - INFO - len of text selected samples: 22500
2024-11-29 00:56:12,116 - INFO - Epoch 13/200, Total Loss: 2.0922, Base Loss: 0.4566, Con Loss: 1.4953, Pseudo Loss Image: 0.1402, Pseudo Loss Image: 0.1402
2024-11-29 00:56:12,117 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-11-29 00:56:12,117 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:57:50,056 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.9707 | Old 0.9426 | New 0.9848
2024-11-29 00:57:50,057 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.9609 | Old 0.9454 | New 0.9686
2024-11-29 00:59:27,666 - INFO - Weighted Accuracies: All 0.9821 | Old 0.9661 | New 0.9901
2024-11-29 00:59:28,378 - INFO - Saved model!
2024-11-29 01:01:06,430 - INFO - len of text selected samples: 22500
2024-11-29 01:06:19,022 - INFO - Epoch 14/200, Total Loss: 2.0645, Base Loss: 0.4534, Con Loss: 1.4737, Pseudo Loss Image: 0.1374, Pseudo Loss Image: 0.1374
2024-11-29 01:06:19,022 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-11-29 01:06:19,022 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 01:07:57,048 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.9687 | Old 0.9346 | New 0.9857
2024-11-29 01:07:57,049 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.9618 | Old 0.9342 | New 0.9755
2024-11-29 01:09:34,705 - INFO - Weighted Accuracies: All 0.9801 | Old 0.9574 | New 0.9914
2024-11-29 01:11:12,613 - INFO - len of text selected samples: 22500
2024-11-29 01:16:24,972 - INFO - Epoch 15/200, Total Loss: 2.0485, Base Loss: 0.4474, Con Loss: 1.4668, Pseudo Loss Image: 0.1343, Pseudo Loss Image: 0.1343
2024-11-29 01:16:24,972 - INFO -    Param Group: classifier_head, Learning Rate: 0.0986
2024-11-29 01:16:24,972 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 01:18:02,594 - INFO - Text classifier Epoch 14 Train Accuracies: All 0.9693 | Old 0.9383 | New 0.9848
2024-11-29 01:18:02,595 - INFO - Image classifier Epoch 14 Train Accuracies: All 0.9632 | Old 0.9510 | New 0.9693
2024-11-29 01:19:39,909 - INFO - Weighted Accuracies: All 0.9808 | Old 0.9642 | New 0.9892
2024-11-29 01:21:17,823 - INFO - len of text selected samples: 22500
2024-11-29 01:26:30,204 - INFO - Epoch 16/200, Total Loss: 2.0132, Base Loss: 0.4471, Con Loss: 1.4448, Pseudo Loss Image: 0.1213, Pseudo Loss Image: 0.1213
2024-11-29 01:26:30,204 - INFO -    Param Group: classifier_head, Learning Rate: 0.0984
2024-11-29 01:26:30,204 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 01:28:07,880 - INFO - Text classifier Epoch 15 Train Accuracies: All 0.9712 | Old 0.9456 | New 0.9840
2024-11-29 01:28:07,880 - INFO - Image classifier Epoch 15 Train Accuracies: All 0.9632 | Old 0.9581 | New 0.9658
2024-11-29 01:29:45,604 - INFO - Weighted Accuracies: All 0.9815 | Old 0.9680 | New 0.9883
2024-11-29 01:33:01,580 - INFO - len of image selected samples: 22500
2024-11-29 01:33:01,580 - INFO - len of text selected samples: 22500
2024-11-29 01:38:15,470 - INFO - Epoch 17/200, Total Loss: 2.0828, Base Loss: 0.4515, Con Loss: 1.4277, Pseudo Loss Image: 0.1099, Pseudo Loss Image: 0.1099
2024-11-29 01:38:15,471 - INFO -    Param Group: classifier_head, Learning Rate: 0.0982
2024-11-29 01:38:15,471 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 01:39:53,557 - INFO - Text classifier Epoch 16 Train Accuracies: All 0.9763 | Old 0.9638 | New 0.9825
2024-11-29 01:39:53,557 - INFO - Image classifier Epoch 16 Train Accuracies: All 0.9564 | Old 0.9583 | New 0.9555
2024-11-29 01:41:31,992 - INFO - Weighted Accuracies: All 0.9833 | Old 0.9771 | New 0.9864
2024-11-29 01:41:32,697 - INFO - Saved model!
2024-11-29 01:44:48,847 - INFO - len of image selected samples: 22500
2024-11-29 01:44:48,847 - INFO - len of text selected samples: 22500
2024-11-29 01:50:02,175 - INFO - Epoch 18/200, Total Loss: 2.0591, Base Loss: 0.4447, Con Loss: 1.4112, Pseudo Loss Image: 0.1036, Pseudo Loss Image: 0.1036
2024-11-29 01:50:02,176 - INFO -    Param Group: classifier_head, Learning Rate: 0.0980
2024-11-29 01:50:02,176 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 01:51:39,988 - INFO - Text classifier Epoch 17 Train Accuracies: All 0.9764 | Old 0.9708 | New 0.9792
2024-11-29 01:51:39,988 - INFO - Image classifier Epoch 17 Train Accuracies: All 0.9655 | Old 0.9548 | New 0.9709
2024-11-29 01:53:18,196 - INFO - Weighted Accuracies: All 0.9830 | Old 0.9770 | New 0.9860
2024-11-29 01:56:34,884 - INFO - len of image selected samples: 22500
2024-11-29 01:56:34,885 - INFO - len of text selected samples: 22500
2024-11-29 02:01:48,119 - INFO - Epoch 19/200, Total Loss: 2.0457, Base Loss: 0.4433, Con Loss: 1.4110, Pseudo Loss Image: 0.1023, Pseudo Loss Image: 0.1023
2024-11-29 02:01:48,119 - INFO -    Param Group: classifier_head, Learning Rate: 0.0978
2024-11-29 02:01:48,119 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 02:03:26,100 - INFO - Text classifier Epoch 18 Train Accuracies: All 0.9778 | Old 0.9636 | New 0.9849
2024-11-29 02:03:26,100 - INFO - Image classifier Epoch 18 Train Accuracies: All 0.9659 | Old 0.9626 | New 0.9676
2024-11-29 02:05:04,658 - INFO - Weighted Accuracies: All 0.9845 | Old 0.9760 | New 0.9888
2024-11-29 02:05:05,382 - INFO - Saved model!
2024-11-29 02:08:22,207 - INFO - len of image selected samples: 22500
2024-11-29 02:08:22,207 - INFO - len of text selected samples: 22500
2024-11-29 02:13:36,385 - INFO - Epoch 20/200, Total Loss: 2.0032, Base Loss: 0.4310, Con Loss: 1.3961, Pseudo Loss Image: 0.0983, Pseudo Loss Image: 0.0983
2024-11-29 02:13:36,385 - INFO -    Param Group: classifier_head, Learning Rate: 0.0976
2024-11-29 02:13:36,385 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 02:15:14,699 - INFO - Text classifier Epoch 19 Train Accuracies: All 0.9782 | Old 0.9673 | New 0.9836
2024-11-29 02:15:14,700 - INFO - Image classifier Epoch 19 Train Accuracies: All 0.9588 | Old 0.9629 | New 0.9568
2024-11-29 02:16:53,020 - INFO - Weighted Accuracies: All 0.9833 | Old 0.9774 | New 0.9862
2024-11-29 02:20:09,416 - INFO - len of image selected samples: 22500
2024-11-29 02:20:09,417 - INFO - len of text selected samples: 22500
2024-11-29 02:25:22,752 - INFO - Epoch 21/200, Total Loss: 2.0116, Base Loss: 0.4365, Con Loss: 1.3888, Pseudo Loss Image: 0.0976, Pseudo Loss Image: 0.0976
2024-11-29 02:25:22,752 - INFO -    Param Group: classifier_head, Learning Rate: 0.0973
2024-11-29 02:25:22,752 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 02:27:00,752 - INFO - Text classifier Epoch 20 Train Accuracies: All 0.9782 | Old 0.9734 | New 0.9806
2024-11-29 02:27:00,753 - INFO - Image classifier Epoch 20 Train Accuracies: All 0.9676 | Old 0.9601 | New 0.9714
2024-11-29 02:28:38,314 - INFO - Weighted Accuracies: All 0.9841 | Old 0.9792 | New 0.9866
2024-11-29 02:31:53,989 - INFO - len of image selected samples: 22500
2024-11-29 02:31:53,989 - INFO - len of text selected samples: 22500
2024-11-29 02:37:08,049 - INFO - Epoch 22/200, Total Loss: 1.9810, Base Loss: 0.4366, Con Loss: 1.3661, Pseudo Loss Image: 0.1010, Pseudo Loss Image: 0.1010
2024-11-29 02:37:08,049 - INFO -    Param Group: classifier_head, Learning Rate: 0.0970
2024-11-29 02:37:08,050 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 02:38:46,168 - INFO - Text classifier Epoch 21 Train Accuracies: All 0.9793 | Old 0.9686 | New 0.9846
2024-11-29 02:38:46,168 - INFO - Image classifier Epoch 21 Train Accuracies: All 0.9628 | Old 0.9632 | New 0.9626
2024-11-29 02:40:24,345 - INFO - Weighted Accuracies: All 0.9842 | Old 0.9788 | New 0.9870
2024-11-29 02:43:39,962 - INFO - len of image selected samples: 22500
2024-11-29 02:43:39,962 - INFO - len of text selected samples: 22500
2024-11-29 02:48:53,873 - INFO - Epoch 23/200, Total Loss: 1.9527, Base Loss: 0.4174, Con Loss: 1.3631, Pseudo Loss Image: 0.0901, Pseudo Loss Image: 0.0901
2024-11-29 02:48:53,873 - INFO -    Param Group: classifier_head, Learning Rate: 0.0968
2024-11-29 02:48:53,873 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 02:50:31,635 - INFO - Text classifier Epoch 22 Train Accuracies: All 0.9775 | Old 0.9689 | New 0.9819
2024-11-29 02:50:31,635 - INFO - Image classifier Epoch 22 Train Accuracies: All 0.9688 | Old 0.9609 | New 0.9727
2024-11-29 02:52:09,664 - INFO - Weighted Accuracies: All 0.9836 | Old 0.9772 | New 0.9868
2024-11-29 02:55:25,923 - INFO - len of image selected samples: 22500
2024-11-29 02:55:25,925 - INFO - len of text selected samples: 22500
2024-11-29 03:00:40,519 - INFO - Epoch 24/200, Total Loss: 1.9445, Base Loss: 0.4222, Con Loss: 1.3505, Pseudo Loss Image: 0.0975, Pseudo Loss Image: 0.0975
2024-11-29 03:00:40,520 - INFO -    Param Group: classifier_head, Learning Rate: 0.0965
2024-11-29 03:00:40,520 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 03:02:18,637 - INFO - Text classifier Epoch 23 Train Accuracies: All 0.9787 | Old 0.9697 | New 0.9832
2024-11-29 03:02:18,637 - INFO - Image classifier Epoch 23 Train Accuracies: All 0.9686 | Old 0.9574 | New 0.9742
2024-11-29 03:03:56,739 - INFO - Weighted Accuracies: All 0.9847 | Old 0.9778 | New 0.9882
2024-11-29 03:03:57,433 - INFO - Saved model!
2024-11-29 03:07:13,222 - INFO - len of image selected samples: 22500
2024-11-29 03:07:13,222 - INFO - len of text selected samples: 22500
2024-11-29 03:12:27,775 - INFO - Epoch 25/200, Total Loss: 1.9360, Base Loss: 0.4281, Con Loss: 1.3427, Pseudo Loss Image: 0.0878, Pseudo Loss Image: 0.0878
2024-11-29 03:12:27,775 - INFO -    Param Group: classifier_head, Learning Rate: 0.0962
2024-11-29 03:12:27,775 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 03:14:05,473 - INFO - Text classifier Epoch 24 Train Accuracies: All 0.9796 | Old 0.9685 | New 0.9852
2024-11-29 03:14:05,473 - INFO - Image classifier Epoch 24 Train Accuracies: All 0.9669 | Old 0.9600 | New 0.9704
2024-11-29 03:15:43,125 - INFO - Weighted Accuracies: All 0.9849 | Old 0.9768 | New 0.9889
2024-11-29 03:15:43,823 - INFO - Saved model!
2024-11-29 03:18:59,359 - INFO - len of image selected samples: 22500
2024-11-29 03:18:59,359 - INFO - len of text selected samples: 22500
2024-11-29 03:24:13,053 - INFO - Epoch 26/200, Total Loss: 1.9218, Base Loss: 0.4284, Con Loss: 1.3357, Pseudo Loss Image: 0.0898, Pseudo Loss Image: 0.0898
2024-11-29 03:24:13,053 - INFO -    Param Group: classifier_head, Learning Rate: 0.0959
2024-11-29 03:24:13,053 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 03:25:51,153 - INFO - Text classifier Epoch 25 Train Accuracies: All 0.9782 | Old 0.9725 | New 0.9811
2024-11-29 03:25:51,153 - INFO - Image classifier Epoch 25 Train Accuracies: All 0.9655 | Old 0.9634 | New 0.9666
2024-11-29 03:27:28,978 - INFO - Weighted Accuracies: All 0.9834 | Old 0.9798 | New 0.9853
2024-11-29 03:30:45,157 - INFO - len of image selected samples: 22500
2024-11-29 03:30:45,157 - INFO - len of text selected samples: 22500
2024-11-29 03:35:59,226 - INFO - Epoch 27/200, Total Loss: 1.8996, Base Loss: 0.4095, Con Loss: 1.3339, Pseudo Loss Image: 0.0850, Pseudo Loss Image: 0.0850
2024-11-29 03:35:59,226 - INFO -    Param Group: classifier_head, Learning Rate: 0.0956
2024-11-29 03:35:59,226 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 03:37:36,715 - INFO - Text classifier Epoch 26 Train Accuracies: All 0.9793 | Old 0.9710 | New 0.9835
2024-11-29 03:37:36,715 - INFO - Image classifier Epoch 26 Train Accuracies: All 0.9665 | Old 0.9636 | New 0.9680
2024-11-29 03:39:15,068 - INFO - Weighted Accuracies: All 0.9842 | Old 0.9794 | New 0.9866
2024-11-29 03:42:30,713 - INFO - len of image selected samples: 22500
2024-11-29 03:42:30,713 - INFO - len of text selected samples: 22500
2024-11-29 03:47:44,076 - INFO - Epoch 28/200, Total Loss: 1.8838, Base Loss: 0.4202, Con Loss: 1.3140, Pseudo Loss Image: 0.0865, Pseudo Loss Image: 0.0865
2024-11-29 03:47:44,076 - INFO -    Param Group: classifier_head, Learning Rate: 0.0952
2024-11-29 03:47:44,076 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 03:49:22,043 - INFO - Text classifier Epoch 27 Train Accuracies: All 0.9790 | Old 0.9720 | New 0.9824
2024-11-29 03:49:22,044 - INFO - Image classifier Epoch 27 Train Accuracies: All 0.9652 | Old 0.9701 | New 0.9627
2024-11-29 03:50:59,938 - INFO - Weighted Accuracies: All 0.9838 | Old 0.9809 | New 0.9853
2024-11-29 03:54:15,902 - INFO - len of image selected samples: 22500
2024-11-29 03:54:15,902 - INFO - len of text selected samples: 22500
2024-11-29 03:59:29,346 - INFO - Epoch 29/200, Total Loss: 1.8741, Base Loss: 0.4220, Con Loss: 1.3090, Pseudo Loss Image: 0.0801, Pseudo Loss Image: 0.0801
2024-11-29 03:59:29,346 - INFO -    Param Group: classifier_head, Learning Rate: 0.0949
2024-11-29 03:59:29,346 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 04:01:07,254 - INFO - Text classifier Epoch 28 Train Accuracies: All 0.9790 | Old 0.9710 | New 0.9830
2024-11-29 04:01:07,255 - INFO - Image classifier Epoch 28 Train Accuracies: All 0.9629 | Old 0.9670 | New 0.9608
2024-11-29 04:02:45,437 - INFO - Weighted Accuracies: All 0.9837 | Old 0.9796 | New 0.9857
2024-11-29 04:06:01,342 - INFO - len of image selected samples: 22500
2024-11-29 04:06:01,342 - INFO - len of text selected samples: 22500
2024-11-29 04:11:14,663 - INFO - Epoch 30/200, Total Loss: 1.8618, Base Loss: 0.4094, Con Loss: 1.3002, Pseudo Loss Image: 0.0773, Pseudo Loss Image: 0.0773
2024-11-29 04:11:14,663 - INFO -    Param Group: classifier_head, Learning Rate: 0.0946
2024-11-29 04:11:14,663 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 04:12:52,663 - INFO - Text classifier Epoch 29 Train Accuracies: All 0.9771 | Old 0.9747 | New 0.9782
2024-11-29 04:12:52,663 - INFO - Image classifier Epoch 29 Train Accuracies: All 0.9641 | Old 0.9658 | New 0.9633
2024-11-29 04:14:30,305 - INFO - Weighted Accuracies: All 0.9823 | Old 0.9818 | New 0.9825
2024-11-29 04:17:45,759 - INFO - len of image selected samples: 22500
2024-11-29 04:17:45,760 - INFO - len of text selected samples: 22500
2024-11-29 04:22:59,257 - INFO - Epoch 31/200, Total Loss: 1.8553, Base Loss: 0.4163, Con Loss: 1.2920, Pseudo Loss Image: 0.0771, Pseudo Loss Image: 0.0771
2024-11-29 04:22:59,257 - INFO -    Param Group: classifier_head, Learning Rate: 0.0942
2024-11-29 04:22:59,257 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 04:24:37,114 - INFO - Text classifier Epoch 30 Train Accuracies: All 0.9801 | Old 0.9716 | New 0.9844
2024-11-29 04:24:37,114 - INFO - Image classifier Epoch 30 Train Accuracies: All 0.9668 | Old 0.9676 | New 0.9664
2024-11-29 04:26:15,016 - INFO - Weighted Accuracies: All 0.9846 | Old 0.9806 | New 0.9866
2024-11-29 04:29:30,915 - INFO - len of image selected samples: 22500
2024-11-29 04:29:30,916 - INFO - len of text selected samples: 22500
2024-11-29 04:34:44,889 - INFO - Epoch 32/200, Total Loss: 1.8508, Base Loss: 0.4170, Con Loss: 1.2852, Pseudo Loss Image: 0.0840, Pseudo Loss Image: 0.0840
2024-11-29 04:34:44,889 - INFO -    Param Group: classifier_head, Learning Rate: 0.0938
2024-11-29 04:34:44,889 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 04:36:22,789 - INFO - Text classifier Epoch 31 Train Accuracies: All 0.9792 | Old 0.9730 | New 0.9823
2024-11-29 04:36:22,789 - INFO - Image classifier Epoch 31 Train Accuracies: All 0.9690 | Old 0.9574 | New 0.9749
2024-11-29 04:38:00,457 - INFO - Weighted Accuracies: All 0.9849 | Old 0.9790 | New 0.9879
2024-11-29 04:38:01,171 - INFO - Saved model!
2024-11-29 04:41:17,539 - INFO - len of image selected samples: 22500
2024-11-29 04:41:17,539 - INFO - len of text selected samples: 22500
2024-11-29 04:46:31,855 - INFO - Epoch 33/200, Total Loss: 1.8461, Base Loss: 0.4117, Con Loss: 1.2809, Pseudo Loss Image: 0.0766, Pseudo Loss Image: 0.0766
2024-11-29 04:46:31,855 - INFO -    Param Group: classifier_head, Learning Rate: 0.0934
2024-11-29 04:46:31,855 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 04:48:09,632 - INFO - Text classifier Epoch 32 Train Accuracies: All 0.9789 | Old 0.9710 | New 0.9828
2024-11-29 04:48:09,632 - INFO - Image classifier Epoch 32 Train Accuracies: All 0.9680 | Old 0.9644 | New 0.9698
2024-11-29 04:49:47,107 - INFO - Weighted Accuracies: All 0.9843 | Old 0.9789 | New 0.9871
2024-11-29 04:53:03,361 - INFO - len of image selected samples: 22500
2024-11-29 04:53:03,362 - INFO - len of text selected samples: 22500
2024-11-29 04:58:16,635 - INFO - Epoch 34/200, Total Loss: 1.8361, Base Loss: 0.4170, Con Loss: 1.2715, Pseudo Loss Image: 0.0784, Pseudo Loss Image: 0.0784
2024-11-29 04:58:16,635 - INFO -    Param Group: classifier_head, Learning Rate: 0.0930
2024-11-29 04:58:16,635 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 04:59:54,719 - INFO - Text classifier Epoch 33 Train Accuracies: All 0.9796 | Old 0.9718 | New 0.9835
2024-11-29 04:59:54,720 - INFO - Image classifier Epoch 33 Train Accuracies: All 0.9622 | Old 0.9703 | New 0.9582
2024-11-29 05:01:32,678 - INFO - Weighted Accuracies: All 0.9832 | Old 0.9807 | New 0.9844
2024-11-29 05:04:49,070 - INFO - len of image selected samples: 22500
2024-11-29 05:04:49,071 - INFO - len of text selected samples: 22500
2024-11-29 05:10:02,766 - INFO - Epoch 35/200, Total Loss: 1.8267, Base Loss: 0.4145, Con Loss: 1.2668, Pseudo Loss Image: 0.0711, Pseudo Loss Image: 0.0711
2024-11-29 05:10:02,766 - INFO -    Param Group: classifier_head, Learning Rate: 0.0926
2024-11-29 05:10:02,766 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 05:11:41,021 - INFO - Text classifier Epoch 34 Train Accuracies: All 0.9795 | Old 0.9726 | New 0.9830
2024-11-29 05:11:41,021 - INFO - Image classifier Epoch 34 Train Accuracies: All 0.9674 | Old 0.9679 | New 0.9672
2024-11-29 05:13:18,989 - INFO - Weighted Accuracies: All 0.9841 | Old 0.9802 | New 0.9860
2024-11-29 05:16:34,801 - INFO - len of image selected samples: 22500
2024-11-29 05:16:34,802 - INFO - len of text selected samples: 22500
2024-11-29 05:21:48,302 - INFO - Epoch 36/200, Total Loss: 1.7994, Base Loss: 0.4010, Con Loss: 1.2551, Pseudo Loss Image: 0.0798, Pseudo Loss Image: 0.0798
2024-11-29 05:21:48,302 - INFO -    Param Group: classifier_head, Learning Rate: 0.0922
2024-11-29 05:21:48,302 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 05:23:26,146 - INFO - Text classifier Epoch 35 Train Accuracies: All 0.9791 | Old 0.9757 | New 0.9809
2024-11-29 05:23:26,147 - INFO - Image classifier Epoch 35 Train Accuracies: All 0.9673 | Old 0.9679 | New 0.9670
2024-11-29 05:25:04,287 - INFO - Weighted Accuracies: All 0.9840 | Old 0.9815 | New 0.9852
2024-11-29 05:28:19,826 - INFO - len of image selected samples: 22500
2024-11-29 05:28:19,827 - INFO - len of text selected samples: 22500
2024-11-29 05:33:33,113 - INFO - Epoch 37/200, Total Loss: 1.8074, Base Loss: 0.4168, Con Loss: 1.2542, Pseudo Loss Image: 0.0767, Pseudo Loss Image: 0.0767
2024-11-29 05:33:33,113 - INFO -    Param Group: classifier_head, Learning Rate: 0.0918
2024-11-29 05:33:33,114 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 05:35:10,957 - INFO - Text classifier Epoch 36 Train Accuracies: All 0.9803 | Old 0.9728 | New 0.9840
2024-11-29 05:35:10,957 - INFO - Image classifier Epoch 36 Train Accuracies: All 0.9671 | Old 0.9714 | New 0.9650
2024-11-29 05:36:49,119 - INFO - Weighted Accuracies: All 0.9841 | Old 0.9809 | New 0.9858
2024-11-29 05:40:05,358 - INFO - len of image selected samples: 22500
2024-11-29 05:40:05,359 - INFO - len of text selected samples: 22500
2024-11-29 05:45:18,123 - INFO - Epoch 38/200, Total Loss: 1.8162, Base Loss: 0.4161, Con Loss: 1.2518, Pseudo Loss Image: 0.0760, Pseudo Loss Image: 0.0760
2024-11-29 05:45:18,123 - INFO -    Param Group: classifier_head, Learning Rate: 0.0914
2024-11-29 05:45:18,123 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 05:46:56,063 - INFO - Text classifier Epoch 37 Train Accuracies: All 0.9791 | Old 0.9754 | New 0.9810
2024-11-29 05:46:56,063 - INFO - Image classifier Epoch 37 Train Accuracies: All 0.9645 | Old 0.9674 | New 0.9631
2024-11-29 05:48:33,809 - INFO - Weighted Accuracies: All 0.9832 | Old 0.9819 | New 0.9838
2024-11-29 05:51:49,876 - INFO - len of image selected samples: 22500
2024-11-29 05:51:49,876 - INFO - len of text selected samples: 22500
2024-11-29 05:57:03,230 - INFO - Epoch 39/200, Total Loss: 1.7904, Base Loss: 0.4113, Con Loss: 1.2414, Pseudo Loss Image: 0.0701, Pseudo Loss Image: 0.0701
2024-11-29 05:57:03,230 - INFO -    Param Group: classifier_head, Learning Rate: 0.0909
2024-11-29 05:57:03,230 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 05:58:41,157 - INFO - Text classifier Epoch 38 Train Accuracies: All 0.9788 | Old 0.9746 | New 0.9809
2024-11-29 05:58:41,157 - INFO - Image classifier Epoch 38 Train Accuracies: All 0.9706 | Old 0.9623 | New 0.9747
2024-11-29 06:00:18,912 - INFO - Weighted Accuracies: All 0.9843 | Old 0.9806 | New 0.9862
2024-11-29 06:03:35,525 - INFO - len of image selected samples: 22500
2024-11-29 06:03:35,526 - INFO - len of text selected samples: 22500
2024-11-29 06:08:48,586 - INFO - Epoch 40/200, Total Loss: 1.7720, Base Loss: 0.4043, Con Loss: 1.2333, Pseudo Loss Image: 0.0727, Pseudo Loss Image: 0.0727
2024-11-29 06:08:48,588 - INFO -    Param Group: classifier_head, Learning Rate: 0.0905
2024-11-29 06:08:48,588 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 06:10:26,920 - INFO - Text classifier Epoch 39 Train Accuracies: All 0.9801 | Old 0.9738 | New 0.9832
2024-11-29 06:10:26,920 - INFO - Image classifier Epoch 39 Train Accuracies: All 0.9669 | Old 0.9710 | New 0.9648
2024-11-29 06:12:05,167 - INFO - Weighted Accuracies: All 0.9839 | Old 0.9812 | New 0.9853
2024-11-29 06:15:21,720 - INFO - len of image selected samples: 22500
2024-11-29 06:15:21,720 - INFO - len of text selected samples: 22500
2024-11-29 06:20:35,133 - INFO - Epoch 41/200, Total Loss: 1.7823, Base Loss: 0.4068, Con Loss: 1.2361, Pseudo Loss Image: 0.0718, Pseudo Loss Image: 0.0718
2024-11-29 06:20:35,133 - INFO -    Param Group: classifier_head, Learning Rate: 0.0900
2024-11-29 06:20:35,133 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 06:22:13,011 - INFO - Text classifier Epoch 40 Train Accuracies: All 0.9791 | Old 0.9734 | New 0.9820
2024-11-29 06:22:13,012 - INFO - Image classifier Epoch 40 Train Accuracies: All 0.9716 | Old 0.9668 | New 0.9740
2024-11-29 06:23:51,391 - INFO - Weighted Accuracies: All 0.9845 | Old 0.9802 | New 0.9866
2024-11-29 06:27:07,858 - INFO - len of image selected samples: 22500
2024-11-29 06:27:07,858 - INFO - len of text selected samples: 22500
2024-11-29 06:32:21,564 - INFO - Epoch 42/200, Total Loss: 1.7664, Base Loss: 0.4097, Con Loss: 1.2255, Pseudo Loss Image: 0.0729, Pseudo Loss Image: 0.0729
2024-11-29 06:32:21,565 - INFO -    Param Group: classifier_head, Learning Rate: 0.0895
2024-11-29 06:32:21,565 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
