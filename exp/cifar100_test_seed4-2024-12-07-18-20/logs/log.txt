2024-12-07 18:20:45,472 - INFO - Training cifar100_test_seed4 with the following settings:
2024-12-07 18:20:45,474 - INFO - Command-line arguments: output_dir=exp
 experiment_name=cifar100_test_seed4
 seed=4
 evaluate=False
 dataset_name=cifar100
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 80)
 unlabeled_classes=range(80, 100)
 num_labeled_classes=80
 num_unlabeled_classes=20
 log_path=exp/cifar100_test_seed4-2024-12-07-18-20/logs/log.txt
 model_path=exp/cifar100_test_seed4-2024-12-07-18-20/models/model.pth
 device=cuda
2024-12-07 18:20:45,478 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-07 18:20:47,948 - INFO - Building custom CLIP
2024-12-07 18:20:49,153 - INFO - Turning off gradients in both the image and the text encoder
2024-12-07 18:20:49,157 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 18:20:54,716 - INFO - len of train dataset: 50000
2024-12-07 18:20:54,718 - INFO - len of test dataset: 30000
2024-12-07 18:20:54,727 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 18:20:54,728 - INFO - Selecting 180 high-confidence samples for co-teaching.
2024-12-07 18:22:19,586 - INFO - Before Train Accuracies: All 0.1029 | Old 0.0665 | New 0.1756
2024-12-07 18:22:19,586 - INFO - Before Train Accuracies: All 0.0627 | Old 0.0307 | New 0.1268
2024-12-07 18:27:32,619 - INFO - Epoch 1/200, Total Loss: 6.5720, Base Loss: 4.9401, Con Loss: 1.6319, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 18:27:32,619 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 18:27:32,619 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 18:28:51,434 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.6831 | Old 0.7157 | New 0.6178
2024-12-07 18:28:51,434 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.5728 | Old 0.6440 | New 0.4303
2024-12-07 18:30:10,226 - INFO - Weighted Accuracies: All 0.6517 | Old 0.7436 | New 0.4679
2024-12-07 18:30:10,841 - INFO - Saved model!
2024-12-07 18:35:22,848 - INFO - Epoch 2/200, Total Loss: 4.1898, Base Loss: 2.6680, Con Loss: 1.5218, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 18:35:22,849 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 18:35:22,849 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 18:36:41,864 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.7191 | Old 0.8039 | New 0.5495
2024-12-07 18:36:41,865 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.6176 | Old 0.7171 | New 0.4186
2024-12-07 18:38:00,597 - INFO - Weighted Accuracies: All 0.6714 | Old 0.7959 | New 0.4223
2024-12-07 18:38:01,300 - INFO - Saved model!
2024-12-07 18:43:12,313 - INFO - Epoch 3/200, Total Loss: 3.8944, Base Loss: 2.4369, Con Loss: 1.4575, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 18:43:12,313 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 18:43:12,313 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 18:44:30,821 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.7260 | Old 0.8022 | New 0.5737
2024-12-07 18:44:30,822 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.6367 | Old 0.7427 | New 0.4247
2024-12-07 18:45:49,994 - INFO - Weighted Accuracies: All 0.6675 | Old 0.8014 | New 0.3996
2024-12-07 18:51:01,937 - INFO - Epoch 4/200, Total Loss: 3.7144, Base Loss: 2.3112, Con Loss: 1.4032, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 18:51:01,937 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 18:51:01,937 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 18:52:20,725 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.7353 | Old 0.8046 | New 0.5966
2024-12-07 18:52:20,725 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.6468 | Old 0.7433 | New 0.4538
2024-12-07 18:53:39,549 - INFO - Weighted Accuracies: All 0.6768 | Old 0.8221 | New 0.3862
2024-12-07 18:53:40,253 - INFO - Saved model!
2024-12-07 18:58:53,073 - INFO - Epoch 5/200, Total Loss: 3.6187, Base Loss: 2.2422, Con Loss: 1.3766, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 18:58:53,073 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 18:58:53,073 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:00:12,594 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.7338 | Old 0.8065 | New 0.5884
2024-12-07 19:00:12,595 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.6439 | Old 0.7627 | New 0.4065
2024-12-07 19:01:32,140 - INFO - Weighted Accuracies: All 0.6746 | Old 0.7934 | New 0.4368
2024-12-07 19:06:48,310 - INFO - Epoch 6/200, Total Loss: 3.5600, Base Loss: 2.2063, Con Loss: 1.3537, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 19:06:48,310 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 19:06:48,310 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:08:08,437 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.7385 | Old 0.8104 | New 0.5947
2024-12-07 19:08:08,437 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.6550 | Old 0.7692 | New 0.4265
2024-12-07 19:09:27,732 - INFO - Weighted Accuracies: All 0.6761 | Old 0.8075 | New 0.4134
2024-12-07 19:14:43,668 - INFO - Epoch 7/200, Total Loss: 3.5112, Base Loss: 2.1721, Con Loss: 1.3391, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 19:14:43,668 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-07 19:14:43,668 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:16:03,323 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.7276 | Old 0.8111 | New 0.5608
2024-12-07 19:16:03,323 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.6586 | Old 0.7775 | New 0.4206
2024-12-07 19:17:22,768 - INFO - Weighted Accuracies: All 0.6747 | Old 0.8264 | New 0.3715
2024-12-07 19:22:37,442 - INFO - Epoch 8/200, Total Loss: 3.4466, Base Loss: 2.1377, Con Loss: 1.3088, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 19:22:37,442 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-07 19:22:37,442 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:23:56,722 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.7382 | Old 0.8094 | New 0.5958
2024-12-07 19:23:56,722 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.6671 | Old 0.7675 | New 0.4663
2024-12-07 19:25:16,205 - INFO - Weighted Accuracies: All 0.6679 | Old 0.8226 | New 0.3583
2024-12-07 19:30:31,253 - INFO - Epoch 9/200, Total Loss: 3.4202, Base Loss: 2.1168, Con Loss: 1.3034, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 19:30:31,253 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-07 19:30:31,253 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:31:50,561 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.7491 | Old 0.8062 | New 0.6348
2024-12-07 19:31:50,561 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.6641 | Old 0.7764 | New 0.4394
2024-12-07 19:33:09,991 - INFO - Weighted Accuracies: All 0.6731 | Old 0.7938 | New 0.4315
2024-12-07 19:38:24,934 - INFO - Epoch 10/200, Total Loss: 3.3557, Base Loss: 2.0769, Con Loss: 1.2788, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 19:38:24,934 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-07 19:38:24,934 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:39:43,939 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.7369 | Old 0.8095 | New 0.5917
2024-12-07 19:39:43,939 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.6654 | Old 0.7793 | New 0.4375
2024-12-07 19:41:03,728 - INFO - Weighted Accuracies: All 0.6709 | Old 0.8175 | New 0.3777
2024-12-07 19:46:17,812 - INFO - Epoch 11/200, Total Loss: 3.3172, Base Loss: 2.0539, Con Loss: 1.2632, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 19:46:17,812 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-07 19:46:17,812 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:47:36,969 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.7574 | Old 0.8145 | New 0.6431
2024-12-07 19:47:36,969 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.6705 | Old 0.7902 | New 0.4311
2024-12-07 19:48:57,072 - INFO - Weighted Accuracies: All 0.6711 | Old 0.8381 | New 0.3372
2024-12-07 19:50:15,848 - INFO - len of text selected samples: 18000
2024-12-07 19:55:31,897 - INFO - Epoch 12/200, Total Loss: 4.2062, Base Loss: 2.0289, Con Loss: 1.2805, Pseudo Loss Image: 0.8968, Pseudo Loss Text: 0.0000
2024-12-07 19:55:31,897 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-07 19:55:31,897 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:56:52,143 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.7496 | Old 0.8147 | New 0.6195
2024-12-07 19:56:52,143 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.7460 | Old 0.8006 | New 0.6368
2024-12-07 19:58:11,559 - INFO - Weighted Accuracies: All 0.7976 | Old 0.8558 | New 0.6811
2024-12-07 19:58:12,263 - INFO - Saved model!
2024-12-07 19:59:31,121 - INFO - len of text selected samples: 18000
2024-12-07 20:04:47,454 - INFO - Epoch 13/200, Total Loss: 3.9085, Base Loss: 1.9935, Con Loss: 1.2675, Pseudo Loss Image: 0.6475, Pseudo Loss Text: 0.0000
2024-12-07 20:04:47,455 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-12-07 20:04:47,455 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:06:06,745 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.7566 | Old 0.8109 | New 0.6478
2024-12-07 20:06:06,745 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.7513 | Old 0.8108 | New 0.6324
2024-12-07 20:07:26,713 - INFO - Weighted Accuracies: All 0.8005 | Old 0.8580 | New 0.6853
2024-12-07 20:07:27,344 - INFO - Saved model!
