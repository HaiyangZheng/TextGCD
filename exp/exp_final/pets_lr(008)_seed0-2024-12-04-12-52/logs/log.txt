2024-12-04 12:53:00,011 - INFO - Training pets_lr(008)_seed0 with the following settings:
2024-12-04 12:53:00,011 - INFO - Command-line arguments: output_dir=exp_final
 experiment_name=pets_lr(008)_seed0
 seed=0
 evaluate=False
 dataset_name=pets
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 19)
 unlabeled_classes=range(19, 37)
 num_labeled_classes=19
 num_unlabeled_classes=18
 log_path=exp_final/pets_lr(008)_seed0-2024-12-04-12-52/logs/log.txt
 model_path=exp_final/pets_lr(008)_seed0-2024-12-04-12-52/models/model.pth
 device=cuda
2024-12-04 12:53:00,015 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-04 12:53:02,868 - INFO - Building custom CLIP
2024-12-04 12:53:04,048 - INFO - Turning off gradients in both the image and the text encoder
2024-12-04 12:53:04,049 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-04 12:53:05,112 - INFO - len of train dataset: 3680
2024-12-04 12:53:05,112 - INFO - len of test dataset: 2738
2024-12-04 12:53:05,118 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-04 12:53:05,119 - INFO - Selecting 44 high-confidence samples for co-teaching.
2024-12-04 12:53:25,177 - INFO - Before Train Accuracies: All 0.1622 | Old 0.0583 | New 0.2167
2024-12-04 12:53:25,177 - INFO - Before Train Accuracies: All 0.1300 | Old 0.0456 | New 0.1744
2024-12-04 12:53:52,522 - INFO - Epoch 1/200, Total Loss: 11.1212, Base Loss: 8.9912, Con Loss: 2.1300, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-04 12:53:52,523 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-04 12:53:52,523 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-04 12:54:03,224 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.3178 | Old 0.3616 | New 0.2947
2024-12-04 12:54:03,224 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.0416 | Old 0.0148 | New 0.0557
2024-12-04 12:54:13,871 - INFO - Weighted Accuracies: All 0.0851 | Old 0.0764 | New 0.0897
2024-12-04 12:54:14,487 - INFO - Saved model!
2024-12-04 12:54:40,257 - INFO - Epoch 2/200, Total Loss: 7.3122, Base Loss: 5.2722, Con Loss: 2.0400, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-04 12:54:40,258 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-04 12:54:40,258 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-04 12:54:50,937 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.6216 | Old 0.6331 | New 0.6156
2024-12-04 12:54:50,938 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.4551 | Old 0.4168 | New 0.4752
2024-12-04 12:55:01,555 - INFO - Weighted Accuracies: All 0.5201 | Old 0.4030 | New 0.5816
2024-12-04 12:55:02,280 - INFO - Saved model!
2024-12-04 12:55:28,080 - INFO - Epoch 3/200, Total Loss: 5.1635, Base Loss: 3.1587, Con Loss: 2.0048, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-04 12:55:28,081 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-04 12:55:28,081 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-04 12:55:38,813 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.6728 | Old 0.7635 | New 0.6251
2024-12-04 12:55:38,813 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.5650 | Old 0.4963 | New 0.6011
2024-12-04 12:55:49,461 - INFO - Weighted Accuracies: All 0.6048 | Old 0.6723 | New 0.5694
2024-12-04 12:55:50,175 - INFO - Saved model!
2024-12-04 12:56:15,884 - INFO - Epoch 4/200, Total Loss: 4.4093, Base Loss: 2.4674, Con Loss: 1.9419, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-04 12:56:15,886 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-04 12:56:15,886 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-04 12:56:26,572 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.6987 | Old 0.7678 | New 0.6624
2024-12-04 12:56:26,572 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.6256 | Old 0.6045 | New 0.6368
2024-12-04 12:56:37,279 - INFO - Weighted Accuracies: All 0.6275 | Old 0.6469 | New 0.6173
2024-12-04 12:56:37,998 - INFO - Saved model!
