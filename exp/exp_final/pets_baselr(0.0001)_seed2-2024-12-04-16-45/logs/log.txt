2024-12-04 16:45:05,445 - INFO - Training pets_baselr(0.0001)_seed2 with the following settings:
2024-12-04 16:45:05,447 - INFO - Command-line arguments: output_dir=exp_final
 experiment_name=pets_baselr(0.0001)_seed2
 seed=2
 evaluate=False
 dataset_name=pets
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0001
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 19)
 unlabeled_classes=range(19, 37)
 num_labeled_classes=19
 num_unlabeled_classes=18
 log_path=exp_final/pets_baselr(0.0001)_seed2-2024-12-04-16-45/logs/log.txt
 model_path=exp_final/pets_baselr(0.0001)_seed2-2024-12-04-16-45/models/model.pth
 device=cuda
2024-12-04 16:45:05,451 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-04 16:45:07,888 - INFO - Building custom CLIP
2024-12-04 16:45:09,013 - INFO - Turning off gradients in both the image and the text encoder
2024-12-04 16:45:09,017 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-04 16:45:10,015 - INFO - len of train dataset: 3680
2024-12-04 16:45:10,015 - INFO - len of test dataset: 2738
2024-12-04 16:45:10,020 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-04 16:45:10,020 - INFO - Selecting 44 high-confidence samples for co-teaching.
2024-12-04 16:45:27,408 - INFO - Before Train Accuracies: All 0.1640 | Old 0.0541 | New 0.2217
2024-12-04 16:45:27,409 - INFO - Before Train Accuracies: All 0.1486 | Old 0.0180 | New 0.2173
2024-12-04 16:45:54,453 - INFO - Epoch 1/200, Total Loss: 12.1231, Base Loss: 9.8506, Con Loss: 2.2725, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-04 16:45:54,453 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-04 16:45:54,453 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 16:46:04,950 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.0548 | Old 0.0445 | New 0.0602
2024-12-04 16:46:04,951 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.0365 | Old 0.0000 | New 0.0557
2024-12-04 16:46:15,341 - INFO - Weighted Accuracies: All 0.1581 | Old 0.0000 | New 0.2412
2024-12-04 16:46:15,949 - INFO - Saved model!
2024-12-04 16:46:41,385 - INFO - Epoch 2/200, Total Loss: 10.9934, Base Loss: 8.8414, Con Loss: 2.1520, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-04 16:46:41,385 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-04 16:46:41,385 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 16:46:51,773 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.4375 | Old 0.3637 | New 0.4763
2024-12-04 16:46:51,773 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.1669 | Old 0.0732 | New 0.2162
2024-12-04 16:47:02,107 - INFO - Weighted Accuracies: All 0.2966 | Old 0.1835 | New 0.3560
2024-12-04 16:47:02,783 - INFO - Saved model!
2024-12-04 16:47:28,198 - INFO - Epoch 3/200, Total Loss: 6.9406, Base Loss: 4.8492, Con Loss: 2.0914, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-04 16:47:28,199 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-04 16:47:28,199 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 16:47:38,608 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.5676 | Old 0.5270 | New 0.5889
2024-12-04 16:47:38,608 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.3645 | Old 0.2460 | New 0.4267
2024-12-04 16:47:49,006 - INFO - Weighted Accuracies: All 0.4489 | Old 0.4433 | New 0.4518
2024-12-04 16:47:49,684 - INFO - Saved model!
2024-12-04 16:48:15,261 - INFO - Epoch 4/200, Total Loss: 5.7516, Base Loss: 3.6874, Con Loss: 2.0643, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-04 16:48:15,261 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-04 16:48:15,261 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 16:48:25,678 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.6056 | Old 0.6617 | New 0.5760
2024-12-04 16:48:25,678 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.4058 | Old 0.3415 | New 0.4396
2024-12-04 16:48:35,965 - INFO - Weighted Accuracies: All 0.5033 | Old 0.5122 | New 0.4986
2024-12-04 16:48:36,650 - INFO - Saved model!
2024-12-04 16:49:01,990 - INFO - Epoch 5/200, Total Loss: 5.2249, Base Loss: 3.2070, Con Loss: 2.0179, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-04 16:49:01,990 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-04 16:49:01,990 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 16:49:12,403 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.6541 | Old 0.6734 | New 0.6440
2024-12-04 16:49:12,403 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.4708 | Old 0.3616 | New 0.5281
2024-12-04 16:49:22,851 - INFO - Weighted Accuracies: All 0.5592 | Old 0.4517 | New 0.6156
2024-12-04 16:49:23,530 - INFO - Saved model!
2024-12-04 16:49:49,271 - INFO - Epoch 6/200, Total Loss: 4.8352, Base Loss: 2.8296, Con Loss: 2.0055, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-04 16:49:49,271 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-04 16:49:49,271 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 16:49:59,782 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.6574 | Old 0.6713 | New 0.6501
2024-12-04 16:49:59,782 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.5153 | Old 0.4624 | New 0.5432
2024-12-04 16:50:10,229 - INFO - Weighted Accuracies: All 0.5847 | Old 0.5101 | New 0.6240
2024-12-04 16:50:10,909 - INFO - Saved model!
2024-12-04 16:50:36,696 - INFO - Epoch 7/200, Total Loss: 4.6179, Base Loss: 2.5964, Con Loss: 2.0214, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-04 16:50:36,696 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-04 16:50:36,696 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 16:50:47,086 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.6560 | Old 0.6713 | New 0.6479
2024-12-04 16:50:47,086 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.5566 | Old 0.4666 | New 0.6039
2024-12-04 16:50:57,462 - INFO - Weighted Accuracies: All 0.6059 | Old 0.5387 | New 0.6412
2024-12-04 16:50:58,147 - INFO - Saved model!
2024-12-04 16:51:23,557 - INFO - Epoch 8/200, Total Loss: 4.4251, Base Loss: 2.4079, Con Loss: 2.0172, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-04 16:51:23,557 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-04 16:51:23,557 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 16:51:34,031 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.6541 | Old 0.6702 | New 0.6457
2024-12-04 16:51:34,031 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.5749 | Old 0.5313 | New 0.5978
2024-12-04 16:51:44,454 - INFO - Weighted Accuracies: All 0.6103 | Old 0.5429 | New 0.6457
2024-12-04 16:51:45,136 - INFO - Saved model!
2024-12-04 16:52:10,908 - INFO - Epoch 9/200, Total Loss: 4.2617, Base Loss: 2.2609, Con Loss: 2.0008, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-04 16:52:10,909 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-04 16:52:10,909 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 16:52:21,374 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.6706 | Old 0.6681 | New 0.6719
2024-12-04 16:52:21,374 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.5793 | Old 0.5843 | New 0.5766
2024-12-04 16:52:31,786 - INFO - Weighted Accuracies: All 0.6176 | Old 0.6023 | New 0.6256
2024-12-04 16:52:32,462 - INFO - Saved model!
2024-12-04 16:52:58,378 - INFO - Epoch 10/200, Total Loss: 4.0727, Base Loss: 2.1091, Con Loss: 1.9636, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-04 16:52:58,378 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-04 16:52:58,379 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 16:53:08,698 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.6706 | Old 0.6713 | New 0.6702
2024-12-04 16:53:08,698 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.5705 | Old 0.7381 | New 0.4825
2024-12-04 16:53:19,116 - INFO - Weighted Accuracies: All 0.6329 | Old 0.6225 | New 0.6384
2024-12-04 16:53:19,796 - INFO - Saved model!
2024-12-04 16:53:45,575 - INFO - Epoch 11/200, Total Loss: 3.9683, Base Loss: 2.0032, Con Loss: 1.9651, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-04 16:53:45,576 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-04 16:53:45,576 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 16:53:56,026 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.7009 | Old 0.7211 | New 0.6903
2024-12-04 16:53:56,026 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.6052 | Old 0.7275 | New 0.5409
2024-12-04 16:54:06,455 - INFO - Weighted Accuracies: All 0.6238 | Old 0.6914 | New 0.5883
2024-12-04 16:54:16,877 - INFO - len of text selected samples: 1360
2024-12-04 16:54:42,709 - INFO - Epoch 12/200, Total Loss: 5.7563, Base Loss: 1.9605, Con Loss: 1.9847, Pseudo Loss Image: 1.8111, Pseudo Loss Image: 1.8111
2024-12-04 16:54:42,710 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-04 16:54:42,710 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 16:54:53,149 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.7162 | Old 0.7222 | New 0.7131
2024-12-04 16:54:53,149 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.6552 | Old 0.7497 | New 0.6056
2024-12-04 16:55:03,461 - INFO - Weighted Accuracies: All 0.6954 | Old 0.7359 | New 0.6741
2024-12-04 16:55:04,143 - INFO - Saved model!
2024-12-04 16:55:14,563 - INFO - len of text selected samples: 1363
2024-12-04 16:55:40,523 - INFO - Epoch 13/200, Total Loss: 4.9079, Base Loss: 1.7429, Con Loss: 1.9593, Pseudo Loss Image: 1.2056, Pseudo Loss Image: 1.2056
2024-12-04 16:55:40,523 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-12-04 16:55:40,523 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 16:55:50,929 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.7177 | Old 0.7179 | New 0.7175
2024-12-04 16:55:50,929 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.7148 | Old 0.7593 | New 0.6914
2024-12-04 16:56:01,347 - INFO - Weighted Accuracies: All 0.7246 | Old 0.7423 | New 0.7153
2024-12-04 16:56:02,034 - INFO - Saved model!
2024-12-04 16:56:12,456 - INFO - len of text selected samples: 1384
2024-12-04 16:56:38,369 - INFO - Epoch 14/200, Total Loss: 4.5149, Base Loss: 1.6375, Con Loss: 1.9441, Pseudo Loss Image: 0.9333, Pseudo Loss Image: 0.9333
2024-12-04 16:56:38,370 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-12-04 16:56:38,370 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 16:56:48,812 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.7232 | Old 0.7179 | New 0.7259
2024-12-04 16:56:48,812 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.7352 | Old 0.7582 | New 0.7231
2024-12-04 16:56:59,266 - INFO - Weighted Accuracies: All 0.7337 | Old 0.7370 | New 0.7320
2024-12-04 16:56:59,953 - INFO - Saved model!
2024-12-04 16:57:10,379 - INFO - len of text selected samples: 1378
2024-12-04 16:57:36,339 - INFO - Epoch 15/200, Total Loss: 4.3021, Base Loss: 1.5607, Con Loss: 1.9402, Pseudo Loss Image: 0.8012, Pseudo Loss Image: 0.8012
2024-12-04 16:57:36,339 - INFO -    Param Group: classifier_head, Learning Rate: 0.0986
2024-12-04 16:57:36,339 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 16:57:46,722 - INFO - Text classifier Epoch 14 Train Accuracies: All 0.7213 | Old 0.7169 | New 0.7237
2024-12-04 16:57:46,722 - INFO - Image classifier Epoch 14 Train Accuracies: All 0.7659 | Old 0.7784 | New 0.7593
2024-12-04 16:57:57,171 - INFO - Weighted Accuracies: All 0.7367 | Old 0.7381 | New 0.7359
2024-12-04 16:57:57,864 - INFO - Saved model!
2024-12-04 16:58:08,252 - INFO - len of text selected samples: 1381
2024-12-04 16:58:34,071 - INFO - Epoch 16/200, Total Loss: 4.1255, Base Loss: 1.5167, Con Loss: 1.9280, Pseudo Loss Image: 0.6808, Pseudo Loss Image: 0.6808
2024-12-04 16:58:34,071 - INFO -    Param Group: classifier_head, Learning Rate: 0.0984
2024-12-04 16:58:34,072 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 16:58:44,468 - INFO - Text classifier Epoch 15 Train Accuracies: All 0.6983 | Old 0.7656 | New 0.6630
2024-12-04 16:58:44,468 - INFO - Image classifier Epoch 15 Train Accuracies: All 0.7951 | Old 0.7773 | New 0.8045
2024-12-04 16:58:54,766 - INFO - Weighted Accuracies: All 0.7359 | Old 0.7402 | New 0.7337
2024-12-04 16:59:15,491 - INFO - len of image selected samples: 1580
2024-12-04 16:59:15,501 - INFO - len of text selected samples: 1378
2024-12-04 16:59:41,141 - INFO - Epoch 17/200, Total Loss: 5.0048, Base Loss: 1.3764, Con Loss: 1.9244, Pseudo Loss Image: 0.6180, Pseudo Loss Image: 0.6180
2024-12-04 16:59:41,151 - INFO -    Param Group: classifier_head, Learning Rate: 0.0982
2024-12-04 16:59:41,151 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 16:59:51,570 - INFO - Text classifier Epoch 16 Train Accuracies: All 0.8119 | Old 0.7614 | New 0.8384
2024-12-04 16:59:51,570 - INFO - Image classifier Epoch 16 Train Accuracies: All 0.7863 | Old 0.7773 | New 0.7911
2024-12-04 17:00:02,003 - INFO - Weighted Accuracies: All 0.8455 | Old 0.7890 | New 0.8752
2024-12-04 17:00:02,692 - INFO - Saved model!
2024-12-04 17:00:23,545 - INFO - len of image selected samples: 1576
2024-12-04 17:00:23,570 - INFO - len of text selected samples: 1585
2024-12-04 17:00:49,451 - INFO - Epoch 18/200, Total Loss: 4.3617, Base Loss: 1.2253, Con Loss: 1.9247, Pseudo Loss Image: 0.5818, Pseudo Loss Image: 0.5818
2024-12-04 17:00:49,451 - INFO -    Param Group: classifier_head, Learning Rate: 0.0980
2024-12-04 17:00:49,451 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:00:59,955 - INFO - Text classifier Epoch 17 Train Accuracies: All 0.8185 | Old 0.7667 | New 0.8457
2024-12-04 17:00:59,955 - INFO - Image classifier Epoch 17 Train Accuracies: All 0.8419 | Old 0.7869 | New 0.8708
2024-12-04 17:01:10,308 - INFO - Weighted Accuracies: All 0.8408 | Old 0.7890 | New 0.8680
2024-12-04 17:01:31,223 - INFO - len of image selected samples: 1617
2024-12-04 17:01:31,236 - INFO - len of text selected samples: 1596
2024-12-04 17:01:57,144 - INFO - Epoch 19/200, Total Loss: 4.0744, Base Loss: 1.1426, Con Loss: 1.8988, Pseudo Loss Image: 0.5115, Pseudo Loss Image: 0.5115
2024-12-04 17:01:57,144 - INFO -    Param Group: classifier_head, Learning Rate: 0.0978
2024-12-04 17:01:57,144 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:02:07,600 - INFO - Text classifier Epoch 18 Train Accuracies: All 0.8645 | Old 0.7699 | New 0.9142
2024-12-04 17:02:07,600 - INFO - Image classifier Epoch 18 Train Accuracies: All 0.8448 | Old 0.7656 | New 0.8864
2024-12-04 17:02:18,065 - INFO - Weighted Accuracies: All 0.8612 | Old 0.7879 | New 0.8997
2024-12-04 17:02:18,751 - INFO - Saved model!
2024-12-04 17:02:39,585 - INFO - len of image selected samples: 1617
2024-12-04 17:02:39,587 - INFO - len of text selected samples: 1623
2024-12-04 17:03:05,547 - INFO - Epoch 20/200, Total Loss: 3.8880, Base Loss: 1.0925, Con Loss: 1.9064, Pseudo Loss Image: 0.4455, Pseudo Loss Image: 0.4455
2024-12-04 17:03:05,547 - INFO -    Param Group: classifier_head, Learning Rate: 0.0976
2024-12-04 17:03:05,547 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:03:16,082 - INFO - Text classifier Epoch 19 Train Accuracies: All 0.8641 | Old 0.7731 | New 0.9120
2024-12-04 17:03:16,082 - INFO - Image classifier Epoch 19 Train Accuracies: All 0.8554 | Old 0.7837 | New 0.8930
2024-12-04 17:03:26,472 - INFO - Weighted Accuracies: All 0.8576 | Old 0.7837 | New 0.8964
2024-12-04 17:03:47,301 - INFO - len of image selected samples: 1623
2024-12-04 17:03:47,305 - INFO - len of text selected samples: 1623
2024-12-04 17:04:13,201 - INFO - Epoch 21/200, Total Loss: 3.7712, Base Loss: 1.0756, Con Loss: 1.9259, Pseudo Loss Image: 0.4013, Pseudo Loss Image: 0.4013
2024-12-04 17:04:13,202 - INFO -    Param Group: classifier_head, Learning Rate: 0.0973
2024-12-04 17:04:13,202 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:04:23,761 - INFO - Text classifier Epoch 20 Train Accuracies: All 0.8645 | Old 0.7773 | New 0.9103
2024-12-04 17:04:23,761 - INFO - Image classifier Epoch 20 Train Accuracies: All 0.8535 | Old 0.7879 | New 0.8880
2024-12-04 17:04:34,087 - INFO - Weighted Accuracies: All 0.8667 | Old 0.7922 | New 0.9058
2024-12-04 17:04:34,776 - INFO - Saved model!
2024-12-04 17:04:55,556 - INFO - len of image selected samples: 1625
2024-12-04 17:04:55,556 - INFO - len of text selected samples: 1628
2024-12-04 17:05:21,000 - INFO - Epoch 22/200, Total Loss: 3.7038, Base Loss: 1.0777, Con Loss: 1.9025, Pseudo Loss Image: 0.3719, Pseudo Loss Image: 0.3719
2024-12-04 17:05:21,000 - INFO -    Param Group: classifier_head, Learning Rate: 0.0970
2024-12-04 17:05:21,000 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:05:31,486 - INFO - Text classifier Epoch 21 Train Accuracies: All 0.8462 | Old 0.7709 | New 0.8858
2024-12-04 17:05:31,487 - INFO - Image classifier Epoch 21 Train Accuracies: All 0.8565 | Old 0.7826 | New 0.8953
2024-12-04 17:05:41,821 - INFO - Weighted Accuracies: All 0.8587 | Old 0.7879 | New 0.8958
2024-12-04 17:06:02,622 - INFO - len of image selected samples: 1624
2024-12-04 17:06:02,622 - INFO - len of text selected samples: 1626
2024-12-04 17:06:28,120 - INFO - Epoch 23/200, Total Loss: 3.6074, Base Loss: 1.0868, Con Loss: 1.9090, Pseudo Loss Image: 0.3225, Pseudo Loss Image: 0.3225
2024-12-04 17:06:28,121 - INFO -    Param Group: classifier_head, Learning Rate: 0.0968
2024-12-04 17:06:28,121 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:06:38,591 - INFO - Text classifier Epoch 22 Train Accuracies: All 0.8477 | Old 0.7794 | New 0.8836
2024-12-04 17:06:38,591 - INFO - Image classifier Epoch 22 Train Accuracies: All 0.8514 | Old 0.7879 | New 0.8847
2024-12-04 17:06:48,998 - INFO - Weighted Accuracies: All 0.8587 | Old 0.7890 | New 0.8953
2024-12-04 17:07:09,850 - INFO - len of image selected samples: 1627
2024-12-04 17:07:09,850 - INFO - len of text selected samples: 1627
2024-12-04 17:07:35,695 - INFO - Epoch 24/200, Total Loss: 3.6128, Base Loss: 1.1027, Con Loss: 1.9220, Pseudo Loss Image: 0.3129, Pseudo Loss Image: 0.3129
2024-12-04 17:07:35,695 - INFO -    Param Group: classifier_head, Learning Rate: 0.0965
2024-12-04 17:07:35,695 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:07:46,110 - INFO - Text classifier Epoch 23 Train Accuracies: All 0.8685 | Old 0.7815 | New 0.9142
2024-12-04 17:07:46,110 - INFO - Image classifier Epoch 23 Train Accuracies: All 0.8466 | Old 0.7911 | New 0.8758
2024-12-04 17:07:56,511 - INFO - Weighted Accuracies: All 0.8634 | Old 0.7911 | New 0.9014
2024-12-04 17:08:17,366 - INFO - len of image selected samples: 1628
2024-12-04 17:08:17,367 - INFO - len of text selected samples: 1627
2024-12-04 17:08:43,311 - INFO - Epoch 25/200, Total Loss: 3.5197, Base Loss: 1.0482, Con Loss: 1.8981, Pseudo Loss Image: 0.3167, Pseudo Loss Image: 0.3167
2024-12-04 17:08:43,312 - INFO -    Param Group: classifier_head, Learning Rate: 0.0962
2024-12-04 17:08:43,312 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:08:54,015 - INFO - Text classifier Epoch 24 Train Accuracies: All 0.8470 | Old 0.7826 | New 0.8808
2024-12-04 17:08:54,015 - INFO - Image classifier Epoch 24 Train Accuracies: All 0.8514 | Old 0.8314 | New 0.8618
2024-12-04 17:09:04,456 - INFO - Weighted Accuracies: All 0.8572 | Old 0.7879 | New 0.8936
2024-12-04 17:09:25,370 - INFO - len of image selected samples: 1627
2024-12-04 17:09:25,373 - INFO - len of text selected samples: 1627
2024-12-04 17:09:51,105 - INFO - Epoch 26/200, Total Loss: 3.4523, Base Loss: 1.0319, Con Loss: 1.8720, Pseudo Loss Image: 0.2932, Pseudo Loss Image: 0.2932
2024-12-04 17:09:51,106 - INFO -    Param Group: classifier_head, Learning Rate: 0.0959
2024-12-04 17:09:51,106 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:10:01,616 - INFO - Text classifier Epoch 25 Train Accuracies: All 0.8517 | Old 0.7752 | New 0.8919
2024-12-04 17:10:01,616 - INFO - Image classifier Epoch 25 Train Accuracies: All 0.8477 | Old 0.7794 | New 0.8836
2024-12-04 17:10:12,017 - INFO - Weighted Accuracies: All 0.8594 | Old 0.7879 | New 0.8969
2024-12-04 17:10:32,895 - INFO - len of image selected samples: 1627
2024-12-04 17:10:32,895 - INFO - len of text selected samples: 1627
2024-12-04 17:10:59,009 - INFO - Epoch 27/200, Total Loss: 3.4482, Base Loss: 1.0628, Con Loss: 1.8774, Pseudo Loss Image: 0.2594, Pseudo Loss Image: 0.2594
2024-12-04 17:10:59,009 - INFO -    Param Group: classifier_head, Learning Rate: 0.0956
2024-12-04 17:10:59,009 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:11:09,533 - INFO - Text classifier Epoch 26 Train Accuracies: All 0.8419 | Old 0.7773 | New 0.8758
2024-12-04 17:11:09,533 - INFO - Image classifier Epoch 26 Train Accuracies: All 0.8382 | Old 0.7858 | New 0.8657
2024-12-04 17:11:20,014 - INFO - Weighted Accuracies: All 0.8506 | Old 0.7869 | New 0.8841
2024-12-04 17:11:40,947 - INFO - len of image selected samples: 1628
2024-12-04 17:11:40,948 - INFO - len of text selected samples: 1625
2024-12-04 17:12:06,836 - INFO - Epoch 28/200, Total Loss: 3.3726, Base Loss: 1.0514, Con Loss: 1.8799, Pseudo Loss Image: 0.2419, Pseudo Loss Image: 0.2419
2024-12-04 17:12:06,836 - INFO -    Param Group: classifier_head, Learning Rate: 0.0952
2024-12-04 17:12:06,836 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:12:17,326 - INFO - Text classifier Epoch 27 Train Accuracies: All 0.8499 | Old 0.7784 | New 0.8875
2024-12-04 17:12:17,326 - INFO - Image classifier Epoch 27 Train Accuracies: All 0.8430 | Old 0.8229 | New 0.8535
2024-12-04 17:12:27,735 - INFO - Weighted Accuracies: All 0.8572 | Old 0.7879 | New 0.8936
2024-12-04 17:12:48,633 - INFO - len of image selected samples: 1628
2024-12-04 17:12:48,634 - INFO - len of text selected samples: 1627
2024-12-04 17:13:14,295 - INFO - Epoch 29/200, Total Loss: 3.3487, Base Loss: 1.0383, Con Loss: 1.8611, Pseudo Loss Image: 0.2425, Pseudo Loss Image: 0.2425
2024-12-04 17:13:14,295 - INFO -    Param Group: classifier_head, Learning Rate: 0.0949
2024-12-04 17:13:14,296 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:13:24,713 - INFO - Text classifier Epoch 28 Train Accuracies: All 0.8539 | Old 0.7731 | New 0.8964
2024-12-04 17:13:24,714 - INFO - Image classifier Epoch 28 Train Accuracies: All 0.8375 | Old 0.8303 | New 0.8412
2024-12-04 17:13:35,158 - INFO - Weighted Accuracies: All 0.8535 | Old 0.7879 | New 0.8880
2024-12-04 17:13:56,045 - INFO - len of image selected samples: 1627
2024-12-04 17:13:56,045 - INFO - len of text selected samples: 1626
2024-12-04 17:14:22,108 - INFO - Epoch 30/200, Total Loss: 3.2780, Base Loss: 1.0196, Con Loss: 1.8673, Pseudo Loss Image: 0.2142, Pseudo Loss Image: 0.2142
2024-12-04 17:14:22,108 - INFO -    Param Group: classifier_head, Learning Rate: 0.0946
2024-12-04 17:14:22,108 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:14:32,600 - INFO - Text classifier Epoch 29 Train Accuracies: All 0.8455 | Old 0.8314 | New 0.8529
2024-12-04 17:14:32,600 - INFO - Image classifier Epoch 29 Train Accuracies: All 0.8426 | Old 0.8335 | New 0.8474
2024-12-04 17:14:43,018 - INFO - Weighted Accuracies: All 0.8517 | Old 0.7879 | New 0.8852
2024-12-04 17:15:04,064 - INFO - len of image selected samples: 1627
2024-12-04 17:15:04,082 - INFO - len of text selected samples: 1628
2024-12-04 17:15:29,740 - INFO - Epoch 31/200, Total Loss: 3.3098, Base Loss: 1.0421, Con Loss: 1.8594, Pseudo Loss Image: 0.2247, Pseudo Loss Image: 0.2247
2024-12-04 17:15:29,741 - INFO -    Param Group: classifier_head, Learning Rate: 0.0942
2024-12-04 17:15:29,741 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:15:40,236 - INFO - Text classifier Epoch 30 Train Accuracies: All 0.8477 | Old 0.7837 | New 0.8813
2024-12-04 17:15:40,243 - INFO - Image classifier Epoch 30 Train Accuracies: All 0.8386 | Old 0.8197 | New 0.8485
2024-12-04 17:15:50,699 - INFO - Weighted Accuracies: All 0.8506 | Old 0.8324 | New 0.8602
2024-12-04 17:16:11,676 - INFO - len of image selected samples: 1627
2024-12-04 17:16:11,676 - INFO - len of text selected samples: 1628
2024-12-04 17:16:37,138 - INFO - Epoch 32/200, Total Loss: 3.1705, Base Loss: 0.9630, Con Loss: 1.8344, Pseudo Loss Image: 0.2058, Pseudo Loss Image: 0.2058
2024-12-04 17:16:37,139 - INFO -    Param Group: classifier_head, Learning Rate: 0.0938
2024-12-04 17:16:37,139 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:16:47,714 - INFO - Text classifier Epoch 31 Train Accuracies: All 0.8462 | Old 0.8409 | New 0.8490
2024-12-04 17:16:47,715 - INFO - Image classifier Epoch 31 Train Accuracies: All 0.8349 | Old 0.8802 | New 0.8111
2024-12-04 17:16:58,140 - INFO - Weighted Accuracies: All 0.8415 | Old 0.8484 | New 0.8379
2024-12-04 17:17:19,071 - INFO - len of image selected samples: 1628
2024-12-04 17:17:19,072 - INFO - len of text selected samples: 1628
2024-12-04 17:17:44,718 - INFO - Epoch 33/200, Total Loss: 3.2589, Base Loss: 0.9823, Con Loss: 1.8514, Pseudo Loss Image: 0.2186, Pseudo Loss Image: 0.2186
2024-12-04 17:17:44,719 - INFO -    Param Group: classifier_head, Learning Rate: 0.0934
2024-12-04 17:17:44,719 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:17:55,267 - INFO - Text classifier Epoch 32 Train Accuracies: All 0.8313 | Old 0.8600 | New 0.8162
2024-12-04 17:17:55,267 - INFO - Image classifier Epoch 32 Train Accuracies: All 0.8477 | Old 0.7943 | New 0.8758
2024-12-04 17:18:05,696 - INFO - Weighted Accuracies: All 0.8440 | Old 0.7943 | New 0.8702
2024-12-04 17:18:26,662 - INFO - len of image selected samples: 1628
2024-12-04 17:18:26,677 - INFO - len of text selected samples: 1627
2024-12-04 17:18:52,745 - INFO - Epoch 34/200, Total Loss: 3.1410, Base Loss: 0.9665, Con Loss: 1.8207, Pseudo Loss Image: 0.2069, Pseudo Loss Image: 0.2069
2024-12-04 17:18:52,745 - INFO -    Param Group: classifier_head, Learning Rate: 0.0930
2024-12-04 17:18:52,745 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:19:03,268 - INFO - Text classifier Epoch 33 Train Accuracies: All 0.8470 | Old 0.8621 | New 0.8390
2024-12-04 17:19:03,268 - INFO - Image classifier Epoch 33 Train Accuracies: All 0.8389 | Old 0.8717 | New 0.8217
2024-12-04 17:19:13,632 - INFO - Weighted Accuracies: All 0.8462 | Old 0.8749 | New 0.8312
2024-12-04 17:19:34,592 - INFO - len of image selected samples: 1628
2024-12-04 17:19:34,594 - INFO - len of text selected samples: 1628
2024-12-04 17:20:00,352 - INFO - Epoch 35/200, Total Loss: 3.1550, Base Loss: 0.9968, Con Loss: 1.8100, Pseudo Loss Image: 0.1993, Pseudo Loss Image: 0.1993
2024-12-04 17:20:00,352 - INFO -    Param Group: classifier_head, Learning Rate: 0.0926
2024-12-04 17:20:00,352 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:20:10,799 - INFO - Text classifier Epoch 34 Train Accuracies: All 0.8444 | Old 0.8335 | New 0.8501
2024-12-04 17:20:10,799 - INFO - Image classifier Epoch 34 Train Accuracies: All 0.8389 | Old 0.8706 | New 0.8223
2024-12-04 17:20:21,315 - INFO - Weighted Accuracies: All 0.8470 | Old 0.8282 | New 0.8568
2024-12-04 17:20:42,113 - INFO - len of image selected samples: 1628
2024-12-04 17:20:42,117 - INFO - len of text selected samples: 1628
2024-12-04 17:21:07,769 - INFO - Epoch 36/200, Total Loss: 3.1203, Base Loss: 0.9606, Con Loss: 1.8075, Pseudo Loss Image: 0.1776, Pseudo Loss Image: 0.1776
2024-12-04 17:21:07,770 - INFO -    Param Group: classifier_head, Learning Rate: 0.0922
2024-12-04 17:21:07,770 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:21:18,339 - INFO - Text classifier Epoch 35 Train Accuracies: All 0.8444 | Old 0.7879 | New 0.8741
2024-12-04 17:21:18,339 - INFO - Image classifier Epoch 35 Train Accuracies: All 0.8342 | Old 0.8441 | New 0.8290
2024-12-04 17:21:28,802 - INFO - Weighted Accuracies: All 0.8448 | Old 0.7964 | New 0.8702
2024-12-04 17:21:49,812 - INFO - len of image selected samples: 1628
2024-12-04 17:21:49,828 - INFO - len of text selected samples: 1627
2024-12-04 17:22:15,711 - INFO - Epoch 37/200, Total Loss: 3.2892, Base Loss: 1.0892, Con Loss: 1.8450, Pseudo Loss Image: 0.1872, Pseudo Loss Image: 0.1872
2024-12-04 17:22:15,752 - INFO -    Param Group: classifier_head, Learning Rate: 0.0918
2024-12-04 17:22:15,752 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:22:26,182 - INFO - Text classifier Epoch 36 Train Accuracies: All 0.8411 | Old 0.8356 | New 0.8440
2024-12-04 17:22:26,182 - INFO - Image classifier Epoch 36 Train Accuracies: All 0.8335 | Old 0.8462 | New 0.8267
2024-12-04 17:22:36,718 - INFO - Weighted Accuracies: All 0.8426 | Old 0.8484 | New 0.8396
2024-12-04 17:22:57,826 - INFO - len of image selected samples: 1628
2024-12-04 17:22:57,840 - INFO - len of text selected samples: 1628
2024-12-04 17:23:23,926 - INFO - Epoch 38/200, Total Loss: 3.1288, Base Loss: 0.9891, Con Loss: 1.8053, Pseudo Loss Image: 0.1799, Pseudo Loss Image: 0.1799
2024-12-04 17:23:23,927 - INFO -    Param Group: classifier_head, Learning Rate: 0.0914
2024-12-04 17:23:23,927 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:23:34,373 - INFO - Text classifier Epoch 37 Train Accuracies: All 0.8316 | Old 0.8685 | New 0.8123
2024-12-04 17:23:34,373 - INFO - Image classifier Epoch 37 Train Accuracies: All 0.8324 | Old 0.8653 | New 0.8150
2024-12-04 17:23:44,900 - INFO - Weighted Accuracies: All 0.8360 | Old 0.8759 | New 0.8150
2024-12-04 17:24:05,785 - INFO - len of image selected samples: 1628
2024-12-04 17:24:05,789 - INFO - len of text selected samples: 1628
2024-12-04 17:24:31,560 - INFO - Epoch 39/200, Total Loss: 3.0848, Base Loss: 0.9653, Con Loss: 1.8042, Pseudo Loss Image: 0.1529, Pseudo Loss Image: 0.1529
2024-12-04 17:24:31,561 - INFO -    Param Group: classifier_head, Learning Rate: 0.0909
2024-12-04 17:24:31,561 - INFO -    Param Group: base_parameters, Learning Rate: 0.0001
2024-12-04 17:24:42,098 - INFO - Text classifier Epoch 38 Train Accuracies: All 0.8448 | Old 0.7858 | New 0.8758
2024-12-04 17:24:42,099 - INFO - Image classifier Epoch 38 Train Accuracies: All 0.8411 | Old 0.8462 | New 0.8384
2024-12-04 17:24:52,638 - INFO - Weighted Accuracies: All 0.8440 | Old 0.7985 | New 0.8680
2024-12-04 17:25:13,576 - INFO - len of image selected samples: 1628
2024-12-04 17:25:13,590 - INFO - len of text selected samples: 1628
