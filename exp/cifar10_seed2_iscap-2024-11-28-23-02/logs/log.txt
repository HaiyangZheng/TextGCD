2024-11-28 23:02:14,167 - INFO - Training cifar10_seed2_iscap with the following settings:
2024-11-28 23:02:14,171 - INFO - Command-line arguments: output_dir=exp
 experiment_name=cifar10_seed2_iscap
 seed=2
 evaluate=False
 dataset_name=cifar10
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.1
 tau_t_start=0.07
 tau_t_end=0.04
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 5)
 unlabeled_classes=range(5, 10)
 num_labeled_classes=5
 num_unlabeled_classes=5
 log_path=exp/cifar10_seed2_iscap-2024-11-28-23-02/logs/log.txt
 model_path=exp/cifar10_seed2_iscap-2024-11-28-23-02/models/model.pth
 device=cuda
2024-11-28 23:02:14,185 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-11-28 23:02:16,748 - INFO - Building custom CLIP
2024-11-28 23:02:17,942 - INFO - Turning off gradients in both the image and the text encoder
2024-11-28 23:02:17,944 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-11-28 23:02:23,383 - INFO - len of train dataset: 50000
2024-11-28 23:02:23,383 - INFO - len of test dataset: 37500
2024-11-28 23:02:23,393 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-11-28 23:02:23,394 - INFO - Selecting 2250 high-confidence samples for co-teaching.
2024-11-28 23:04:08,614 - INFO - Before Train Accuracies: All 0.2439 | Old 0.1451 | New 0.2933
2024-11-28 23:04:08,614 - INFO - Before Train Accuracies: All 0.2188 | Old 0.1313 | New 0.2625
2024-11-28 23:09:21,124 - INFO - Epoch 1/200, Total Loss: 3.5024, Base Loss: 1.4393, Con Loss: 2.0631, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-28 23:09:21,124 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-11-28 23:09:21,124 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-28 23:10:59,018 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.9710 | Old 0.9522 | New 0.9805
2024-11-28 23:10:59,019 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.9449 | Old 0.9276 | New 0.9536
2024-11-28 23:12:36,941 - INFO - Weighted Accuracies: All 0.8473 | Old 0.9728 | New 0.7845
2024-11-28 23:12:37,603 - INFO - Saved model!
2024-11-28 23:17:49,555 - INFO - Epoch 2/200, Total Loss: 2.5019, Base Loss: 0.6189, Con Loss: 1.8830, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-28 23:17:49,555 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-11-28 23:17:49,555 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-28 23:19:27,791 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.9690 | Old 0.9381 | New 0.9844
2024-11-28 23:19:27,791 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.9493 | Old 0.9074 | New 0.9702
2024-11-28 23:21:05,342 - INFO - Weighted Accuracies: All 0.8094 | Old 0.9650 | New 0.7316
2024-11-28 23:26:17,427 - INFO - Epoch 3/200, Total Loss: 2.3813, Base Loss: 0.5725, Con Loss: 1.8088, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-28 23:26:17,427 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-11-28 23:26:17,427 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-28 23:27:55,323 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.9725 | Old 0.9508 | New 0.9834
2024-11-28 23:27:55,324 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.9563 | Old 0.9304 | New 0.9692
2024-11-28 23:29:32,978 - INFO - Weighted Accuracies: All 0.8319 | Old 0.9732 | New 0.7613
2024-11-28 23:34:45,320 - INFO - Epoch 4/200, Total Loss: 2.2899, Base Loss: 0.5479, Con Loss: 1.7420, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-28 23:34:45,320 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-11-28 23:34:45,320 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-28 23:36:23,589 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.9692 | Old 0.9434 | New 0.9821
2024-11-28 23:36:23,589 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.9546 | Old 0.9355 | New 0.9642
2024-11-28 23:38:01,146 - INFO - Weighted Accuracies: All 0.8457 | Old 0.9724 | New 0.7824
2024-11-28 23:43:13,600 - INFO - Epoch 5/200, Total Loss: 2.2153, Base Loss: 0.5192, Con Loss: 1.6961, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-28 23:43:13,600 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-11-28 23:43:13,601 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-28 23:44:51,469 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.9722 | Old 0.9507 | New 0.9829
2024-11-28 23:44:51,470 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.9570 | Old 0.9326 | New 0.9692
2024-11-28 23:46:29,578 - INFO - Weighted Accuracies: All 0.8378 | Old 0.9739 | New 0.7697
2024-11-28 23:51:41,386 - INFO - Epoch 6/200, Total Loss: 2.1733, Base Loss: 0.5107, Con Loss: 1.6626, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-28 23:51:41,387 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-11-28 23:51:41,387 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-28 23:53:19,472 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.9686 | Old 0.9458 | New 0.9800
2024-11-28 23:53:19,472 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.9546 | Old 0.9305 | New 0.9666
2024-11-28 23:54:57,804 - INFO - Weighted Accuracies: All 0.8384 | Old 0.9733 | New 0.7710
2024-11-29 00:00:10,146 - INFO - Epoch 7/200, Total Loss: 2.1159, Base Loss: 0.4874, Con Loss: 1.6285, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-29 00:00:10,146 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-11-29 00:00:10,147 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:01:48,530 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.9700 | Old 0.9403 | New 0.9848
2024-11-29 00:01:48,530 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.9586 | Old 0.9234 | New 0.9762
2024-11-29 00:03:26,732 - INFO - Weighted Accuracies: All 0.8494 | Old 0.9717 | New 0.7883
2024-11-29 00:03:27,440 - INFO - Saved model!
2024-11-29 00:08:39,407 - INFO - Epoch 8/200, Total Loss: 2.0779, Base Loss: 0.4859, Con Loss: 1.5920, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-29 00:08:39,408 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-11-29 00:08:39,408 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:10:17,822 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.9719 | Old 0.9486 | New 0.9835
2024-11-29 00:10:17,822 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.9602 | Old 0.9451 | New 0.9678
2024-11-29 00:11:56,250 - INFO - Weighted Accuracies: All 0.8504 | Old 0.9770 | New 0.7871
2024-11-29 00:11:56,987 - INFO - Saved model!
2024-11-29 00:17:09,678 - INFO - Epoch 9/200, Total Loss: 2.0526, Base Loss: 0.4827, Con Loss: 1.5699, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-29 00:17:09,678 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-11-29 00:17:09,678 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:18:47,561 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.9705 | Old 0.9430 | New 0.9842
2024-11-29 00:18:47,561 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.9579 | Old 0.9414 | New 0.9662
2024-11-29 00:20:25,234 - INFO - Weighted Accuracies: All 0.8533 | Old 0.9749 | New 0.7925
2024-11-29 00:20:25,937 - INFO - Saved model!
2024-11-29 00:25:37,881 - INFO - Epoch 10/200, Total Loss: 2.0275, Base Loss: 0.4771, Con Loss: 1.5505, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-29 00:25:37,881 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-11-29 00:25:37,882 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:27:16,239 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.9705 | Old 0.9438 | New 0.9838
2024-11-29 00:27:16,239 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.9598 | Old 0.9342 | New 0.9727
2024-11-29 00:28:54,416 - INFO - Weighted Accuracies: All 0.8275 | Old 0.9732 | New 0.7547
2024-11-29 00:34:07,146 - INFO - Epoch 11/200, Total Loss: 2.0021, Base Loss: 0.4767, Con Loss: 1.5254, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-29 00:34:07,146 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-11-29 00:34:07,146 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:35:45,449 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.9680 | Old 0.9338 | New 0.9851
2024-11-29 00:35:45,449 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.9598 | Old 0.9191 | New 0.9802
2024-11-29 00:37:22,955 - INFO - Weighted Accuracies: All 0.8421 | Old 0.9678 | New 0.7793
2024-11-29 00:39:01,249 - INFO - len of text selected samples: 22500
2024-11-29 00:44:14,088 - INFO - Epoch 12/200, Total Loss: 2.2114, Base Loss: 0.4838, Con Loss: 1.5131, Pseudo Loss Image: 0.2145, Pseudo Loss Image: 0.2145
2024-11-29 00:44:14,089 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-11-29 00:44:14,089 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:45:52,493 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.9715 | Old 0.9460 | New 0.9843
2024-11-29 00:45:52,493 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.9547 | Old 0.9554 | New 0.9544
2024-11-29 00:47:30,267 - INFO - Weighted Accuracies: All 0.9818 | Old 0.9690 | New 0.9882
2024-11-29 00:47:31,003 - INFO - Saved model!
2024-11-29 00:49:08,777 - INFO - len of text selected samples: 22500
2024-11-29 00:54:22,966 - INFO - Epoch 13/200, Total Loss: 2.0899, Base Loss: 0.4591, Con Loss: 1.4962, Pseudo Loss Image: 0.1347, Pseudo Loss Image: 0.1347
2024-11-29 00:54:22,966 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-11-29 00:54:22,967 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:56:01,266 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.9694 | Old 0.9423 | New 0.9830
2024-11-29 00:56:01,266 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.9607 | Old 0.9562 | New 0.9630
2024-11-29 00:57:38,921 - INFO - Weighted Accuracies: All 0.9817 | Old 0.9684 | New 0.9883
2024-11-29 00:59:17,287 - INFO - len of text selected samples: 22500
2024-11-29 01:04:29,953 - INFO - Epoch 14/200, Total Loss: 2.0354, Base Loss: 0.4439, Con Loss: 1.4712, Pseudo Loss Image: 0.1204, Pseudo Loss Image: 0.1204
2024-11-29 01:04:29,953 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-11-29 01:04:29,953 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 01:06:08,138 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.9707 | Old 0.9450 | New 0.9836
2024-11-29 01:06:08,138 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.9631 | Old 0.9465 | New 0.9715
2024-11-29 01:07:46,192 - INFO - Weighted Accuracies: All 0.9814 | Old 0.9653 | New 0.9895
2024-11-29 01:09:24,771 - INFO - len of text selected samples: 22500
2024-11-29 01:14:38,651 - INFO - Epoch 15/200, Total Loss: 2.0353, Base Loss: 0.4530, Con Loss: 1.4627, Pseudo Loss Image: 0.1197, Pseudo Loss Image: 0.1197
2024-11-29 01:14:38,651 - INFO -    Param Group: classifier_head, Learning Rate: 0.0986
2024-11-29 01:14:38,651 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 01:16:16,967 - INFO - Text classifier Epoch 14 Train Accuracies: All 0.9712 | Old 0.9430 | New 0.9853
2024-11-29 01:16:16,967 - INFO - Image classifier Epoch 14 Train Accuracies: All 0.9636 | Old 0.9428 | New 0.9740
2024-11-29 01:17:54,519 - INFO - Weighted Accuracies: All 0.9817 | Old 0.9627 | New 0.9912
2024-11-29 01:19:32,694 - INFO - len of text selected samples: 22500
2024-11-29 01:24:45,945 - INFO - Epoch 16/200, Total Loss: 2.0236, Base Loss: 0.4508, Con Loss: 1.4487, Pseudo Loss Image: 0.1240, Pseudo Loss Image: 0.1240
2024-11-29 01:24:45,945 - INFO -    Param Group: classifier_head, Learning Rate: 0.0984
2024-11-29 01:24:45,945 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 01:26:23,753 - INFO - Text classifier Epoch 15 Train Accuracies: All 0.9700 | Old 0.9422 | New 0.9838
2024-11-29 01:26:23,753 - INFO - Image classifier Epoch 15 Train Accuracies: All 0.9657 | Old 0.9478 | New 0.9747
2024-11-29 01:28:01,774 - INFO - Weighted Accuracies: All 0.9817 | Old 0.9651 | New 0.9900
2024-11-29 01:31:18,616 - INFO - len of image selected samples: 22500
2024-11-29 01:31:18,617 - INFO - len of text selected samples: 22500
2024-11-29 01:36:32,627 - INFO - Epoch 17/200, Total Loss: 2.1073, Base Loss: 0.4488, Con Loss: 1.4265, Pseudo Loss Image: 0.1281, Pseudo Loss Image: 0.1281
2024-11-29 01:36:32,627 - INFO -    Param Group: classifier_head, Learning Rate: 0.0982
2024-11-29 01:36:32,627 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 01:38:10,889 - INFO - Text classifier Epoch 16 Train Accuracies: All 0.9752 | Old 0.9603 | New 0.9827
2024-11-29 01:38:10,889 - INFO - Image classifier Epoch 16 Train Accuracies: All 0.9647 | Old 0.9502 | New 0.9720
2024-11-29 01:39:49,037 - INFO - Weighted Accuracies: All 0.9832 | Old 0.9716 | New 0.9890
2024-11-29 01:39:49,785 - INFO - Saved model!
2024-11-29 01:43:06,511 - INFO - len of image selected samples: 22500
2024-11-29 01:43:06,511 - INFO - len of text selected samples: 22500
2024-11-29 01:48:20,125 - INFO - Epoch 18/200, Total Loss: 2.0465, Base Loss: 0.4353, Con Loss: 1.4161, Pseudo Loss Image: 0.1075, Pseudo Loss Image: 0.1075
2024-11-29 01:48:20,125 - INFO -    Param Group: classifier_head, Learning Rate: 0.0980
2024-11-29 01:48:20,126 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 01:49:58,499 - INFO - Text classifier Epoch 17 Train Accuracies: All 0.9754 | Old 0.9698 | New 0.9782
2024-11-29 01:49:58,499 - INFO - Image classifier Epoch 17 Train Accuracies: All 0.9623 | Old 0.9602 | New 0.9634
2024-11-29 01:51:36,664 - INFO - Weighted Accuracies: All 0.9823 | Old 0.9792 | New 0.9838
2024-11-29 01:54:52,960 - INFO - len of image selected samples: 22500
2024-11-29 01:54:52,960 - INFO - len of text selected samples: 22500
2024-11-29 02:00:07,340 - INFO - Epoch 19/200, Total Loss: 2.0219, Base Loss: 0.4287, Con Loss: 1.4018, Pseudo Loss Image: 0.1049, Pseudo Loss Image: 0.1049
2024-11-29 02:00:07,340 - INFO -    Param Group: classifier_head, Learning Rate: 0.0978
2024-11-29 02:00:07,340 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 02:01:46,958 - INFO - Text classifier Epoch 18 Train Accuracies: All 0.9779 | Old 0.9702 | New 0.9818
2024-11-29 02:01:46,959 - INFO - Image classifier Epoch 18 Train Accuracies: All 0.9617 | Old 0.9606 | New 0.9622
2024-11-29 02:03:25,270 - INFO - Weighted Accuracies: All 0.9840 | Old 0.9790 | New 0.9866
2024-11-29 02:03:25,984 - INFO - Saved model!
2024-11-29 02:06:42,288 - INFO - len of image selected samples: 22500
2024-11-29 02:06:42,288 - INFO - len of text selected samples: 22500
2024-11-29 02:11:56,206 - INFO - Epoch 20/200, Total Loss: 2.0099, Base Loss: 0.4290, Con Loss: 1.3980, Pseudo Loss Image: 0.1033, Pseudo Loss Image: 0.1033
2024-11-29 02:11:56,206 - INFO -    Param Group: classifier_head, Learning Rate: 0.0976
2024-11-29 02:11:56,206 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 02:13:34,392 - INFO - Text classifier Epoch 19 Train Accuracies: All 0.9784 | Old 0.9698 | New 0.9826
2024-11-29 02:13:34,393 - INFO - Image classifier Epoch 19 Train Accuracies: All 0.9656 | Old 0.9598 | New 0.9685
2024-11-29 02:15:12,692 - INFO - Weighted Accuracies: All 0.9839 | Old 0.9776 | New 0.9871
2024-11-29 02:18:28,770 - INFO - len of image selected samples: 22500
2024-11-29 02:18:28,770 - INFO - len of text selected samples: 22500
2024-11-29 02:23:43,363 - INFO - Epoch 21/200, Total Loss: 2.0021, Base Loss: 0.4430, Con Loss: 1.3858, Pseudo Loss Image: 0.0979, Pseudo Loss Image: 0.0979
2024-11-29 02:23:43,363 - INFO -    Param Group: classifier_head, Learning Rate: 0.0973
2024-11-29 02:23:43,363 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 02:25:21,655 - INFO - Text classifier Epoch 20 Train Accuracies: All 0.9790 | Old 0.9693 | New 0.9838
2024-11-29 02:25:21,655 - INFO - Image classifier Epoch 20 Train Accuracies: All 0.9655 | Old 0.9621 | New 0.9672
2024-11-29 02:26:59,475 - INFO - Weighted Accuracies: All 0.9843 | Old 0.9768 | New 0.9881
2024-11-29 02:27:00,183 - INFO - Saved model!
2024-11-29 02:30:16,725 - INFO - len of image selected samples: 22500
2024-11-29 02:30:16,725 - INFO - len of text selected samples: 22500
2024-11-29 02:35:30,367 - INFO - Epoch 22/200, Total Loss: 1.9932, Base Loss: 0.4310, Con Loss: 1.3768, Pseudo Loss Image: 0.1065, Pseudo Loss Image: 0.1065
2024-11-29 02:35:30,367 - INFO -    Param Group: classifier_head, Learning Rate: 0.0970
2024-11-29 02:35:30,367 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 02:37:08,602 - INFO - Text classifier Epoch 21 Train Accuracies: All 0.9773 | Old 0.9700 | New 0.9810
2024-11-29 02:37:08,602 - INFO - Image classifier Epoch 21 Train Accuracies: All 0.9669 | Old 0.9574 | New 0.9716
2024-11-29 02:38:46,661 - INFO - Weighted Accuracies: All 0.9840 | Old 0.9781 | New 0.9869
2024-11-29 02:42:03,353 - INFO - len of image selected samples: 22500
2024-11-29 02:42:03,353 - INFO - len of text selected samples: 22500
2024-11-29 02:47:17,646 - INFO - Epoch 23/200, Total Loss: 1.9633, Base Loss: 0.4300, Con Loss: 1.3672, Pseudo Loss Image: 0.0922, Pseudo Loss Image: 0.0922
2024-11-29 02:47:17,646 - INFO -    Param Group: classifier_head, Learning Rate: 0.0968
2024-11-29 02:47:17,646 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 02:48:55,909 - INFO - Text classifier Epoch 22 Train Accuracies: All 0.9780 | Old 0.9666 | New 0.9837
2024-11-29 02:48:55,909 - INFO - Image classifier Epoch 22 Train Accuracies: All 0.9592 | Old 0.9630 | New 0.9573
2024-11-29 02:50:33,668 - INFO - Weighted Accuracies: All 0.9833 | Old 0.9783 | New 0.9858
2024-11-29 02:53:49,772 - INFO - len of image selected samples: 22500
2024-11-29 02:53:49,773 - INFO - len of text selected samples: 22500
2024-11-29 02:59:03,399 - INFO - Epoch 24/200, Total Loss: 1.9500, Base Loss: 0.4191, Con Loss: 1.3496, Pseudo Loss Image: 0.0963, Pseudo Loss Image: 0.0963
2024-11-29 02:59:03,399 - INFO -    Param Group: classifier_head, Learning Rate: 0.0965
2024-11-29 02:59:03,399 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 03:00:41,597 - INFO - Text classifier Epoch 23 Train Accuracies: All 0.9788 | Old 0.9706 | New 0.9829
2024-11-29 03:00:41,597 - INFO - Image classifier Epoch 23 Train Accuracies: All 0.9680 | Old 0.9606 | New 0.9716
2024-11-29 03:02:19,686 - INFO - Weighted Accuracies: All 0.9849 | Old 0.9780 | New 0.9883
2024-11-29 03:02:20,398 - INFO - Saved model!
2024-11-29 03:05:36,863 - INFO - len of image selected samples: 22500
2024-11-29 03:05:36,863 - INFO - len of text selected samples: 22500
2024-11-29 03:10:50,991 - INFO - Epoch 25/200, Total Loss: 1.9165, Base Loss: 0.4164, Con Loss: 1.3405, Pseudo Loss Image: 0.0881, Pseudo Loss Image: 0.0881
2024-11-29 03:10:50,991 - INFO -    Param Group: classifier_head, Learning Rate: 0.0962
2024-11-29 03:10:50,991 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 03:12:28,897 - INFO - Text classifier Epoch 24 Train Accuracies: All 0.9786 | Old 0.9713 | New 0.9822
2024-11-29 03:12:28,897 - INFO - Image classifier Epoch 24 Train Accuracies: All 0.9637 | Old 0.9656 | New 0.9628
2024-11-29 03:14:06,637 - INFO - Weighted Accuracies: All 0.9836 | Old 0.9795 | New 0.9857
2024-11-29 03:17:23,140 - INFO - len of image selected samples: 22500
2024-11-29 03:17:23,140 - INFO - len of text selected samples: 22500
2024-11-29 03:22:37,911 - INFO - Epoch 26/200, Total Loss: 1.9277, Base Loss: 0.4280, Con Loss: 1.3299, Pseudo Loss Image: 0.0881, Pseudo Loss Image: 0.0881
2024-11-29 03:22:37,911 - INFO -    Param Group: classifier_head, Learning Rate: 0.0959
2024-11-29 03:22:37,911 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 03:24:15,765 - INFO - Text classifier Epoch 25 Train Accuracies: All 0.9771 | Old 0.9718 | New 0.9798
2024-11-29 03:24:15,765 - INFO - Image classifier Epoch 25 Train Accuracies: All 0.9650 | Old 0.9626 | New 0.9662
2024-11-29 03:25:54,078 - INFO - Weighted Accuracies: All 0.9834 | Old 0.9802 | New 0.9849
2024-11-29 03:29:10,264 - INFO - len of image selected samples: 22500
2024-11-29 03:29:10,264 - INFO - len of text selected samples: 22500
2024-11-29 03:34:23,728 - INFO - Epoch 27/200, Total Loss: 1.8994, Base Loss: 0.4205, Con Loss: 1.3243, Pseudo Loss Image: 0.0850, Pseudo Loss Image: 0.0850
2024-11-29 03:34:23,728 - INFO -    Param Group: classifier_head, Learning Rate: 0.0956
2024-11-29 03:34:23,728 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 03:36:01,763 - INFO - Text classifier Epoch 26 Train Accuracies: All 0.9785 | Old 0.9694 | New 0.9831
2024-11-29 03:36:01,763 - INFO - Image classifier Epoch 26 Train Accuracies: All 0.9606 | Old 0.9706 | New 0.9556
2024-11-29 03:37:39,859 - INFO - Weighted Accuracies: All 0.9831 | Old 0.9799 | New 0.9847
2024-11-29 03:40:56,468 - INFO - len of image selected samples: 22500
2024-11-29 03:40:56,468 - INFO - len of text selected samples: 22500
2024-11-29 03:46:09,771 - INFO - Epoch 28/200, Total Loss: 1.9306, Base Loss: 0.4330, Con Loss: 1.3245, Pseudo Loss Image: 0.0929, Pseudo Loss Image: 0.0929
2024-11-29 03:46:09,771 - INFO -    Param Group: classifier_head, Learning Rate: 0.0952
2024-11-29 03:46:09,771 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 03:47:48,036 - INFO - Text classifier Epoch 27 Train Accuracies: All 0.9779 | Old 0.9754 | New 0.9791
2024-11-29 03:47:48,037 - INFO - Image classifier Epoch 27 Train Accuracies: All 0.9651 | Old 0.9656 | New 0.9649
2024-11-29 03:49:26,532 - INFO - Weighted Accuracies: All 0.9830 | Old 0.9811 | New 0.9840
2024-11-29 03:52:42,924 - INFO - len of image selected samples: 22500
2024-11-29 03:52:42,924 - INFO - len of text selected samples: 22500
2024-11-29 03:57:57,094 - INFO - Epoch 29/200, Total Loss: 1.8996, Base Loss: 0.4229, Con Loss: 1.3109, Pseudo Loss Image: 0.0928, Pseudo Loss Image: 0.0928
2024-11-29 03:57:57,095 - INFO -    Param Group: classifier_head, Learning Rate: 0.0949
2024-11-29 03:57:57,095 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 03:59:35,497 - INFO - Text classifier Epoch 28 Train Accuracies: All 0.9782 | Old 0.9718 | New 0.9814
2024-11-29 03:59:35,497 - INFO - Image classifier Epoch 28 Train Accuracies: All 0.9670 | Old 0.9697 | New 0.9656
2024-11-29 04:01:13,190 - INFO - Weighted Accuracies: All 0.9833 | Old 0.9797 | New 0.9851
2024-11-29 04:04:29,005 - INFO - len of image selected samples: 22500
2024-11-29 04:04:29,005 - INFO - len of text selected samples: 22500
2024-11-29 04:09:43,147 - INFO - Epoch 30/200, Total Loss: 1.8724, Base Loss: 0.4159, Con Loss: 1.3031, Pseudo Loss Image: 0.0792, Pseudo Loss Image: 0.0792
2024-11-29 04:09:43,147 - INFO -    Param Group: classifier_head, Learning Rate: 0.0946
2024-11-29 04:09:43,147 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 04:11:21,296 - INFO - Text classifier Epoch 29 Train Accuracies: All 0.9787 | Old 0.9735 | New 0.9814
2024-11-29 04:11:21,297 - INFO - Image classifier Epoch 29 Train Accuracies: All 0.9691 | Old 0.9629 | New 0.9722
2024-11-29 04:12:59,327 - INFO - Weighted Accuracies: All 0.9839 | Old 0.9789 | New 0.9864
2024-11-29 04:16:15,786 - INFO - len of image selected samples: 22500
2024-11-29 04:16:15,786 - INFO - len of text selected samples: 22500
2024-11-29 04:21:30,445 - INFO - Epoch 31/200, Total Loss: 1.8502, Base Loss: 0.4156, Con Loss: 1.2916, Pseudo Loss Image: 0.0782, Pseudo Loss Image: 0.0782
2024-11-29 04:21:30,445 - INFO -    Param Group: classifier_head, Learning Rate: 0.0942
2024-11-29 04:21:30,445 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 04:23:08,600 - INFO - Text classifier Epoch 30 Train Accuracies: All 0.9787 | Old 0.9703 | New 0.9829
2024-11-29 04:23:08,600 - INFO - Image classifier Epoch 30 Train Accuracies: All 0.9651 | Old 0.9734 | New 0.9610
2024-11-29 04:24:46,353 - INFO - Weighted Accuracies: All 0.9835 | Old 0.9806 | New 0.9850
2024-11-29 04:28:02,824 - INFO - len of image selected samples: 22500
2024-11-29 04:28:02,824 - INFO - len of text selected samples: 22500
2024-11-29 04:33:16,349 - INFO - Epoch 32/200, Total Loss: 1.8499, Base Loss: 0.4163, Con Loss: 1.2841, Pseudo Loss Image: 0.0790, Pseudo Loss Image: 0.0790
2024-11-29 04:33:16,350 - INFO -    Param Group: classifier_head, Learning Rate: 0.0938
2024-11-29 04:33:16,350 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 04:34:54,539 - INFO - Text classifier Epoch 31 Train Accuracies: All 0.9780 | Old 0.9752 | New 0.9794
2024-11-29 04:34:54,539 - INFO - Image classifier Epoch 31 Train Accuracies: All 0.9685 | Old 0.9595 | New 0.9730
2024-11-29 04:36:32,206 - INFO - Weighted Accuracies: All 0.9841 | Old 0.9805 | New 0.9860
2024-11-29 04:39:48,405 - INFO - len of image selected samples: 22500
2024-11-29 04:39:48,405 - INFO - len of text selected samples: 22500
2024-11-29 04:45:02,916 - INFO - Epoch 33/200, Total Loss: 1.8342, Base Loss: 0.4136, Con Loss: 1.2818, Pseudo Loss Image: 0.0781, Pseudo Loss Image: 0.0781
2024-11-29 04:45:02,916 - INFO -    Param Group: classifier_head, Learning Rate: 0.0934
2024-11-29 04:45:02,916 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 04:46:41,339 - INFO - Text classifier Epoch 32 Train Accuracies: All 0.9798 | Old 0.9702 | New 0.9846
2024-11-29 04:46:41,339 - INFO - Image classifier Epoch 32 Train Accuracies: All 0.9669 | Old 0.9703 | New 0.9652
2024-11-29 04:48:19,275 - INFO - Weighted Accuracies: All 0.9844 | Old 0.9795 | New 0.9868
2024-11-29 04:51:34,852 - INFO - len of image selected samples: 22500
2024-11-29 04:51:34,853 - INFO - len of text selected samples: 22500
2024-11-29 04:56:47,599 - INFO - Epoch 34/200, Total Loss: 1.8301, Base Loss: 0.4093, Con Loss: 1.2715, Pseudo Loss Image: 0.0784, Pseudo Loss Image: 0.0784
2024-11-29 04:56:47,599 - INFO -    Param Group: classifier_head, Learning Rate: 0.0930
2024-11-29 04:56:47,599 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 04:58:25,163 - INFO - Text classifier Epoch 33 Train Accuracies: All 0.9787 | Old 0.9722 | New 0.9820
2024-11-29 04:58:25,163 - INFO - Image classifier Epoch 33 Train Accuracies: All 0.9658 | Old 0.9693 | New 0.9640
2024-11-29 05:00:02,886 - INFO - Weighted Accuracies: All 0.9836 | Old 0.9806 | New 0.9851
2024-11-29 05:03:18,437 - INFO - len of image selected samples: 22500
2024-11-29 05:03:18,438 - INFO - len of text selected samples: 22500
2024-11-29 05:08:32,873 - INFO - Epoch 35/200, Total Loss: 1.8113, Base Loss: 0.4120, Con Loss: 1.2610, Pseudo Loss Image: 0.0753, Pseudo Loss Image: 0.0753
2024-11-29 05:08:32,874 - INFO -    Param Group: classifier_head, Learning Rate: 0.0926
2024-11-29 05:08:32,874 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 05:10:10,913 - INFO - Text classifier Epoch 34 Train Accuracies: All 0.9794 | Old 0.9724 | New 0.9828
2024-11-29 05:10:10,914 - INFO - Image classifier Epoch 34 Train Accuracies: All 0.9653 | Old 0.9711 | New 0.9623
2024-11-29 05:11:48,847 - INFO - Weighted Accuracies: All 0.9836 | Old 0.9816 | New 0.9846
2024-11-29 05:15:04,892 - INFO - len of image selected samples: 22500
2024-11-29 05:15:04,892 - INFO - len of text selected samples: 22500
2024-11-29 05:20:17,406 - INFO - Epoch 36/200, Total Loss: 1.8094, Base Loss: 0.4127, Con Loss: 1.2597, Pseudo Loss Image: 0.0704, Pseudo Loss Image: 0.0704
2024-11-29 05:20:17,406 - INFO -    Param Group: classifier_head, Learning Rate: 0.0922
2024-11-29 05:20:17,406 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 05:21:55,388 - INFO - Text classifier Epoch 35 Train Accuracies: All 0.9796 | Old 0.9714 | New 0.9838
2024-11-29 05:21:55,388 - INFO - Image classifier Epoch 35 Train Accuracies: All 0.9672 | Old 0.9714 | New 0.9651
2024-11-29 05:23:33,327 - INFO - Weighted Accuracies: All 0.9841 | Old 0.9810 | New 0.9856
2024-11-29 05:26:48,446 - INFO - len of image selected samples: 22500
2024-11-29 05:26:48,446 - INFO - len of text selected samples: 22500
2024-11-29 05:32:01,414 - INFO - Epoch 37/200, Total Loss: 1.8041, Base Loss: 0.4151, Con Loss: 1.2527, Pseudo Loss Image: 0.0705, Pseudo Loss Image: 0.0705
2024-11-29 05:32:01,414 - INFO -    Param Group: classifier_head, Learning Rate: 0.0918
2024-11-29 05:32:01,414 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 05:33:39,256 - INFO - Text classifier Epoch 36 Train Accuracies: All 0.9794 | Old 0.9723 | New 0.9829
2024-11-29 05:33:39,256 - INFO - Image classifier Epoch 36 Train Accuracies: All 0.9678 | Old 0.9672 | New 0.9682
2024-11-29 05:35:16,990 - INFO - Weighted Accuracies: All 0.9837 | Old 0.9802 | New 0.9855
2024-11-29 05:38:32,353 - INFO - len of image selected samples: 22500
2024-11-29 05:38:32,354 - INFO - len of text selected samples: 22500
2024-11-29 05:43:46,059 - INFO - Epoch 38/200, Total Loss: 1.7928, Base Loss: 0.4059, Con Loss: 1.2468, Pseudo Loss Image: 0.0763, Pseudo Loss Image: 0.0763
2024-11-29 05:43:46,060 - INFO -    Param Group: classifier_head, Learning Rate: 0.0914
2024-11-29 05:43:46,060 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 05:45:24,047 - INFO - Text classifier Epoch 37 Train Accuracies: All 0.9792 | Old 0.9732 | New 0.9822
2024-11-29 05:45:24,047 - INFO - Image classifier Epoch 37 Train Accuracies: All 0.9683 | Old 0.9631 | New 0.9710
2024-11-29 05:47:02,076 - INFO - Weighted Accuracies: All 0.9842 | Old 0.9802 | New 0.9862
2024-11-29 05:50:17,741 - INFO - len of image selected samples: 22500
2024-11-29 05:50:17,741 - INFO - len of text selected samples: 22500
2024-11-29 05:55:31,225 - INFO - Epoch 39/200, Total Loss: 1.7892, Base Loss: 0.4157, Con Loss: 1.2382, Pseudo Loss Image: 0.0690, Pseudo Loss Image: 0.0690
2024-11-29 05:55:31,225 - INFO -    Param Group: classifier_head, Learning Rate: 0.0909
2024-11-29 05:55:31,225 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 05:57:09,254 - INFO - Text classifier Epoch 38 Train Accuracies: All 0.9801 | Old 0.9715 | New 0.9844
2024-11-29 05:57:09,254 - INFO - Image classifier Epoch 38 Train Accuracies: All 0.9714 | Old 0.9656 | New 0.9744
2024-11-29 05:58:47,109 - INFO - Weighted Accuracies: All 0.9850 | Old 0.9792 | New 0.9878
2024-11-29 05:58:47,859 - INFO - Saved model!
2024-11-29 06:02:02,805 - INFO - len of image selected samples: 22500
2024-11-29 06:02:02,805 - INFO - len of text selected samples: 22500
2024-11-29 06:07:16,213 - INFO - Epoch 40/200, Total Loss: 1.7729, Base Loss: 0.4044, Con Loss: 1.2383, Pseudo Loss Image: 0.0670, Pseudo Loss Image: 0.0670
2024-11-29 06:07:16,215 - INFO -    Param Group: classifier_head, Learning Rate: 0.0905
2024-11-29 06:07:16,216 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 06:08:54,146 - INFO - Text classifier Epoch 39 Train Accuracies: All 0.9787 | Old 0.9724 | New 0.9818
2024-11-29 06:08:54,146 - INFO - Image classifier Epoch 39 Train Accuracies: All 0.9702 | Old 0.9679 | New 0.9713
2024-11-29 06:10:31,758 - INFO - Weighted Accuracies: All 0.9843 | Old 0.9802 | New 0.9864
2024-11-29 06:13:47,777 - INFO - len of image selected samples: 22500
2024-11-29 06:13:47,778 - INFO - len of text selected samples: 22500
2024-11-29 06:19:00,201 - INFO - Epoch 41/200, Total Loss: 1.7599, Base Loss: 0.4052, Con Loss: 1.2293, Pseudo Loss Image: 0.0699, Pseudo Loss Image: 0.0699
2024-11-29 06:19:00,201 - INFO -    Param Group: classifier_head, Learning Rate: 0.0900
2024-11-29 06:19:00,201 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 06:20:37,955 - INFO - Text classifier Epoch 40 Train Accuracies: All 0.9799 | Old 0.9711 | New 0.9842
2024-11-29 06:20:37,955 - INFO - Image classifier Epoch 40 Train Accuracies: All 0.9648 | Old 0.9713 | New 0.9616
2024-11-29 06:22:15,868 - INFO - Weighted Accuracies: All 0.9839 | Old 0.9808 | New 0.9855
2024-11-29 06:25:31,960 - INFO - len of image selected samples: 22500
2024-11-29 06:25:31,960 - INFO - len of text selected samples: 22500
2024-11-29 06:30:45,526 - INFO - Epoch 42/200, Total Loss: 1.7746, Base Loss: 0.4139, Con Loss: 1.2234, Pseudo Loss Image: 0.0693, Pseudo Loss Image: 0.0693
2024-11-29 06:30:45,526 - INFO -    Param Group: classifier_head, Learning Rate: 0.0895
2024-11-29 06:30:45,526 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 06:32:23,538 - INFO - Text classifier Epoch 41 Train Accuracies: All 0.9781 | Old 0.9754 | New 0.9795
2024-11-29 06:32:23,538 - INFO - Image classifier Epoch 41 Train Accuracies: All 0.9668 | Old 0.9693 | New 0.9656
