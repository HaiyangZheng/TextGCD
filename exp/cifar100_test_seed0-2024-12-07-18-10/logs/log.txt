2024-12-07 18:10:38,925 - INFO - Training cifar100_test_seed0 with the following settings:
2024-12-07 18:10:38,925 - INFO - Command-line arguments: output_dir=exp
 experiment_name=cifar100_test_seed0
 seed=0
 evaluate=False
 dataset_name=cifar100
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 80)
 unlabeled_classes=range(80, 100)
 num_labeled_classes=80
 num_unlabeled_classes=20
 log_path=exp/cifar100_test_seed0-2024-12-07-18-10/logs/log.txt
 model_path=exp/cifar100_test_seed0-2024-12-07-18-10/models/model.pth
 device=cuda
2024-12-07 18:10:38,929 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-07 18:10:41,319 - INFO - Building custom CLIP
2024-12-07 18:10:42,397 - INFO - Turning off gradients in both the image and the text encoder
2024-12-07 18:10:42,399 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 18:10:47,468 - INFO - len of train dataset: 50000
2024-12-07 18:10:47,468 - INFO - len of test dataset: 30000
2024-12-07 18:10:47,477 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 18:10:47,477 - INFO - Selecting 180 high-confidence samples for co-teaching.
2024-12-07 18:12:10,055 - INFO - Before Train Accuracies: All 0.1219 | Old 0.0694 | New 0.2268
2024-12-07 18:12:10,055 - INFO - Before Train Accuracies: All 0.0706 | Old 0.0245 | New 0.1626
2024-12-07 18:17:20,781 - INFO - Epoch 1/200, Total Loss: 6.6002, Base Loss: 4.9664, Con Loss: 1.6338, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 18:17:20,782 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 18:17:20,782 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 18:18:39,067 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.6894 | Old 0.6896 | New 0.6891
2024-12-07 18:18:39,067 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.5623 | Old 0.6218 | New 0.4434
2024-12-07 18:19:57,639 - INFO - Weighted Accuracies: All 0.6571 | Old 0.7087 | New 0.5537
2024-12-07 18:19:58,268 - INFO - Saved model!
2024-12-07 18:25:08,786 - INFO - Epoch 2/200, Total Loss: 4.2276, Base Loss: 2.7104, Con Loss: 1.5172, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 18:25:08,786 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 18:25:08,786 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 18:26:27,274 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.7219 | Old 0.7935 | New 0.5788
2024-12-07 18:26:27,274 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.6034 | Old 0.6815 | New 0.4472
2024-12-07 18:27:45,330 - INFO - Weighted Accuracies: All 0.6679 | Old 0.7597 | New 0.4844
2024-12-07 18:27:45,990 - INFO - Saved model!
2024-12-07 18:32:56,422 - INFO - Epoch 3/200, Total Loss: 3.8961, Base Loss: 2.4414, Con Loss: 1.4547, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 18:32:56,423 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 18:32:56,423 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 18:34:14,665 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.7243 | Old 0.7995 | New 0.5739
2024-12-07 18:34:14,665 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.6192 | Old 0.7246 | New 0.4083
2024-12-07 18:35:33,311 - INFO - Weighted Accuracies: All 0.6629 | Old 0.7907 | New 0.4072
2024-12-07 18:40:43,240 - INFO - Epoch 4/200, Total Loss: 3.7354, Base Loss: 2.3253, Con Loss: 1.4101, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 18:40:43,240 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 18:40:43,240 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 18:42:01,758 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.7378 | Old 0.8007 | New 0.6120
2024-12-07 18:42:01,758 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.6429 | Old 0.7643 | New 0.4001
2024-12-07 18:43:19,922 - INFO - Weighted Accuracies: All 0.6576 | Old 0.8025 | New 0.3677
2024-12-07 18:48:29,660 - INFO - Epoch 5/200, Total Loss: 3.6313, Base Loss: 2.2583, Con Loss: 1.3731, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 18:48:29,660 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 18:48:29,660 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 18:49:48,134 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.7168 | Old 0.8035 | New 0.5434
2024-12-07 18:49:48,135 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.6501 | Old 0.7659 | New 0.4187
2024-12-07 18:51:06,016 - INFO - Weighted Accuracies: All 0.6620 | Old 0.7942 | New 0.3977
2024-12-07 18:56:16,108 - INFO - Epoch 6/200, Total Loss: 3.5827, Base Loss: 2.2260, Con Loss: 1.3567, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 18:56:16,108 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 18:56:16,108 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 18:57:35,942 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.7181 | Old 0.7994 | New 0.5553
2024-12-07 18:57:35,942 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.6593 | Old 0.7677 | New 0.4425
2024-12-07 18:58:55,113 - INFO - Weighted Accuracies: All 0.6634 | Old 0.8136 | New 0.3630
2024-12-07 19:04:09,168 - INFO - Epoch 7/200, Total Loss: 3.4989, Base Loss: 2.1694, Con Loss: 1.3295, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 19:04:09,169 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-07 19:04:09,169 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:05:29,312 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.7161 | Old 0.8035 | New 0.5413
2024-12-07 19:05:29,312 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.6695 | Old 0.7687 | New 0.4710
2024-12-07 19:06:48,092 - INFO - Weighted Accuracies: All 0.6687 | Old 0.8067 | New 0.3926
2024-12-07 19:06:48,759 - INFO - Saved model!
2024-12-07 19:12:02,919 - INFO - Epoch 8/200, Total Loss: 3.4504, Base Loss: 2.1383, Con Loss: 1.3120, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 19:12:02,920 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-07 19:12:02,920 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:13:21,590 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.7274 | Old 0.8137 | New 0.5546
2024-12-07 19:13:21,590 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.6717 | Old 0.7778 | New 0.4595
2024-12-07 19:14:40,864 - INFO - Weighted Accuracies: All 0.6685 | Old 0.8181 | New 0.3694
2024-12-07 19:19:54,784 - INFO - Epoch 9/200, Total Loss: 3.4009, Base Loss: 2.1073, Con Loss: 1.2936, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 19:19:54,784 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-07 19:19:54,784 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:21:13,432 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.7220 | Old 0.8105 | New 0.5450
2024-12-07 19:21:13,436 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.6835 | Old 0.7754 | New 0.4996
2024-12-07 19:22:32,264 - INFO - Weighted Accuracies: All 0.6804 | Old 0.8063 | New 0.4287
2024-12-07 19:22:32,926 - INFO - Saved model!
2024-12-07 19:27:47,358 - INFO - Epoch 10/200, Total Loss: 3.3490, Base Loss: 2.0773, Con Loss: 1.2716, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 19:27:47,358 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-07 19:27:47,358 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:29:06,740 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.7479 | Old 0.8146 | New 0.6144
2024-12-07 19:29:06,740 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.6867 | Old 0.7875 | New 0.4850
2024-12-07 19:30:25,647 - INFO - Weighted Accuracies: All 0.6750 | Old 0.8175 | New 0.3900
2024-12-07 19:35:40,495 - INFO - Epoch 11/200, Total Loss: 3.3139, Base Loss: 2.0484, Con Loss: 1.2655, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 19:35:40,495 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-07 19:35:40,495 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:36:59,391 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.7433 | Old 0.8136 | New 0.6028
2024-12-07 19:36:59,391 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.6860 | Old 0.7818 | New 0.4944
2024-12-07 19:38:18,783 - INFO - Weighted Accuracies: All 0.6645 | Old 0.8285 | New 0.3366
2024-12-07 19:39:36,668 - INFO - len of text selected samples: 18000
2024-12-07 19:44:51,119 - INFO - Epoch 12/200, Total Loss: 4.1955, Base Loss: 2.0139, Con Loss: 1.2837, Pseudo Loss Image: 0.8980, Pseudo Loss Text: 0.0000
2024-12-07 19:44:51,119 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-07 19:44:51,120 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:46:10,178 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.7387 | Old 0.8162 | New 0.5838
2024-12-07 19:46:10,178 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.7605 | Old 0.7972 | New 0.6872
2024-12-07 19:47:29,650 - INFO - Weighted Accuracies: All 0.8088 | Old 0.8524 | New 0.7218
2024-12-07 19:47:30,336 - INFO - Saved model!
2024-12-07 19:48:48,625 - INFO - len of text selected samples: 18000
2024-12-07 19:54:03,476 - INFO - Epoch 13/200, Total Loss: 3.9198, Base Loss: 1.9815, Con Loss: 1.2644, Pseudo Loss Image: 0.6740, Pseudo Loss Text: 0.0000
2024-12-07 19:54:03,476 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-12-07 19:54:03,476 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:55:22,705 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.7456 | Old 0.8177 | New 0.6012
2024-12-07 19:55:22,705 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.7603 | Old 0.8003 | New 0.6804
2024-12-07 19:56:42,560 - INFO - Weighted Accuracies: All 0.8097 | Old 0.8544 | New 0.7203
2024-12-07 19:56:43,225 - INFO - Saved model!
2024-12-07 19:58:01,368 - INFO - len of text selected samples: 17999
2024-12-07 20:03:15,614 - INFO - Epoch 14/200, Total Loss: 3.8622, Base Loss: 2.0015, Con Loss: 1.2600, Pseudo Loss Image: 0.6008, Pseudo Loss Text: 0.0000
2024-12-07 20:03:15,616 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-12-07 20:03:15,616 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:04:35,133 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.7495 | Old 0.8173 | New 0.6140
2024-12-07 20:04:35,133 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.7417 | Old 0.8067 | New 0.6117
2024-12-07 20:05:53,812 - INFO - Weighted Accuracies: All 0.7861 | Old 0.8547 | New 0.6490
2024-12-07 20:07:12,210 - INFO - len of text selected samples: 18000
