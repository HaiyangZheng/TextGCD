2024-12-07 20:38:02,540 - INFO - Training scars_test_seed3 with the following settings:
2024-12-07 20:38:02,544 - INFO - Command-line arguments: output_dir=exp
 experiment_name=scars_test_seed3
 seed=3
 evaluate=False
 dataset_name=scars
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=[1, 11, 25, 38, 46, 50, 53, 75, 84, 100, 105, 117, 123, 129, 133, 134, 135, 136, 137, 138, 140, 144, 145, 146, 147, 149, 150, 151, 153, 160, 161, 162, 163, 164, 167, 168, 169, 174, 175, 180, 185, 186, 187, 192, 193, 0, 81, 97, 104, 122, 139, 141, 142, 143, 148, 152, 154, 155, 156, 157, 158, 159, 165, 166, 170, 171, 172, 173, 176, 177, 181, 184, 188, 191, 194, 195, 2, 7, 9, 16, 20, 26, 28, 44, 54, 95, 98, 102, 127, 178, 182, 22, 41, 82, 93, 112, 125, 189]
 unlabeled_classes=[23, 42, 83, 94, 113, 126, 190, 3, 8, 10, 17, 21, 27, 29, 45, 55, 96, 99, 103, 128, 179, 183, 4, 5, 6, 12, 13, 14, 15, 18, 19, 24, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 43, 47, 48, 49, 51, 52, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 76, 77, 78, 79, 80, 85, 86, 87, 88, 89, 90, 91, 92, 101, 106, 107, 108, 109, 110, 111, 114, 115, 116, 118, 119, 120, 121, 124, 130, 131, 132]
 num_labeled_classes=98
 num_unlabeled_classes=98
 log_path=exp/scars_test_seed3-2024-12-07-20-38/logs/log.txt
 model_path=exp/scars_test_seed3-2024-12-07-20-38/models/model.pth
 device=cuda
2024-12-07 20:38:02,550 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-07 20:38:05,917 - INFO - Building custom CLIP
2024-12-07 20:38:07,440 - INFO - Turning off gradients in both the image and the text encoder
2024-12-07 20:38:07,444 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 20:38:08,861 - INFO - len of train dataset: 8144
2024-12-07 20:38:08,865 - INFO - len of test dataset: 6144
2024-12-07 20:38:08,870 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 20:38:08,871 - INFO - Selecting 18 high-confidence samples for co-teaching.
2024-12-07 20:38:41,019 - INFO - Before Train Accuracies: All 0.1605 | Old 0.0845 | New 0.1972
2024-12-07 20:38:41,019 - INFO - Before Train Accuracies: All 0.0721 | Old 0.0525 | New 0.0816
2024-12-07 20:39:43,217 - INFO - Epoch 1/200, Total Loss: 11.7095, Base Loss: 9.9401, Con Loss: 1.7694, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:39:43,217 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 20:39:43,217 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:40:07,887 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.3739 | Old 0.3428 | New 0.3888
2024-12-07 20:40:07,887 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.1995 | Old 0.1529 | New 0.2221
2024-12-07 20:40:33,325 - INFO - Weighted Accuracies: All 0.2894 | Old 0.3153 | New 0.2769
2024-12-07 20:40:34,107 - INFO - Saved model!
2024-12-07 20:41:35,680 - INFO - Epoch 2/200, Total Loss: 9.4543, Base Loss: 7.8150, Con Loss: 1.6393, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:41:35,680 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 20:41:35,680 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:42:00,460 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.4816 | Old 0.5362 | New 0.4552
2024-12-07 20:42:00,463 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.2865 | Old 0.3688 | New 0.2467
2024-12-07 20:42:25,067 - INFO - Weighted Accuracies: All 0.4001 | Old 0.4953 | New 0.3541
2024-12-07 20:42:25,976 - INFO - Saved model!
2024-12-07 20:43:27,615 - INFO - Epoch 3/200, Total Loss: 7.1019, Base Loss: 5.4982, Con Loss: 1.6037, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:43:27,616 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 20:43:27,616 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:43:53,153 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.5298 | Old 0.6492 | New 0.4721
2024-12-07 20:43:53,153 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.3558 | Old 0.4978 | New 0.2872
2024-12-07 20:44:18,238 - INFO - Weighted Accuracies: All 0.4613 | Old 0.6007 | New 0.3939
2024-12-07 20:44:19,142 - INFO - Saved model!
2024-12-07 20:45:20,231 - INFO - Epoch 4/200, Total Loss: 6.2078, Base Loss: 4.6434, Con Loss: 1.5644, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:45:20,231 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 20:45:20,231 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:45:45,832 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.5882 | Old 0.6627 | New 0.5523
2024-12-07 20:45:45,833 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.3957 | Old 0.5702 | New 0.3114
2024-12-07 20:46:10,719 - INFO - Weighted Accuracies: All 0.4976 | Old 0.5977 | New 0.4492
2024-12-07 20:46:11,655 - INFO - Saved model!
2024-12-07 20:47:13,185 - INFO - Epoch 5/200, Total Loss: 5.7179, Base Loss: 4.1895, Con Loss: 1.5284, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:47:13,186 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 20:47:13,186 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:47:37,952 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.6063 | Old 0.6887 | New 0.5665
2024-12-07 20:47:37,953 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.4172 | Old 0.6282 | New 0.3152
2024-12-07 20:48:04,085 - INFO - Weighted Accuracies: All 0.5142 | Old 0.5987 | New 0.4733
2024-12-07 20:48:05,048 - INFO - Saved model!
2024-12-07 20:49:06,962 - INFO - Epoch 6/200, Total Loss: 5.4636, Base Loss: 3.9506, Con Loss: 1.5130, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:49:06,962 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 20:49:06,962 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:49:32,058 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.5993 | Old 0.6882 | New 0.5564
2024-12-07 20:49:32,059 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.4360 | Old 0.6632 | New 0.3263
2024-12-07 20:49:57,602 - INFO - Weighted Accuracies: All 0.5295 | Old 0.6042 | New 0.4934
2024-12-07 20:49:58,512 - INFO - Saved model!
2024-12-07 20:51:00,681 - INFO - Epoch 7/200, Total Loss: 5.2059, Base Loss: 3.7268, Con Loss: 1.4791, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:51:00,681 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-07 20:51:00,681 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:51:25,488 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.6239 | Old 0.7296 | New 0.5728
2024-12-07 20:51:25,489 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.4551 | Old 0.6617 | New 0.3553
2024-12-07 20:51:50,105 - INFO - Weighted Accuracies: All 0.5345 | Old 0.6327 | New 0.4871
2024-12-07 20:51:50,977 - INFO - Saved model!
2024-12-07 20:52:51,951 - INFO - Epoch 8/200, Total Loss: 5.0856, Base Loss: 3.6047, Con Loss: 1.4809, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:52:51,951 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-07 20:52:51,951 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:53:17,821 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.6240 | Old 0.7771 | New 0.5501
2024-12-07 20:53:17,822 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.4673 | Old 0.7121 | New 0.3490
2024-12-07 20:53:43,486 - INFO - Weighted Accuracies: All 0.5400 | Old 0.6607 | New 0.4818
2024-12-07 20:53:44,376 - INFO - Saved model!
2024-12-07 20:54:45,931 - INFO - Epoch 9/200, Total Loss: 4.9204, Base Loss: 3.4712, Con Loss: 1.4492, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:54:45,931 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-07 20:54:45,931 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:55:10,763 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.6681 | Old 0.7696 | New 0.6191
2024-12-07 20:55:10,763 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.4761 | Old 0.7086 | New 0.3637
2024-12-07 20:55:36,608 - INFO - Weighted Accuracies: All 0.5355 | Old 0.6712 | New 0.4699
2024-12-07 20:56:37,204 - INFO - Epoch 10/200, Total Loss: 4.8176, Base Loss: 3.3833, Con Loss: 1.4343, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:56:37,204 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-07 20:56:37,205 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:57:01,968 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.6756 | Old 0.8151 | New 0.6083
2024-12-07 20:57:01,970 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.4792 | Old 0.7211 | New 0.3623
2024-12-07 20:57:26,544 - INFO - Weighted Accuracies: All 0.5369 | Old 0.6172 | New 0.4982
2024-12-07 20:58:27,346 - INFO - Epoch 11/200, Total Loss: 4.6968, Base Loss: 3.2737, Con Loss: 1.4231, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:58:27,348 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-07 20:58:27,348 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:58:52,176 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.7015 | Old 0.8011 | New 0.6534
2024-12-07 20:58:52,176 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.4868 | Old 0.7186 | New 0.3748
2024-12-07 20:59:17,139 - INFO - Weighted Accuracies: All 0.5254 | Old 0.6282 | New 0.4757
2024-12-07 20:59:42,361 - INFO - len of text selected samples: 3287
2024-12-07 21:00:45,576 - INFO - Epoch 12/200, Total Loss: 7.6686, Base Loss: 3.2462, Con Loss: 1.4318, Pseudo Loss Image: 2.9906, Pseudo Loss Text: 0.0000
2024-12-07 21:00:45,576 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-07 21:00:45,576 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:01:12,968 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.6960 | Old 0.8571 | New 0.6182
2024-12-07 21:01:12,968 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.5360 | Old 0.7676 | New 0.4241
2024-12-07 21:01:38,656 - INFO - Weighted Accuracies: All 0.6556 | Old 0.8191 | New 0.5766
2024-12-07 21:01:39,581 - INFO - Saved model!
2024-12-07 21:02:04,242 - INFO - len of text selected samples: 3321
2024-12-07 21:03:05,758 - INFO - Epoch 13/200, Total Loss: 6.4331, Base Loss: 3.0969, Con Loss: 1.4390, Pseudo Loss Image: 1.8972, Pseudo Loss Text: 0.0000
2024-12-07 21:03:05,758 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-12-07 21:03:05,759 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:03:30,930 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.6973 | Old 0.8376 | New 0.6295
2024-12-07 21:03:30,930 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.6276 | Old 0.8146 | New 0.5373
2024-12-07 21:03:56,468 - INFO - Weighted Accuracies: All 0.7222 | Old 0.8641 | New 0.6536
2024-12-07 21:03:57,401 - INFO - Saved model!
2024-12-07 21:04:22,543 - INFO - len of text selected samples: 3330
2024-12-07 21:05:24,148 - INFO - Epoch 14/200, Total Loss: 5.8754, Base Loss: 3.0005, Con Loss: 1.4437, Pseudo Loss Image: 1.4312, Pseudo Loss Text: 0.0000
2024-12-07 21:05:24,148 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-12-07 21:05:24,148 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:05:49,830 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.6942 | Old 0.8366 | New 0.6254
2024-12-07 21:05:49,830 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.6559 | Old 0.8326 | New 0.5706
2024-12-07 21:06:14,915 - INFO - Weighted Accuracies: All 0.7285 | Old 0.8631 | New 0.6635
2024-12-07 21:06:15,826 - INFO - Saved model!
2024-12-07 21:06:41,536 - INFO - len of text selected samples: 3358
2024-12-07 21:07:44,408 - INFO - Epoch 15/200, Total Loss: 5.5519, Base Loss: 2.9472, Con Loss: 1.4295, Pseudo Loss Image: 1.1752, Pseudo Loss Text: 0.0000
2024-12-07 21:07:44,408 - INFO -    Param Group: classifier_head, Learning Rate: 0.0986
2024-12-07 21:07:44,408 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:08:11,582 - INFO - Text classifier Epoch 14 Train Accuracies: All 0.6997 | Old 0.8441 | New 0.6300
2024-12-07 21:08:11,582 - INFO - Image classifier Epoch 14 Train Accuracies: All 0.6720 | Old 0.8426 | New 0.5897
2024-12-07 21:08:36,953 - INFO - Weighted Accuracies: All 0.7303 | Old 0.8721 | New 0.6618
2024-12-07 21:08:37,821 - INFO - Saved model!
