2024-12-07 20:32:03,084 - INFO - Training pets_test_seed1 with the following settings:
2024-12-07 20:32:03,085 - INFO - Command-line arguments: output_dir=exp
 experiment_name=pets_test_seed1
 seed=1
 evaluate=False
 dataset_name=pets
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 19)
 unlabeled_classes=range(19, 37)
 num_labeled_classes=19
 num_unlabeled_classes=18
 log_path=exp/pets_test_seed1-2024-12-07-20-32/logs/log.txt
 model_path=exp/pets_test_seed1-2024-12-07-20-32/models/model.pth
 device=cuda
2024-12-07 20:32:03,089 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-07 20:32:05,200 - INFO - Building custom CLIP
2024-12-07 20:32:06,434 - INFO - Turning off gradients in both the image and the text encoder
2024-12-07 20:32:06,436 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 20:32:07,505 - INFO - len of train dataset: 3680
2024-12-07 20:32:07,505 - INFO - len of test dataset: 2738
2024-12-07 20:32:07,508 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 20:32:07,509 - INFO - Selecting 44 high-confidence samples for co-teaching.
2024-12-07 20:32:20,678 - INFO - Before Train Accuracies: All 0.1735 | Old 0.0339 | New 0.2468
2024-12-07 20:32:20,678 - INFO - Before Train Accuracies: All 0.1417 | Old 0.0467 | New 0.1916
2024-12-07 20:32:47,877 - INFO - Epoch 1/200, Total Loss: 10.4675, Base Loss: 8.3269, Con Loss: 2.1406, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:32:47,877 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 20:32:47,878 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:32:58,552 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.6147 | Old 0.6628 | New 0.5894
2024-12-07 20:32:58,552 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.0365 | Old 0.0000 | New 0.0557
2024-12-07 20:33:09,219 - INFO - Weighted Accuracies: All 0.0435 | Old 0.0000 | New 0.0663
2024-12-07 20:33:09,846 - INFO - Saved model!
2024-12-07 20:33:35,910 - INFO - Epoch 2/200, Total Loss: 6.6849, Base Loss: 4.6373, Con Loss: 2.0476, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:33:35,910 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 20:33:35,910 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:33:46,704 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.7261 | Old 0.7762 | New 0.6997
2024-12-07 20:33:46,704 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.4529 | Old 0.4655 | New 0.4462
2024-12-07 20:33:57,518 - INFO - Weighted Accuracies: All 0.6004 | Old 0.5917 | New 0.6050
2024-12-07 20:33:58,266 - INFO - Saved model!
2024-12-07 20:34:24,512 - INFO - Epoch 3/200, Total Loss: 4.8132, Base Loss: 2.8354, Con Loss: 1.9778, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:34:24,512 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 20:34:24,512 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:34:35,242 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.7893 | Old 0.8579 | New 0.7532
2024-12-07 20:34:35,242 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.5124 | Old 0.5514 | New 0.4919
2024-12-07 20:34:45,813 - INFO - Weighted Accuracies: All 0.6260 | Old 0.7359 | New 0.5682
2024-12-07 20:34:46,568 - INFO - Saved model!
2024-12-07 20:35:12,697 - INFO - Epoch 4/200, Total Loss: 4.1838, Base Loss: 2.2752, Con Loss: 1.9087, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:35:12,697 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 20:35:12,698 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:35:23,361 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.8167 | Old 0.8855 | New 0.7805
2024-12-07 20:35:23,361 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.5880 | Old 0.6893 | New 0.5348
2024-12-07 20:35:34,013 - INFO - Weighted Accuracies: All 0.6534 | Old 0.7572 | New 0.5989
2024-12-07 20:35:34,734 - INFO - Saved model!
2024-12-07 20:36:00,960 - INFO - Epoch 5/200, Total Loss: 3.8000, Base Loss: 1.9269, Con Loss: 1.8731, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:36:00,961 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 20:36:00,961 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:36:11,736 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.8455 | Old 0.8537 | New 0.8412
2024-12-07 20:36:11,736 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.6424 | Old 0.7455 | New 0.5883
2024-12-07 20:36:22,615 - INFO - Weighted Accuracies: All 0.6479 | Old 0.8028 | New 0.5666
2024-12-07 20:36:48,376 - INFO - Epoch 6/200, Total Loss: 3.5546, Base Loss: 1.7191, Con Loss: 1.8355, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:36:48,376 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 20:36:48,376 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:36:59,126 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.8473 | Old 0.9099 | New 0.8145
2024-12-07 20:36:59,127 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.6585 | Old 0.8006 | New 0.5838
2024-12-07 20:37:09,829 - INFO - Weighted Accuracies: All 0.6406 | Old 0.7953 | New 0.5593
2024-12-07 20:37:36,365 - INFO - Epoch 7/200, Total Loss: 3.4415, Base Loss: 1.6035, Con Loss: 1.8380, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:37:36,365 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-07 20:37:36,365 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:37:47,121 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.8430 | Old 0.8526 | New 0.8379
2024-12-07 20:37:47,122 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.6892 | Old 0.8388 | New 0.6106
2024-12-07 20:37:57,745 - INFO - Weighted Accuracies: All 0.6600 | Old 0.8006 | New 0.5861
2024-12-07 20:37:58,434 - INFO - Saved model!
2024-12-07 20:38:24,600 - INFO - Epoch 8/200, Total Loss: 3.2624, Base Loss: 1.4667, Con Loss: 1.7957, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:38:24,600 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-07 20:38:24,600 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:38:35,271 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.8543 | Old 0.8908 | New 0.8351
2024-12-07 20:38:35,271 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.6855 | Old 0.8399 | New 0.6045
2024-12-07 20:38:46,078 - INFO - Weighted Accuracies: All 0.6837 | Old 0.7996 | New 0.6228
2024-12-07 20:38:46,829 - INFO - Saved model!
2024-12-07 20:39:12,828 - INFO - Epoch 9/200, Total Loss: 3.2589, Base Loss: 1.4579, Con Loss: 1.8010, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:39:12,829 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-07 20:39:12,829 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:39:23,511 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.8462 | Old 0.8876 | New 0.8245
2024-12-07 20:39:23,511 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.6943 | Old 0.8993 | New 0.5866
2024-12-07 20:39:34,185 - INFO - Weighted Accuracies: All 0.6731 | Old 0.8431 | New 0.5838
2024-12-07 20:40:00,160 - INFO - Epoch 10/200, Total Loss: 3.1420, Base Loss: 1.3851, Con Loss: 1.7568, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:40:00,160 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-07 20:40:00,160 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:40:10,826 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.8473 | Old 0.8727 | New 0.8340
2024-12-07 20:40:10,827 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.7169 | Old 0.8462 | New 0.6490
2024-12-07 20:40:21,519 - INFO - Weighted Accuracies: All 0.6468 | Old 0.8441 | New 0.5432
2024-12-07 20:40:47,435 - INFO - Epoch 11/200, Total Loss: 3.1007, Base Loss: 1.3283, Con Loss: 1.7724, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:40:47,435 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-07 20:40:47,435 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:40:58,097 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.8554 | Old 0.8961 | New 0.8340
2024-12-07 20:40:58,097 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.7297 | Old 0.9088 | New 0.6357
2024-12-07 20:41:08,869 - INFO - Weighted Accuracies: All 0.6698 | Old 0.8006 | New 0.6011
2024-12-07 20:41:19,632 - INFO - len of text selected samples: 1595
2024-12-07 20:41:45,847 - INFO - Epoch 12/200, Total Loss: 4.8622, Base Loss: 1.3163, Con Loss: 1.7375, Pseudo Loss Image: 1.8084, Pseudo Loss Text: 0.0000
2024-12-07 20:41:45,847 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-07 20:41:45,847 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:41:56,587 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.8550 | Old 0.8887 | New 0.8373
2024-12-07 20:41:56,587 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.7403 | Old 0.9109 | New 0.6507
2024-12-07 20:42:07,374 - INFO - Weighted Accuracies: All 0.8378 | Old 0.9321 | New 0.7883
2024-12-07 20:42:08,096 - INFO - Saved model!
2024-12-07 20:42:18,704 - INFO - len of text selected samples: 1595
2024-12-07 20:42:44,628 - INFO - Epoch 13/200, Total Loss: 3.8928, Base Loss: 1.2423, Con Loss: 1.7348, Pseudo Loss Image: 0.9157, Pseudo Loss Text: 0.0000
2024-12-07 20:42:44,628 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-12-07 20:42:44,628 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:42:55,206 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.8535 | Old 0.8940 | New 0.8323
2024-12-07 20:42:55,206 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.8115 | Old 0.9109 | New 0.7593
2024-12-07 20:43:05,994 - INFO - Weighted Accuracies: All 0.8627 | Old 0.9236 | New 0.8306
2024-12-07 20:43:06,724 - INFO - Saved model!
2024-12-07 20:43:17,530 - INFO - len of text selected samples: 1597
2024-12-07 20:43:43,819 - INFO - Epoch 14/200, Total Loss: 3.4162, Base Loss: 1.0854, Con Loss: 1.7354, Pseudo Loss Image: 0.5955, Pseudo Loss Text: 0.0000
2024-12-07 20:43:43,820 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-12-07 20:43:43,820 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:43:54,524 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.8521 | Old 0.8802 | New 0.8373
2024-12-07 20:43:54,524 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.8459 | Old 0.8993 | New 0.8178
2024-12-07 20:44:05,206 - INFO - Weighted Accuracies: All 0.8703 | Old 0.9067 | New 0.8513
2024-12-07 20:44:05,916 - INFO - Saved model!
2024-12-07 20:44:16,563 - INFO - len of text selected samples: 1601
2024-12-07 20:44:43,234 - INFO - Epoch 15/200, Total Loss: 3.2630, Base Loss: 1.0605, Con Loss: 1.7373, Pseudo Loss Image: 0.4653, Pseudo Loss Text: 0.0000
2024-12-07 20:44:43,235 - INFO -    Param Group: classifier_head, Learning Rate: 0.0986
2024-12-07 20:44:43,235 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:44:54,107 - INFO - Text classifier Epoch 14 Train Accuracies: All 0.8488 | Old 0.8855 | New 0.8295
2024-12-07 20:44:54,108 - INFO - Image classifier Epoch 14 Train Accuracies: All 0.8627 | Old 0.8590 | New 0.8646
2024-12-07 20:45:04,872 - INFO - Weighted Accuracies: All 0.8725 | Old 0.9215 | New 0.8468
2024-12-07 20:45:05,607 - INFO - Saved model!
2024-12-07 20:45:16,283 - INFO - len of text selected samples: 1595
2024-12-07 20:45:42,459 - INFO - Epoch 16/200, Total Loss: 3.1105, Base Loss: 1.0065, Con Loss: 1.7078, Pseudo Loss Image: 0.3962, Pseudo Loss Text: 0.0000
2024-12-07 20:45:42,459 - INFO -    Param Group: classifier_head, Learning Rate: 0.0984
2024-12-07 20:45:42,459 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:45:53,155 - INFO - Text classifier Epoch 15 Train Accuracies: All 0.8488 | Old 0.8759 | New 0.8345
2024-12-07 20:45:53,155 - INFO - Image classifier Epoch 15 Train Accuracies: All 0.8656 | Old 0.9056 | New 0.8446
2024-12-07 20:46:03,863 - INFO - Weighted Accuracies: All 0.8733 | Old 0.9109 | New 0.8535
2024-12-07 20:46:04,566 - INFO - Saved model!
2024-12-07 20:46:26,001 - INFO - len of image selected samples: 1606
2024-12-07 20:46:26,003 - INFO - len of text selected samples: 1599
2024-12-07 20:46:52,125 - INFO - Epoch 17/200, Total Loss: 3.5269, Base Loss: 1.0409, Con Loss: 1.7065, Pseudo Loss Image: 0.3396, Pseudo Loss Text: 0.4399
2024-12-07 20:46:52,126 - INFO -    Param Group: classifier_head, Learning Rate: 0.0982
2024-12-07 20:46:52,126 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:47:02,849 - INFO - Text classifier Epoch 16 Train Accuracies: All 0.8473 | Old 0.8727 | New 0.8340
2024-12-07 20:47:02,849 - INFO - Image classifier Epoch 16 Train Accuracies: All 0.8692 | Old 0.9024 | New 0.8518
2024-12-07 20:47:13,638 - INFO - Weighted Accuracies: All 0.8700 | Old 0.9088 | New 0.8496
2024-12-07 20:47:34,945 - INFO - len of image selected samples: 1609
2024-12-07 20:47:34,948 - INFO - len of text selected samples: 1599
2024-12-07 20:48:01,071 - INFO - Epoch 18/200, Total Loss: 3.2236, Base Loss: 0.9645, Con Loss: 1.6866, Pseudo Loss Image: 0.2759, Pseudo Loss Text: 0.2966
2024-12-07 20:48:01,071 - INFO -    Param Group: classifier_head, Learning Rate: 0.0980
2024-12-07 20:48:01,071 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:48:11,822 - INFO - Text classifier Epoch 17 Train Accuracies: All 0.8828 | Old 0.8887 | New 0.8797
2024-12-07 20:48:11,822 - INFO - Image classifier Epoch 17 Train Accuracies: All 0.8711 | Old 0.9130 | New 0.8490
2024-12-07 20:48:22,525 - INFO - Weighted Accuracies: All 0.8802 | Old 0.9152 | New 0.8618
2024-12-07 20:48:23,261 - INFO - Saved model!
2024-12-07 20:48:44,580 - INFO - len of image selected samples: 1609
2024-12-07 20:48:44,583 - INFO - len of text selected samples: 1606
2024-12-07 20:49:10,823 - INFO - Epoch 19/200, Total Loss: 3.1928, Base Loss: 0.9695, Con Loss: 1.7085, Pseudo Loss Image: 0.2567, Pseudo Loss Text: 0.2581
2024-12-07 20:49:10,823 - INFO -    Param Group: classifier_head, Learning Rate: 0.0978
2024-12-07 20:49:10,823 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:49:21,444 - INFO - Text classifier Epoch 18 Train Accuracies: All 0.8820 | Old 0.8961 | New 0.8747
2024-12-07 20:49:21,445 - INFO - Image classifier Epoch 18 Train Accuracies: All 0.8839 | Old 0.9130 | New 0.8685
2024-12-07 20:49:32,069 - INFO - Weighted Accuracies: All 0.8915 | Old 0.9152 | New 0.8791
2024-12-07 20:49:32,802 - INFO - Saved model!
2024-12-07 20:49:54,118 - INFO - len of image selected samples: 1608
2024-12-07 20:49:54,120 - INFO - len of text selected samples: 1604
2024-12-07 20:50:20,146 - INFO - Epoch 20/200, Total Loss: 3.0701, Base Loss: 0.9176, Con Loss: 1.6738, Pseudo Loss Image: 0.2424, Pseudo Loss Text: 0.2363
2024-12-07 20:50:20,146 - INFO -    Param Group: classifier_head, Learning Rate: 0.0976
2024-12-07 20:50:20,146 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:50:30,808 - INFO - Text classifier Epoch 19 Train Accuracies: All 0.8850 | Old 0.8929 | New 0.8808
2024-12-07 20:50:30,808 - INFO - Image classifier Epoch 19 Train Accuracies: All 0.9014 | Old 0.9173 | New 0.8930
2024-12-07 20:50:41,515 - INFO - Weighted Accuracies: All 0.8999 | Old 0.9141 | New 0.8925
2024-12-07 20:50:42,258 - INFO - Saved model!
2024-12-07 20:51:03,686 - INFO - len of image selected samples: 1605
2024-12-07 20:51:03,691 - INFO - len of text selected samples: 1605
2024-12-07 20:51:30,075 - INFO - Epoch 21/200, Total Loss: 3.0581, Base Loss: 0.9489, Con Loss: 1.6880, Pseudo Loss Image: 0.2314, Pseudo Loss Text: 0.1898
2024-12-07 20:51:30,075 - INFO -    Param Group: classifier_head, Learning Rate: 0.0973
2024-12-07 20:51:30,075 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:51:40,978 - INFO - Text classifier Epoch 20 Train Accuracies: All 0.8893 | Old 0.8961 | New 0.8858
2024-12-07 20:51:40,979 - INFO - Image classifier Epoch 20 Train Accuracies: All 0.9007 | Old 0.9099 | New 0.8958
2024-12-07 20:51:51,567 - INFO - Weighted Accuracies: All 0.9032 | Old 0.9130 | New 0.8981
2024-12-07 20:51:52,300 - INFO - Saved model!
2024-12-07 20:52:13,900 - INFO - len of image selected samples: 1609
2024-12-07 20:52:13,901 - INFO - len of text selected samples: 1612
2024-12-07 20:52:39,831 - INFO - Epoch 22/200, Total Loss: 3.0300, Base Loss: 0.9461, Con Loss: 1.6675, Pseudo Loss Image: 0.2183, Pseudo Loss Text: 0.1981
2024-12-07 20:52:39,831 - INFO -    Param Group: classifier_head, Learning Rate: 0.0970
2024-12-07 20:52:39,831 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:52:50,617 - INFO - Text classifier Epoch 21 Train Accuracies: All 0.8868 | Old 0.8897 | New 0.8852
2024-12-07 20:52:50,617 - INFO - Image classifier Epoch 21 Train Accuracies: All 0.8999 | Old 0.9024 | New 0.8986
2024-12-07 20:53:01,266 - INFO - Weighted Accuracies: All 0.9028 | Old 0.9141 | New 0.8969
2024-12-07 20:53:22,718 - INFO - len of image selected samples: 1616
2024-12-07 20:53:22,720 - INFO - len of text selected samples: 1609
2024-12-07 20:53:48,681 - INFO - Epoch 23/200, Total Loss: 2.9310, Base Loss: 0.9115, Con Loss: 1.6311, Pseudo Loss Image: 0.2088, Pseudo Loss Text: 0.1797
2024-12-07 20:53:48,682 - INFO -    Param Group: classifier_head, Learning Rate: 0.0968
2024-12-07 20:53:48,682 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:53:59,464 - INFO - Text classifier Epoch 22 Train Accuracies: All 0.8846 | Old 0.8865 | New 0.8836
2024-12-07 20:53:59,464 - INFO - Image classifier Epoch 22 Train Accuracies: All 0.9025 | Old 0.9152 | New 0.8958
2024-12-07 20:54:10,202 - INFO - Weighted Accuracies: All 0.9028 | Old 0.9194 | New 0.8942
2024-12-07 20:54:31,519 - INFO - len of image selected samples: 1608
2024-12-07 20:54:31,521 - INFO - len of text selected samples: 1615
2024-12-07 20:54:57,618 - INFO - Epoch 24/200, Total Loss: 2.8652, Base Loss: 0.8916, Con Loss: 1.6359, Pseudo Loss Image: 0.1866, Pseudo Loss Text: 0.1510
2024-12-07 20:54:57,618 - INFO -    Param Group: classifier_head, Learning Rate: 0.0965
2024-12-07 20:54:57,619 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:55:08,412 - INFO - Text classifier Epoch 23 Train Accuracies: All 0.8904 | Old 0.8940 | New 0.8886
2024-12-07 20:55:08,412 - INFO - Image classifier Epoch 23 Train Accuracies: All 0.8977 | Old 0.9120 | New 0.8903
2024-12-07 20:55:19,170 - INFO - Weighted Accuracies: All 0.9025 | Old 0.9162 | New 0.8953
2024-12-07 20:55:40,626 - INFO - len of image selected samples: 1620
2024-12-07 20:55:40,628 - INFO - len of text selected samples: 1606
2024-12-07 20:56:06,801 - INFO - Epoch 25/200, Total Loss: 2.9194, Base Loss: 0.9112, Con Loss: 1.6452, Pseudo Loss Image: 0.1997, Pseudo Loss Text: 0.1632
2024-12-07 20:56:06,801 - INFO -    Param Group: classifier_head, Learning Rate: 0.0962
2024-12-07 20:56:06,801 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:56:17,541 - INFO - Text classifier Epoch 24 Train Accuracies: All 0.8948 | Old 0.9003 | New 0.8919
2024-12-07 20:56:17,541 - INFO - Image classifier Epoch 24 Train Accuracies: All 0.8996 | Old 0.9099 | New 0.8942
2024-12-07 20:56:28,112 - INFO - Weighted Accuracies: All 0.9043 | Old 0.9183 | New 0.8969
2024-12-07 20:56:28,889 - INFO - Saved model!
2024-12-07 20:56:50,301 - INFO - len of image selected samples: 1614
2024-12-07 20:56:50,302 - INFO - len of text selected samples: 1606
2024-12-07 20:57:16,623 - INFO - Epoch 26/200, Total Loss: 2.7919, Base Loss: 0.8695, Con Loss: 1.6285, Pseudo Loss Image: 0.1637, Pseudo Loss Text: 0.1302
2024-12-07 20:57:16,623 - INFO -    Param Group: classifier_head, Learning Rate: 0.0959
2024-12-07 20:57:16,623 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:57:27,431 - INFO - Text classifier Epoch 25 Train Accuracies: All 0.8955 | Old 0.9088 | New 0.8886
2024-12-07 20:57:27,432 - INFO - Image classifier Epoch 25 Train Accuracies: All 0.9032 | Old 0.9205 | New 0.8942
2024-12-07 20:57:38,181 - INFO - Weighted Accuracies: All 0.9058 | Old 0.9279 | New 0.8942
2024-12-07 20:57:38,933 - INFO - Saved model!
2024-12-07 20:58:00,108 - INFO - len of image selected samples: 1614
2024-12-07 20:58:00,109 - INFO - len of text selected samples: 1609
2024-12-07 20:58:26,528 - INFO - Epoch 27/200, Total Loss: 2.8075, Base Loss: 0.8964, Con Loss: 1.6087, Pseudo Loss Image: 0.1631, Pseudo Loss Text: 0.1392
2024-12-07 20:58:26,529 - INFO -    Param Group: classifier_head, Learning Rate: 0.0956
2024-12-07 20:58:26,529 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:58:37,283 - INFO - Text classifier Epoch 26 Train Accuracies: All 0.8904 | Old 0.8982 | New 0.8864
2024-12-07 20:58:37,283 - INFO - Image classifier Epoch 26 Train Accuracies: All 0.9065 | Old 0.9258 | New 0.8964
2024-12-07 20:58:47,993 - INFO - Weighted Accuracies: All 0.9054 | Old 0.9205 | New 0.8975
2024-12-07 20:59:09,485 - INFO - len of image selected samples: 1614
2024-12-07 20:59:09,487 - INFO - len of text selected samples: 1617
2024-12-07 20:59:35,845 - INFO - Epoch 28/200, Total Loss: 2.8362, Base Loss: 0.9099, Con Loss: 1.5931, Pseudo Loss Image: 0.1804, Pseudo Loss Text: 0.1528
2024-12-07 20:59:35,845 - INFO -    Param Group: classifier_head, Learning Rate: 0.0952
2024-12-07 20:59:35,845 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:59:46,605 - INFO - Text classifier Epoch 27 Train Accuracies: All 0.8908 | Old 0.9046 | New 0.8836
2024-12-07 20:59:46,606 - INFO - Image classifier Epoch 27 Train Accuracies: All 0.9025 | Old 0.9141 | New 0.8964
2024-12-07 20:59:57,149 - INFO - Weighted Accuracies: All 0.9047 | Old 0.9226 | New 0.8953
2024-12-07 21:00:19,340 - INFO - len of image selected samples: 1620
2024-12-07 21:00:19,383 - INFO - len of text selected samples: 1612
2024-12-07 21:00:46,846 - INFO - Epoch 29/200, Total Loss: 2.8221, Base Loss: 0.9135, Con Loss: 1.6136, Pseudo Loss Image: 0.1486, Pseudo Loss Text: 0.1464
2024-12-07 21:00:46,846 - INFO -    Param Group: classifier_head, Learning Rate: 0.0949
2024-12-07 21:00:46,846 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:00:58,823 - INFO - Text classifier Epoch 28 Train Accuracies: All 0.8904 | Old 0.8993 | New 0.8858
2024-12-07 21:00:58,823 - INFO - Image classifier Epoch 28 Train Accuracies: All 0.9054 | Old 0.9194 | New 0.8981
2024-12-07 21:01:10,262 - INFO - Weighted Accuracies: All 0.9039 | Old 0.9194 | New 0.8958
2024-12-07 21:01:32,317 - INFO - len of image selected samples: 1615
2024-12-07 21:01:32,328 - INFO - len of text selected samples: 1610
2024-12-07 21:01:58,813 - INFO - Epoch 30/200, Total Loss: 2.7753, Base Loss: 0.9005, Con Loss: 1.5873, Pseudo Loss Image: 0.1580, Pseudo Loss Text: 0.1294
2024-12-07 21:01:58,814 - INFO -    Param Group: classifier_head, Learning Rate: 0.0946
2024-12-07 21:01:58,814 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:02:09,604 - INFO - Text classifier Epoch 29 Train Accuracies: All 0.8955 | Old 0.9077 | New 0.8891
2024-12-07 21:02:09,605 - INFO - Image classifier Epoch 29 Train Accuracies: All 0.9028 | Old 0.9035 | New 0.9025
2024-12-07 21:02:20,400 - INFO - Weighted Accuracies: All 0.9047 | Old 0.9173 | New 0.8981
2024-12-07 21:02:41,838 - INFO - len of image selected samples: 1616
2024-12-07 21:02:41,839 - INFO - len of text selected samples: 1610
2024-12-07 21:03:08,293 - INFO - Epoch 31/200, Total Loss: 2.6903, Base Loss: 0.8592, Con Loss: 1.5546, Pseudo Loss Image: 0.1483, Pseudo Loss Text: 0.1282
2024-12-07 21:03:08,293 - INFO -    Param Group: classifier_head, Learning Rate: 0.0942
2024-12-07 21:03:08,293 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:03:19,027 - INFO - Text classifier Epoch 30 Train Accuracies: All 0.8977 | Old 0.9056 | New 0.8936
2024-12-07 21:03:19,027 - INFO - Image classifier Epoch 30 Train Accuracies: All 0.9028 | Old 0.9162 | New 0.8958
2024-12-07 21:03:29,750 - INFO - Weighted Accuracies: All 0.9039 | Old 0.9173 | New 0.8969
2024-12-07 21:03:51,102 - INFO - len of image selected samples: 1619
2024-12-07 21:03:51,105 - INFO - len of text selected samples: 1614
2024-12-07 21:04:17,411 - INFO - Epoch 32/200, Total Loss: 2.7278, Base Loss: 0.8931, Con Loss: 1.5756, Pseudo Loss Image: 0.1412, Pseudo Loss Text: 0.1179
2024-12-07 21:04:17,411 - INFO -    Param Group: classifier_head, Learning Rate: 0.0938
2024-12-07 21:04:17,411 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:04:28,154 - INFO - Text classifier Epoch 31 Train Accuracies: All 0.8985 | Old 0.9056 | New 0.8947
2024-12-07 21:04:28,156 - INFO - Image classifier Epoch 31 Train Accuracies: All 0.9047 | Old 0.9130 | New 0.9003
2024-12-07 21:04:38,859 - INFO - Weighted Accuracies: All 0.9054 | Old 0.9183 | New 0.8986
2024-12-07 21:05:00,151 - INFO - len of image selected samples: 1617
2024-12-07 21:05:00,153 - INFO - len of text selected samples: 1612
2024-12-07 21:05:26,290 - INFO - Epoch 33/200, Total Loss: 2.7006, Base Loss: 0.8560, Con Loss: 1.5687, Pseudo Loss Image: 0.1575, Pseudo Loss Text: 0.1183
2024-12-07 21:05:26,290 - INFO -    Param Group: classifier_head, Learning Rate: 0.0934
2024-12-07 21:05:26,290 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:05:37,034 - INFO - Text classifier Epoch 32 Train Accuracies: All 0.8974 | Old 0.9130 | New 0.8891
2024-12-07 21:05:37,034 - INFO - Image classifier Epoch 32 Train Accuracies: All 0.9007 | Old 0.9130 | New 0.8942
2024-12-07 21:05:47,852 - INFO - Weighted Accuracies: All 0.9036 | Old 0.9194 | New 0.8953
2024-12-07 21:06:09,283 - INFO - len of image selected samples: 1621
2024-12-07 21:06:09,285 - INFO - len of text selected samples: 1611
2024-12-07 21:06:35,350 - INFO - Epoch 34/200, Total Loss: 2.6480, Base Loss: 0.8547, Con Loss: 1.5399, Pseudo Loss Image: 0.1428, Pseudo Loss Text: 0.1107
2024-12-07 21:06:35,350 - INFO -    Param Group: classifier_head, Learning Rate: 0.0930
2024-12-07 21:06:35,350 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:06:46,116 - INFO - Text classifier Epoch 33 Train Accuracies: All 0.9003 | Old 0.9088 | New 0.8958
2024-12-07 21:06:46,116 - INFO - Image classifier Epoch 33 Train Accuracies: All 0.9025 | Old 0.9067 | New 0.9003
2024-12-07 21:06:56,749 - INFO - Weighted Accuracies: All 0.9083 | Old 0.9194 | New 0.9025
2024-12-07 21:06:57,450 - INFO - Saved model!
2024-12-07 21:07:18,874 - INFO - len of image selected samples: 1616
2024-12-07 21:07:18,920 - INFO - len of text selected samples: 1612
2024-12-07 21:07:46,502 - INFO - Epoch 35/200, Total Loss: 2.6652, Base Loss: 0.8474, Con Loss: 1.5425, Pseudo Loss Image: 0.1412, Pseudo Loss Text: 0.1341
2024-12-07 21:07:46,584 - INFO -    Param Group: classifier_head, Learning Rate: 0.0926
2024-12-07 21:07:46,615 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:07:58,035 - INFO - Text classifier Epoch 34 Train Accuracies: All 0.8985 | Old 0.9077 | New 0.8936
2024-12-07 21:07:58,036 - INFO - Image classifier Epoch 34 Train Accuracies: All 0.9039 | Old 0.9088 | New 0.9014
2024-12-07 21:08:09,116 - INFO - Weighted Accuracies: All 0.9043 | Old 0.9130 | New 0.8997
2024-12-07 21:08:30,545 - INFO - len of image selected samples: 1616
2024-12-07 21:08:30,547 - INFO - len of text selected samples: 1614
