2024-12-07 18:47:21,646 - INFO - Training cifar10_test_seed0 with the following settings:
2024-12-07 18:47:21,646 - INFO - Command-line arguments: output_dir=exp
 experiment_name=cifar10_test_seed0
 seed=0
 evaluate=False
 dataset_name=cifar10
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.1
 tau_t_start=0.07
 tau_t_end=0.04
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 5)
 unlabeled_classes=range(5, 10)
 num_labeled_classes=5
 num_unlabeled_classes=5
 log_path=exp/cifar10_test_seed0-2024-12-07-18-47/logs/log.txt
 model_path=exp/cifar10_test_seed0-2024-12-07-18-47/models/model.pth
 device=cuda
2024-12-07 18:47:21,656 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-07 18:47:24,035 - INFO - Building custom CLIP
2024-12-07 18:47:25,122 - INFO - Turning off gradients in both the image and the text encoder
2024-12-07 18:47:25,123 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 18:47:29,969 - INFO - len of train dataset: 50000
2024-12-07 18:47:29,969 - INFO - len of test dataset: 37500
2024-12-07 18:47:29,978 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 18:47:29,979 - INFO - Selecting 2250 high-confidence samples for co-teaching.
2024-12-07 18:49:10,081 - INFO - Before Train Accuracies: All 0.2562 | Old 0.0350 | New 0.3668
2024-12-07 18:49:10,081 - INFO - Before Train Accuracies: All 0.2521 | Old 0.0063 | New 0.3750
2024-12-07 18:54:20,625 - INFO - Epoch 1/200, Total Loss: 3.4845, Base Loss: 1.4256, Con Loss: 2.0589, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 18:54:20,625 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 18:54:20,625 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 18:55:57,393 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.9683 | Old 0.9410 | New 0.9820
2024-12-07 18:55:57,394 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.9441 | Old 0.9061 | New 0.9630
2024-12-07 18:57:34,583 - INFO - Weighted Accuracies: All 0.8394 | Old 0.9661 | New 0.7761
2024-12-07 18:57:35,170 - INFO - Saved model!
2024-12-07 19:02:44,472 - INFO - Epoch 2/200, Total Loss: 2.5111, Base Loss: 0.6223, Con Loss: 1.8888, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 19:02:44,472 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 19:02:44,472 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:04:21,733 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.9707 | Old 0.9474 | New 0.9824
2024-12-07 19:04:21,733 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.9546 | Old 0.9330 | New 0.9654
2024-12-07 19:05:58,703 - INFO - Weighted Accuracies: All 0.8167 | Old 0.9749 | New 0.7377
2024-12-07 19:11:08,045 - INFO - Epoch 3/200, Total Loss: 2.3785, Base Loss: 0.5792, Con Loss: 1.7993, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 19:11:08,045 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 19:11:08,045 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:12:45,353 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.9704 | Old 0.9427 | New 0.9843
2024-12-07 19:12:45,353 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.9539 | Old 0.9259 | New 0.9680
2024-12-07 19:14:22,236 - INFO - Weighted Accuracies: All 0.8341 | Old 0.9712 | New 0.7655
2024-12-07 19:19:31,163 - INFO - Epoch 4/200, Total Loss: 2.2735, Base Loss: 0.5366, Con Loss: 1.7369, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 19:19:31,164 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 19:19:31,164 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:21:08,105 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.9662 | Old 0.9294 | New 0.9845
2024-12-07 19:21:08,105 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.9503 | Old 0.9161 | New 0.9674
2024-12-07 19:22:45,318 - INFO - Weighted Accuracies: All 0.8306 | Old 0.9650 | New 0.7634
2024-12-07 19:27:55,105 - INFO - Epoch 5/200, Total Loss: 2.2251, Base Loss: 0.5226, Con Loss: 1.7024, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 19:27:55,105 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 19:27:55,105 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:29:32,003 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.9698 | Old 0.9446 | New 0.9823
2024-12-07 19:29:32,003 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.9554 | Old 0.9275 | New 0.9694
2024-12-07 19:31:09,446 - INFO - Weighted Accuracies: All 0.8347 | Old 0.9714 | New 0.7664
2024-12-07 19:36:18,880 - INFO - Epoch 6/200, Total Loss: 2.1707, Base Loss: 0.5056, Con Loss: 1.6651, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 19:36:18,880 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 19:36:18,880 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:37:55,716 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.9703 | Old 0.9437 | New 0.9837
2024-12-07 19:37:55,716 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.9593 | Old 0.9294 | New 0.9743
2024-12-07 19:39:32,898 - INFO - Weighted Accuracies: All 0.8315 | Old 0.9729 | New 0.7609
2024-12-07 19:44:42,569 - INFO - Epoch 7/200, Total Loss: 2.1240, Base Loss: 0.4962, Con Loss: 1.6278, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 19:44:42,569 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-07 19:44:42,569 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:46:19,300 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.9694 | Old 0.9375 | New 0.9853
2024-12-07 19:46:19,300 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.9604 | Old 0.9357 | New 0.9728
2024-12-07 19:47:56,342 - INFO - Weighted Accuracies: All 0.8434 | Old 0.9738 | New 0.7782
2024-12-07 19:47:57,011 - INFO - Saved model!
2024-12-07 19:53:06,387 - INFO - Epoch 8/200, Total Loss: 2.0902, Base Loss: 0.4881, Con Loss: 1.6021, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 19:53:06,387 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-07 19:53:06,387 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 19:54:43,474 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.9690 | Old 0.9400 | New 0.9835
2024-12-07 19:54:43,474 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.9560 | Old 0.9320 | New 0.9680
2024-12-07 19:56:20,741 - INFO - Weighted Accuracies: All 0.8382 | Old 0.9719 | New 0.7713
2024-12-07 20:01:30,132 - INFO - Epoch 9/200, Total Loss: 2.0643, Base Loss: 0.4941, Con Loss: 1.5702, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:01:30,132 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-07 20:01:30,132 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:03:07,005 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.9710 | Old 0.9456 | New 0.9838
2024-12-07 20:03:07,007 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.9597 | Old 0.9326 | New 0.9732
2024-12-07 20:04:43,973 - INFO - Weighted Accuracies: All 0.8250 | Old 0.9767 | New 0.7492
2024-12-07 20:09:53,054 - INFO - Epoch 10/200, Total Loss: 2.0374, Base Loss: 0.4785, Con Loss: 1.5590, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:09:53,054 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-07 20:09:53,054 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:11:29,612 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.9694 | Old 0.9441 | New 0.9821
2024-12-07 20:11:29,613 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.9564 | Old 0.9390 | New 0.9652
