2024-11-28 23:04:03,078 - INFO - Training cifar10_seed3_iscap with the following settings:
2024-11-28 23:04:03,079 - INFO - Command-line arguments: output_dir=exp
 experiment_name=cifar10_seed3_iscap
 seed=3
 evaluate=False
 dataset_name=cifar10
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.1
 tau_t_start=0.07
 tau_t_end=0.04
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 5)
 unlabeled_classes=range(5, 10)
 num_labeled_classes=5
 num_unlabeled_classes=5
 log_path=exp/cifar10_seed3_iscap-2024-11-28-23-04/logs/log.txt
 model_path=exp/cifar10_seed3_iscap-2024-11-28-23-04/models/model.pth
 device=cuda
2024-11-28 23:04:03,085 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-11-28 23:04:05,177 - INFO - Building custom CLIP
2024-11-28 23:04:06,344 - INFO - Turning off gradients in both the image and the text encoder
2024-11-28 23:04:06,346 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-11-28 23:04:11,965 - INFO - len of train dataset: 50000
2024-11-28 23:04:11,965 - INFO - len of test dataset: 37500
2024-11-28 23:04:11,974 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-11-28 23:04:11,975 - INFO - Selecting 2250 high-confidence samples for co-teaching.
2024-11-28 23:05:53,202 - INFO - Before Train Accuracies: All 0.2274 | Old 0.0556 | New 0.3133
2024-11-28 23:05:53,202 - INFO - Before Train Accuracies: All 0.3202 | Old 0.0573 | New 0.4517
2024-11-28 23:11:04,835 - INFO - Epoch 1/200, Total Loss: 3.4433, Base Loss: 1.3828, Con Loss: 2.0605, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-28 23:11:04,835 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-11-28 23:11:04,836 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-28 23:12:42,863 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.9712 | Old 0.9512 | New 0.9812
2024-11-28 23:12:42,863 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.9443 | Old 0.9293 | New 0.9519
2024-11-28 23:14:21,184 - INFO - Weighted Accuracies: All 0.7989 | Old 0.9752 | New 0.7107
2024-11-28 23:14:21,869 - INFO - Saved model!
2024-11-28 23:19:33,421 - INFO - Epoch 2/200, Total Loss: 2.5065, Base Loss: 0.6199, Con Loss: 1.8865, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-28 23:19:33,421 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-11-28 23:19:33,421 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-28 23:21:11,408 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.9727 | Old 0.9492 | New 0.9844
2024-11-28 23:21:11,409 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.9539 | Old 0.9314 | New 0.9652
2024-11-28 23:22:49,462 - INFO - Weighted Accuracies: All 0.7997 | Old 0.9751 | New 0.7119
2024-11-28 23:22:50,175 - INFO - Saved model!
2024-11-28 23:28:02,870 - INFO - Epoch 3/200, Total Loss: 2.3790, Base Loss: 0.5741, Con Loss: 1.8048, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-28 23:28:02,870 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-11-28 23:28:02,870 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-28 23:29:40,743 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.9700 | Old 0.9439 | New 0.9830
2024-11-28 23:29:40,743 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.9574 | Old 0.9254 | New 0.9734
2024-11-28 23:31:18,580 - INFO - Weighted Accuracies: All 0.8072 | Old 0.9744 | New 0.7236
2024-11-28 23:31:19,316 - INFO - Saved model!
2024-11-28 23:36:31,306 - INFO - Epoch 4/200, Total Loss: 2.2794, Base Loss: 0.5375, Con Loss: 1.7418, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-28 23:36:31,307 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-11-28 23:36:31,307 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-28 23:38:09,233 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.9702 | Old 0.9485 | New 0.9811
2024-11-28 23:38:09,234 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.9573 | Old 0.9336 | New 0.9692
2024-11-28 23:39:47,397 - INFO - Weighted Accuracies: All 0.8294 | Old 0.9761 | New 0.7561
2024-11-28 23:39:48,145 - INFO - Saved model!
2024-11-28 23:45:00,433 - INFO - Epoch 5/200, Total Loss: 2.2198, Base Loss: 0.5270, Con Loss: 1.6928, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-28 23:45:00,433 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-11-28 23:45:00,433 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-28 23:46:38,684 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.9694 | Old 0.9411 | New 0.9836
2024-11-28 23:46:38,684 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.9561 | Old 0.9270 | New 0.9706
2024-11-28 23:48:17,085 - INFO - Weighted Accuracies: All 0.8046 | Old 0.9761 | New 0.7189
2024-11-28 23:53:29,852 - INFO - Epoch 6/200, Total Loss: 2.1677, Base Loss: 0.5047, Con Loss: 1.6630, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-28 23:53:29,852 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-11-28 23:53:29,852 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-28 23:55:08,025 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.9714 | Old 0.9482 | New 0.9830
2024-11-28 23:55:08,025 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.9587 | Old 0.9341 | New 0.9711
2024-11-28 23:56:45,827 - INFO - Weighted Accuracies: All 0.8102 | Old 0.9794 | New 0.7256
2024-11-29 00:01:57,994 - INFO - Epoch 7/200, Total Loss: 2.1221, Base Loss: 0.5019, Con Loss: 1.6202, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-29 00:01:57,995 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-11-29 00:01:57,995 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:03:35,759 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.9696 | Old 0.9443 | New 0.9822
2024-11-29 00:03:35,760 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.9578 | Old 0.9350 | New 0.9692
2024-11-29 00:05:13,544 - INFO - Weighted Accuracies: All 0.8032 | Old 0.9780 | New 0.7158
2024-11-29 00:10:25,554 - INFO - Epoch 8/200, Total Loss: 2.0879, Base Loss: 0.4922, Con Loss: 1.5957, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-29 00:10:25,554 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-11-29 00:10:25,554 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:12:03,357 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.9695 | Old 0.9432 | New 0.9826
2024-11-29 00:12:03,357 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.9576 | Old 0.9403 | New 0.9662
2024-11-29 00:13:41,156 - INFO - Weighted Accuracies: All 0.8201 | Old 0.9779 | New 0.7412
2024-11-29 00:18:52,692 - INFO - Epoch 9/200, Total Loss: 2.0516, Base Loss: 0.4776, Con Loss: 1.5740, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-29 00:18:52,692 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-11-29 00:18:52,692 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:20:30,604 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.9691 | Old 0.9385 | New 0.9845
2024-11-29 00:20:30,604 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.9608 | Old 0.9326 | New 0.9749
2024-11-29 00:22:08,686 - INFO - Weighted Accuracies: All 0.7998 | Old 0.9757 | New 0.7119
2024-11-29 00:27:20,941 - INFO - Epoch 10/200, Total Loss: 2.0241, Base Loss: 0.4718, Con Loss: 1.5523, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-29 00:27:20,941 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-11-29 00:27:20,941 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:28:58,946 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.9711 | Old 0.9462 | New 0.9836
2024-11-29 00:28:58,946 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.9606 | Old 0.9334 | New 0.9741
2024-11-29 00:30:37,135 - INFO - Weighted Accuracies: All 0.7864 | Old 0.9802 | New 0.6894
2024-11-29 00:35:48,687 - INFO - Epoch 11/200, Total Loss: 1.9982, Base Loss: 0.4703, Con Loss: 1.5279, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-11-29 00:35:48,687 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-11-29 00:35:48,687 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:37:26,912 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.9715 | Old 0.9495 | New 0.9825
2024-11-29 00:37:26,912 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.9615 | Old 0.9450 | New 0.9697
2024-11-29 00:39:04,534 - INFO - Weighted Accuracies: All 0.7835 | Old 0.9810 | New 0.6847
2024-11-29 00:40:42,842 - INFO - len of text selected samples: 22500
2024-11-29 00:45:55,706 - INFO - Epoch 12/200, Total Loss: 2.1800, Base Loss: 0.4741, Con Loss: 1.5072, Pseudo Loss Image: 0.1987, Pseudo Loss Image: 0.1987
2024-11-29 00:45:55,706 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-11-29 00:45:55,706 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:47:34,008 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.9719 | Old 0.9496 | New 0.9831
2024-11-29 00:47:34,009 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.9563 | Old 0.9505 | New 0.9592
2024-11-29 00:49:12,476 - INFO - Weighted Accuracies: All 0.9816 | Old 0.9686 | New 0.9880
2024-11-29 00:49:13,198 - INFO - Saved model!
2024-11-29 00:50:51,897 - INFO - len of text selected samples: 22500
2024-11-29 00:56:05,964 - INFO - Epoch 13/200, Total Loss: 2.0695, Base Loss: 0.4602, Con Loss: 1.4872, Pseudo Loss Image: 0.1221, Pseudo Loss Image: 0.1221
2024-11-29 00:56:05,964 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-11-29 00:56:05,965 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 00:57:43,779 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.9685 | Old 0.9382 | New 0.9836
2024-11-29 00:57:43,779 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.9643 | Old 0.9474 | New 0.9728
2024-11-29 00:59:22,196 - INFO - Weighted Accuracies: All 0.9817 | Old 0.9653 | New 0.9899
2024-11-29 00:59:22,914 - INFO - Saved model!
2024-11-29 01:01:01,046 - INFO - len of text selected samples: 22500
2024-11-29 01:06:14,258 - INFO - Epoch 14/200, Total Loss: 2.0653, Base Loss: 0.4530, Con Loss: 1.4738, Pseudo Loss Image: 0.1386, Pseudo Loss Image: 0.1386
2024-11-29 01:06:14,258 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-11-29 01:06:14,258 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 01:07:52,448 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.9701 | Old 0.9418 | New 0.9842
2024-11-29 01:07:52,448 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.9620 | Old 0.9526 | New 0.9667
2024-11-29 01:09:30,570 - INFO - Weighted Accuracies: All 0.9805 | Old 0.9638 | New 0.9888
2024-11-29 01:11:08,976 - INFO - len of text selected samples: 22500
2024-11-29 01:16:22,420 - INFO - Epoch 15/200, Total Loss: 2.0300, Base Loss: 0.4466, Con Loss: 1.4584, Pseudo Loss Image: 0.1250, Pseudo Loss Image: 0.1250
2024-11-29 01:16:22,420 - INFO -    Param Group: classifier_head, Learning Rate: 0.0986
2024-11-29 01:16:22,420 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 01:18:00,596 - INFO - Text classifier Epoch 14 Train Accuracies: All 0.9711 | Old 0.9456 | New 0.9839
2024-11-29 01:18:00,597 - INFO - Image classifier Epoch 14 Train Accuracies: All 0.9603 | Old 0.9513 | New 0.9648
2024-11-29 01:19:38,731 - INFO - Weighted Accuracies: All 0.9813 | Old 0.9665 | New 0.9886
2024-11-29 01:21:17,214 - INFO - len of text selected samples: 22500
2024-11-29 01:26:31,330 - INFO - Epoch 16/200, Total Loss: 2.0100, Base Loss: 0.4432, Con Loss: 1.4456, Pseudo Loss Image: 0.1212, Pseudo Loss Image: 0.1212
2024-11-29 01:26:31,330 - INFO -    Param Group: classifier_head, Learning Rate: 0.0984
2024-11-29 01:26:31,330 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 01:28:09,681 - INFO - Text classifier Epoch 15 Train Accuracies: All 0.9715 | Old 0.9474 | New 0.9836
2024-11-29 01:28:09,681 - INFO - Image classifier Epoch 15 Train Accuracies: All 0.9625 | Old 0.9413 | New 0.9730
2024-11-29 01:29:47,535 - INFO - Weighted Accuracies: All 0.9818 | Old 0.9658 | New 0.9898
2024-11-29 01:29:48,285 - INFO - Saved model!
2024-11-29 01:33:04,832 - INFO - len of image selected samples: 22500
2024-11-29 01:33:04,833 - INFO - len of text selected samples: 22500
2024-11-29 01:38:18,738 - INFO - Epoch 17/200, Total Loss: 2.1168, Base Loss: 0.4506, Con Loss: 1.4311, Pseudo Loss Image: 0.1230, Pseudo Loss Image: 0.1230
2024-11-29 01:38:18,738 - INFO -    Param Group: classifier_head, Learning Rate: 0.0982
2024-11-29 01:38:18,738 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 01:39:56,986 - INFO - Text classifier Epoch 16 Train Accuracies: All 0.9740 | Old 0.9699 | New 0.9761
2024-11-29 01:39:56,986 - INFO - Image classifier Epoch 16 Train Accuracies: All 0.9666 | Old 0.9577 | New 0.9711
2024-11-29 01:41:34,907 - INFO - Weighted Accuracies: All 0.9827 | Old 0.9777 | New 0.9852
2024-11-29 01:41:35,643 - INFO - Saved model!
2024-11-29 01:44:51,785 - INFO - len of image selected samples: 22500
2024-11-29 01:44:51,786 - INFO - len of text selected samples: 22500
2024-11-29 01:50:05,967 - INFO - Epoch 18/200, Total Loss: 2.0518, Base Loss: 0.4438, Con Loss: 1.4180, Pseudo Loss Image: 0.1064, Pseudo Loss Image: 0.1064
2024-11-29 01:50:05,968 - INFO -    Param Group: classifier_head, Learning Rate: 0.0980
2024-11-29 01:50:05,968 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 01:51:44,347 - INFO - Text classifier Epoch 17 Train Accuracies: All 0.9784 | Old 0.9678 | New 0.9837
2024-11-29 01:51:44,347 - INFO - Image classifier Epoch 17 Train Accuracies: All 0.9656 | Old 0.9614 | New 0.9677
2024-11-29 01:53:23,025 - INFO - Weighted Accuracies: All 0.9844 | Old 0.9762 | New 0.9886
2024-11-29 01:53:24,034 - INFO - Saved model!
2024-11-29 01:56:40,232 - INFO - len of image selected samples: 22500
2024-11-29 01:56:40,232 - INFO - len of text selected samples: 22500
2024-11-29 02:01:53,796 - INFO - Epoch 19/200, Total Loss: 2.0212, Base Loss: 0.4297, Con Loss: 1.4060, Pseudo Loss Image: 0.1028, Pseudo Loss Image: 0.1028
2024-11-29 02:01:53,797 - INFO -    Param Group: classifier_head, Learning Rate: 0.0978
2024-11-29 02:01:53,797 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 02:03:31,949 - INFO - Text classifier Epoch 18 Train Accuracies: All 0.9759 | Old 0.9706 | New 0.9786
2024-11-29 02:03:31,949 - INFO - Image classifier Epoch 18 Train Accuracies: All 0.9665 | Old 0.9590 | New 0.9703
2024-11-29 02:05:10,239 - INFO - Weighted Accuracies: All 0.9841 | Old 0.9786 | New 0.9868
2024-11-29 02:08:26,872 - INFO - len of image selected samples: 22500
2024-11-29 02:08:26,872 - INFO - len of text selected samples: 22500
2024-11-29 02:13:40,700 - INFO - Epoch 20/200, Total Loss: 2.0217, Base Loss: 0.4376, Con Loss: 1.3953, Pseudo Loss Image: 0.1039, Pseudo Loss Image: 0.1039
2024-11-29 02:13:40,700 - INFO -    Param Group: classifier_head, Learning Rate: 0.0976
2024-11-29 02:13:40,700 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 02:15:18,723 - INFO - Text classifier Epoch 19 Train Accuracies: All 0.9777 | Old 0.9671 | New 0.9830
2024-11-29 02:15:18,723 - INFO - Image classifier Epoch 19 Train Accuracies: All 0.9611 | Old 0.9639 | New 0.9596
2024-11-29 02:16:57,090 - INFO - Weighted Accuracies: All 0.9839 | Old 0.9784 | New 0.9866
2024-11-29 02:20:13,816 - INFO - len of image selected samples: 22500
2024-11-29 02:20:13,817 - INFO - len of text selected samples: 22500
2024-11-29 02:25:27,922 - INFO - Epoch 21/200, Total Loss: 1.9858, Base Loss: 0.4250, Con Loss: 1.3804, Pseudo Loss Image: 0.0949, Pseudo Loss Image: 0.0949
2024-11-29 02:25:27,922 - INFO -    Param Group: classifier_head, Learning Rate: 0.0973
2024-11-29 02:25:27,922 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 02:27:05,519 - INFO - Text classifier Epoch 20 Train Accuracies: All 0.9782 | Old 0.9705 | New 0.9820
2024-11-29 02:27:05,519 - INFO - Image classifier Epoch 20 Train Accuracies: All 0.9662 | Old 0.9662 | New 0.9661
2024-11-29 02:28:44,194 - INFO - Weighted Accuracies: All 0.9842 | Old 0.9789 | New 0.9868
2024-11-29 02:32:00,557 - INFO - len of image selected samples: 22500
2024-11-29 02:32:00,558 - INFO - len of text selected samples: 22500
2024-11-29 02:37:14,632 - INFO - Epoch 22/200, Total Loss: 1.9728, Base Loss: 0.4212, Con Loss: 1.3750, Pseudo Loss Image: 0.0950, Pseudo Loss Image: 0.0950
2024-11-29 02:37:14,632 - INFO -    Param Group: classifier_head, Learning Rate: 0.0970
2024-11-29 02:37:14,633 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 02:38:52,795 - INFO - Text classifier Epoch 21 Train Accuracies: All 0.9783 | Old 0.9718 | New 0.9816
2024-11-29 02:38:52,795 - INFO - Image classifier Epoch 21 Train Accuracies: All 0.9657 | Old 0.9582 | New 0.9695
2024-11-29 02:40:31,002 - INFO - Weighted Accuracies: All 0.9842 | Old 0.9779 | New 0.9873
2024-11-29 02:43:47,057 - INFO - len of image selected samples: 22500
2024-11-29 02:43:47,058 - INFO - len of text selected samples: 22500
2024-11-29 02:49:00,488 - INFO - Epoch 23/200, Total Loss: 1.9696, Base Loss: 0.4319, Con Loss: 1.3599, Pseudo Loss Image: 0.0951, Pseudo Loss Image: 0.0951
2024-11-29 02:49:00,488 - INFO -    Param Group: classifier_head, Learning Rate: 0.0968
2024-11-29 02:49:00,488 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 02:50:38,106 - INFO - Text classifier Epoch 22 Train Accuracies: All 0.9786 | Old 0.9713 | New 0.9823
2024-11-29 02:50:38,106 - INFO - Image classifier Epoch 22 Train Accuracies: All 0.9641 | Old 0.9652 | New 0.9636
2024-11-29 02:52:16,404 - INFO - Weighted Accuracies: All 0.9840 | Old 0.9796 | New 0.9862
2024-11-29 02:55:32,654 - INFO - len of image selected samples: 22500
2024-11-29 02:55:32,655 - INFO - len of text selected samples: 22500
2024-11-29 03:00:47,094 - INFO - Epoch 24/200, Total Loss: 1.9556, Base Loss: 0.4348, Con Loss: 1.3544, Pseudo Loss Image: 0.0932, Pseudo Loss Image: 0.0932
2024-11-29 03:00:47,095 - INFO -    Param Group: classifier_head, Learning Rate: 0.0965
2024-11-29 03:00:47,095 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 03:02:25,130 - INFO - Text classifier Epoch 23 Train Accuracies: All 0.9790 | Old 0.9696 | New 0.9836
2024-11-29 03:02:25,130 - INFO - Image classifier Epoch 23 Train Accuracies: All 0.9682 | Old 0.9639 | New 0.9704
2024-11-29 03:04:03,140 - INFO - Weighted Accuracies: All 0.9849 | Old 0.9785 | New 0.9881
2024-11-29 03:04:03,867 - INFO - Saved model!
2024-11-29 03:07:20,299 - INFO - len of image selected samples: 22500
2024-11-29 03:07:20,300 - INFO - len of text selected samples: 22500
2024-11-29 03:12:33,645 - INFO - Epoch 25/200, Total Loss: 1.9457, Base Loss: 0.4345, Con Loss: 1.3419, Pseudo Loss Image: 0.0952, Pseudo Loss Image: 0.0952
2024-11-29 03:12:33,645 - INFO -    Param Group: classifier_head, Learning Rate: 0.0962
2024-11-29 03:12:33,645 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 03:14:11,878 - INFO - Text classifier Epoch 24 Train Accuracies: All 0.9776 | Old 0.9729 | New 0.9800
2024-11-29 03:14:11,878 - INFO - Image classifier Epoch 24 Train Accuracies: All 0.9668 | Old 0.9673 | New 0.9665
2024-11-29 03:15:50,112 - INFO - Weighted Accuracies: All 0.9844 | Old 0.9808 | New 0.9862
2024-11-29 03:19:06,889 - INFO - len of image selected samples: 22500
2024-11-29 03:19:06,890 - INFO - len of text selected samples: 22500
2024-11-29 03:24:20,694 - INFO - Epoch 26/200, Total Loss: 1.9199, Base Loss: 0.4255, Con Loss: 1.3335, Pseudo Loss Image: 0.0888, Pseudo Loss Image: 0.0888
2024-11-29 03:24:20,694 - INFO -    Param Group: classifier_head, Learning Rate: 0.0959
2024-11-29 03:24:20,694 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 03:25:58,945 - INFO - Text classifier Epoch 25 Train Accuracies: All 0.9790 | Old 0.9679 | New 0.9845
2024-11-29 03:25:58,945 - INFO - Image classifier Epoch 25 Train Accuracies: All 0.9571 | Old 0.9695 | New 0.9509
2024-11-29 03:27:36,902 - INFO - Weighted Accuracies: All 0.9836 | Old 0.9807 | New 0.9850
2024-11-29 03:30:53,260 - INFO - len of image selected samples: 22500
2024-11-29 03:30:53,260 - INFO - len of text selected samples: 22500
2024-11-29 03:36:06,246 - INFO - Epoch 27/200, Total Loss: 1.9120, Base Loss: 0.4159, Con Loss: 1.3229, Pseudo Loss Image: 0.0890, Pseudo Loss Image: 0.0890
2024-11-29 03:36:06,246 - INFO -    Param Group: classifier_head, Learning Rate: 0.0956
2024-11-29 03:36:06,246 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 03:37:44,235 - INFO - Text classifier Epoch 26 Train Accuracies: All 0.9790 | Old 0.9705 | New 0.9832
2024-11-29 03:37:44,236 - INFO - Image classifier Epoch 26 Train Accuracies: All 0.9650 | Old 0.9690 | New 0.9630
2024-11-29 03:39:22,346 - INFO - Weighted Accuracies: All 0.9838 | Old 0.9802 | New 0.9855
2024-11-29 03:42:38,512 - INFO - len of image selected samples: 22500
2024-11-29 03:42:38,512 - INFO - len of text selected samples: 22500
2024-11-29 03:47:51,929 - INFO - Epoch 28/200, Total Loss: 1.8849, Base Loss: 0.4169, Con Loss: 1.3165, Pseudo Loss Image: 0.0830, Pseudo Loss Image: 0.0830
2024-11-29 03:47:51,930 - INFO -    Param Group: classifier_head, Learning Rate: 0.0952
2024-11-29 03:47:51,930 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 03:49:30,084 - INFO - Text classifier Epoch 27 Train Accuracies: All 0.9779 | Old 0.9727 | New 0.9805
2024-11-29 03:49:30,084 - INFO - Image classifier Epoch 27 Train Accuracies: All 0.9646 | Old 0.9678 | New 0.9630
2024-11-29 03:51:08,523 - INFO - Weighted Accuracies: All 0.9825 | Old 0.9801 | New 0.9836
2024-11-29 03:54:24,947 - INFO - len of image selected samples: 22500
2024-11-29 03:54:24,947 - INFO - len of text selected samples: 22500
2024-11-29 03:59:39,113 - INFO - Epoch 29/200, Total Loss: 1.8806, Base Loss: 0.4202, Con Loss: 1.3042, Pseudo Loss Image: 0.0826, Pseudo Loss Image: 0.0826
2024-11-29 03:59:39,113 - INFO -    Param Group: classifier_head, Learning Rate: 0.0949
2024-11-29 03:59:39,113 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 04:01:17,061 - INFO - Text classifier Epoch 28 Train Accuracies: All 0.9774 | Old 0.9697 | New 0.9812
2024-11-29 04:01:17,061 - INFO - Image classifier Epoch 28 Train Accuracies: All 0.9655 | Old 0.9718 | New 0.9624
2024-11-29 04:02:55,414 - INFO - Weighted Accuracies: All 0.9826 | Old 0.9798 | New 0.9840
2024-11-29 04:06:11,497 - INFO - len of image selected samples: 22500
2024-11-29 04:06:11,497 - INFO - len of text selected samples: 22500
2024-11-29 04:11:25,253 - INFO - Epoch 30/200, Total Loss: 1.8799, Base Loss: 0.4211, Con Loss: 1.3017, Pseudo Loss Image: 0.0799, Pseudo Loss Image: 0.0799
2024-11-29 04:11:25,253 - INFO -    Param Group: classifier_head, Learning Rate: 0.0946
2024-11-29 04:11:25,253 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 04:13:03,149 - INFO - Text classifier Epoch 29 Train Accuracies: All 0.9789 | Old 0.9710 | New 0.9829
2024-11-29 04:13:03,149 - INFO - Image classifier Epoch 29 Train Accuracies: All 0.9666 | Old 0.9669 | New 0.9664
2024-11-29 04:14:41,084 - INFO - Weighted Accuracies: All 0.9840 | Old 0.9791 | New 0.9864
2024-11-29 04:17:57,853 - INFO - len of image selected samples: 22500
2024-11-29 04:17:57,853 - INFO - len of text selected samples: 22500
2024-11-29 04:23:11,591 - INFO - Epoch 31/200, Total Loss: 1.8778, Base Loss: 0.4262, Con Loss: 1.2921, Pseudo Loss Image: 0.0823, Pseudo Loss Image: 0.0823
2024-11-29 04:23:11,591 - INFO -    Param Group: classifier_head, Learning Rate: 0.0942
2024-11-29 04:23:11,591 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 04:24:49,480 - INFO - Text classifier Epoch 30 Train Accuracies: All 0.9781 | Old 0.9755 | New 0.9794
2024-11-29 04:24:49,480 - INFO - Image classifier Epoch 30 Train Accuracies: All 0.9682 | Old 0.9667 | New 0.9689
2024-11-29 04:26:27,852 - INFO - Weighted Accuracies: All 0.9834 | Old 0.9813 | New 0.9845
2024-11-29 04:29:44,252 - INFO - len of image selected samples: 22500
2024-11-29 04:29:44,252 - INFO - len of text selected samples: 22500
2024-11-29 04:34:58,376 - INFO - Epoch 32/200, Total Loss: 1.8495, Base Loss: 0.4127, Con Loss: 1.2880, Pseudo Loss Image: 0.0822, Pseudo Loss Image: 0.0822
2024-11-29 04:34:58,376 - INFO -    Param Group: classifier_head, Learning Rate: 0.0938
2024-11-29 04:34:58,376 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 04:36:36,379 - INFO - Text classifier Epoch 31 Train Accuracies: All 0.9797 | Old 0.9699 | New 0.9846
2024-11-29 04:36:36,380 - INFO - Image classifier Epoch 31 Train Accuracies: All 0.9670 | Old 0.9650 | New 0.9679
2024-11-29 04:38:14,766 - INFO - Weighted Accuracies: All 0.9841 | Old 0.9787 | New 0.9868
2024-11-29 04:41:31,228 - INFO - len of image selected samples: 22500
2024-11-29 04:41:31,229 - INFO - len of text selected samples: 22500
2024-11-29 04:46:45,124 - INFO - Epoch 33/200, Total Loss: 1.8340, Base Loss: 0.4097, Con Loss: 1.2758, Pseudo Loss Image: 0.0792, Pseudo Loss Image: 0.0792
2024-11-29 04:46:45,124 - INFO -    Param Group: classifier_head, Learning Rate: 0.0934
2024-11-29 04:46:45,124 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 04:48:22,915 - INFO - Text classifier Epoch 32 Train Accuracies: All 0.9795 | Old 0.9734 | New 0.9825
2024-11-29 04:48:22,915 - INFO - Image classifier Epoch 32 Train Accuracies: All 0.9686 | Old 0.9667 | New 0.9696
2024-11-29 04:50:00,392 - INFO - Weighted Accuracies: All 0.9840 | Old 0.9797 | New 0.9862
2024-11-29 04:53:16,008 - INFO - len of image selected samples: 22500
2024-11-29 04:53:16,008 - INFO - len of text selected samples: 22500
2024-11-29 04:58:28,206 - INFO - Epoch 34/200, Total Loss: 1.8397, Base Loss: 0.4159, Con Loss: 1.2776, Pseudo Loss Image: 0.0766, Pseudo Loss Image: 0.0766
2024-11-29 04:58:28,206 - INFO -    Param Group: classifier_head, Learning Rate: 0.0930
2024-11-29 04:58:28,206 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 05:00:06,241 - INFO - Text classifier Epoch 33 Train Accuracies: All 0.9794 | Old 0.9746 | New 0.9818
2024-11-29 05:00:06,242 - INFO - Image classifier Epoch 33 Train Accuracies: All 0.9610 | Old 0.9706 | New 0.9563
2024-11-29 05:01:44,047 - INFO - Weighted Accuracies: All 0.9829 | Old 0.9824 | New 0.9831
2024-11-29 05:04:59,649 - INFO - len of image selected samples: 22500
2024-11-29 05:04:59,649 - INFO - len of text selected samples: 22500
2024-11-29 05:10:13,405 - INFO - Epoch 35/200, Total Loss: 1.8394, Base Loss: 0.4180, Con Loss: 1.2698, Pseudo Loss Image: 0.0739, Pseudo Loss Image: 0.0739
2024-11-29 05:10:13,405 - INFO -    Param Group: classifier_head, Learning Rate: 0.0926
2024-11-29 05:10:13,405 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 05:11:51,271 - INFO - Text classifier Epoch 34 Train Accuracies: All 0.9790 | Old 0.9729 | New 0.9821
2024-11-29 05:11:51,271 - INFO - Image classifier Epoch 34 Train Accuracies: All 0.9697 | Old 0.9660 | New 0.9716
2024-11-29 05:13:28,772 - INFO - Weighted Accuracies: All 0.9844 | Old 0.9804 | New 0.9864
2024-11-29 05:16:45,048 - INFO - len of image selected samples: 22500
2024-11-29 05:16:45,049 - INFO - len of text selected samples: 22500
2024-11-29 05:21:57,533 - INFO - Epoch 36/200, Total Loss: 1.8204, Base Loss: 0.4210, Con Loss: 1.2564, Pseudo Loss Image: 0.0759, Pseudo Loss Image: 0.0759
2024-11-29 05:21:57,533 - INFO -    Param Group: classifier_head, Learning Rate: 0.0922
2024-11-29 05:21:57,533 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 05:23:35,375 - INFO - Text classifier Epoch 35 Train Accuracies: All 0.9802 | Old 0.9723 | New 0.9841
2024-11-29 05:23:35,375 - INFO - Image classifier Epoch 35 Train Accuracies: All 0.9698 | Old 0.9674 | New 0.9710
2024-11-29 05:25:12,936 - INFO - Weighted Accuracies: All 0.9846 | Old 0.9797 | New 0.9870
2024-11-29 05:28:28,590 - INFO - len of image selected samples: 22500
2024-11-29 05:28:28,591 - INFO - len of text selected samples: 22500
2024-11-29 05:33:41,519 - INFO - Epoch 37/200, Total Loss: 1.8140, Base Loss: 0.4198, Con Loss: 1.2558, Pseudo Loss Image: 0.0699, Pseudo Loss Image: 0.0699
2024-11-29 05:33:41,519 - INFO -    Param Group: classifier_head, Learning Rate: 0.0918
2024-11-29 05:33:41,519 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 05:35:18,981 - INFO - Text classifier Epoch 36 Train Accuracies: All 0.9788 | Old 0.9738 | New 0.9813
2024-11-29 05:35:18,981 - INFO - Image classifier Epoch 36 Train Accuracies: All 0.9680 | Old 0.9656 | New 0.9692
2024-11-29 05:36:56,481 - INFO - Weighted Accuracies: All 0.9833 | Old 0.9801 | New 0.9848
2024-11-29 05:40:11,800 - INFO - len of image selected samples: 22500
2024-11-29 05:40:11,800 - INFO - len of text selected samples: 22500
2024-11-29 05:45:24,952 - INFO - Epoch 38/200, Total Loss: 1.8085, Base Loss: 0.4091, Con Loss: 1.2512, Pseudo Loss Image: 0.0788, Pseudo Loss Image: 0.0788
2024-11-29 05:45:24,952 - INFO -    Param Group: classifier_head, Learning Rate: 0.0914
2024-11-29 05:45:24,952 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 05:47:02,764 - INFO - Text classifier Epoch 37 Train Accuracies: All 0.9778 | Old 0.9758 | New 0.9788
2024-11-29 05:47:02,765 - INFO - Image classifier Epoch 37 Train Accuracies: All 0.9663 | Old 0.9704 | New 0.9643
2024-11-29 05:48:40,343 - INFO - Weighted Accuracies: All 0.9822 | Old 0.9812 | New 0.9828
2024-11-29 05:51:56,156 - INFO - len of image selected samples: 22500
2024-11-29 05:51:56,156 - INFO - len of text selected samples: 22500
2024-11-29 05:57:42,344 - INFO - Epoch 39/200, Total Loss: 1.7887, Base Loss: 0.4098, Con Loss: 1.2366, Pseudo Loss Image: 0.0748, Pseudo Loss Image: 0.0748
2024-11-29 05:57:42,344 - INFO -    Param Group: classifier_head, Learning Rate: 0.0909
2024-11-29 05:57:42,344 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 05:59:49,151 - INFO - Text classifier Epoch 38 Train Accuracies: All 0.9788 | Old 0.9736 | New 0.9814
2024-11-29 05:59:49,152 - INFO - Image classifier Epoch 38 Train Accuracies: All 0.9634 | Old 0.9699 | New 0.9601
2024-11-29 06:01:54,724 - INFO - Weighted Accuracies: All 0.9822 | Old 0.9811 | New 0.9828
2024-11-29 06:05:10,866 - INFO - len of image selected samples: 22500
2024-11-29 06:05:10,866 - INFO - len of text selected samples: 22500
2024-11-29 06:10:25,851 - INFO - Epoch 40/200, Total Loss: 1.8080, Base Loss: 0.4239, Con Loss: 1.2380, Pseudo Loss Image: 0.0755, Pseudo Loss Image: 0.0755
2024-11-29 06:10:25,852 - INFO -    Param Group: classifier_head, Learning Rate: 0.0905
2024-11-29 06:10:25,852 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 06:12:03,802 - INFO - Text classifier Epoch 39 Train Accuracies: All 0.9785 | Old 0.9733 | New 0.9811
2024-11-29 06:12:03,803 - INFO - Image classifier Epoch 39 Train Accuracies: All 0.9675 | Old 0.9674 | New 0.9676
2024-11-29 06:13:41,713 - INFO - Weighted Accuracies: All 0.9829 | Old 0.9798 | New 0.9844
2024-11-29 06:16:57,458 - INFO - len of image selected samples: 22500
2024-11-29 06:16:57,458 - INFO - len of text selected samples: 22500
2024-11-29 06:22:10,071 - INFO - Epoch 41/200, Total Loss: 1.7779, Base Loss: 0.4121, Con Loss: 1.2281, Pseudo Loss Image: 0.0723, Pseudo Loss Image: 0.0723
2024-11-29 06:22:10,071 - INFO -    Param Group: classifier_head, Learning Rate: 0.0900
2024-11-29 06:22:10,072 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-11-29 06:23:47,718 - INFO - Text classifier Epoch 40 Train Accuracies: All 0.9793 | Old 0.9738 | New 0.9821
2024-11-29 06:23:47,718 - INFO - Image classifier Epoch 40 Train Accuracies: All 0.9685 | Old 0.9698 | New 0.9679
2024-11-29 06:25:25,207 - INFO - Weighted Accuracies: All 0.9834 | Old 0.9804 | New 0.9848
2024-11-29 06:28:40,728 - INFO - len of image selected samples: 22500
2024-11-29 06:28:40,728 - INFO - len of text selected samples: 22500
