2024-12-07 20:39:29,503 - INFO - Training scars_test_seed4 with the following settings:
2024-12-07 20:39:29,505 - INFO - Command-line arguments: output_dir=exp
 experiment_name=scars_test_seed4
 seed=4
 evaluate=False
 dataset_name=scars
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=[1, 11, 25, 38, 46, 50, 53, 75, 84, 100, 105, 117, 123, 129, 133, 134, 135, 136, 137, 138, 140, 144, 145, 146, 147, 149, 150, 151, 153, 160, 161, 162, 163, 164, 167, 168, 169, 174, 175, 180, 185, 186, 187, 192, 193, 0, 81, 97, 104, 122, 139, 141, 142, 143, 148, 152, 154, 155, 156, 157, 158, 159, 165, 166, 170, 171, 172, 173, 176, 177, 181, 184, 188, 191, 194, 195, 2, 7, 9, 16, 20, 26, 28, 44, 54, 95, 98, 102, 127, 178, 182, 22, 41, 82, 93, 112, 125, 189]
 unlabeled_classes=[23, 42, 83, 94, 113, 126, 190, 3, 8, 10, 17, 21, 27, 29, 45, 55, 96, 99, 103, 128, 179, 183, 4, 5, 6, 12, 13, 14, 15, 18, 19, 24, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 43, 47, 48, 49, 51, 52, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 76, 77, 78, 79, 80, 85, 86, 87, 88, 89, 90, 91, 92, 101, 106, 107, 108, 109, 110, 111, 114, 115, 116, 118, 119, 120, 121, 124, 130, 131, 132]
 num_labeled_classes=98
 num_unlabeled_classes=98
 log_path=exp/scars_test_seed4-2024-12-07-20-39/logs/log.txt
 model_path=exp/scars_test_seed4-2024-12-07-20-39/models/model.pth
 device=cuda
2024-12-07 20:39:29,508 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-07 20:39:31,536 - INFO - Building custom CLIP
2024-12-07 20:39:32,609 - INFO - Turning off gradients in both the image and the text encoder
2024-12-07 20:39:32,612 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 20:39:33,516 - INFO - len of train dataset: 8144
2024-12-07 20:39:33,518 - INFO - len of test dataset: 6144
2024-12-07 20:39:33,521 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 20:39:33,522 - INFO - Selecting 18 high-confidence samples for co-teaching.
2024-12-07 20:39:59,276 - INFO - Before Train Accuracies: All 0.0881 | Old 0.0755 | New 0.0941
2024-12-07 20:39:59,277 - INFO - Before Train Accuracies: All 0.0736 | Old 0.0350 | New 0.0922
2024-12-07 20:40:57,289 - INFO - Epoch 1/200, Total Loss: 11.7434, Base Loss: 9.9832, Con Loss: 1.7602, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:40:57,289 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 20:40:57,289 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:41:19,235 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.3402 | Old 0.2914 | New 0.3637
2024-12-07 20:41:19,236 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.1906 | Old 0.1989 | New 0.1866
2024-12-07 20:41:41,960 - INFO - Weighted Accuracies: All 0.2811 | Old 0.3603 | New 0.2428
2024-12-07 20:41:42,611 - INFO - Saved model!
2024-12-07 20:42:38,796 - INFO - Epoch 2/200, Total Loss: 9.6333, Base Loss: 7.9876, Con Loss: 1.6457, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:42:38,797 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 20:42:38,797 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:43:00,540 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.4512 | Old 0.5187 | New 0.4185
2024-12-07 20:43:00,540 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.2957 | Old 0.3853 | New 0.2525
2024-12-07 20:43:22,748 - INFO - Weighted Accuracies: All 0.4106 | Old 0.4498 | New 0.3917
2024-12-07 20:43:23,461 - INFO - Saved model!
2024-12-07 20:44:19,925 - INFO - Epoch 3/200, Total Loss: 7.1696, Base Loss: 5.5662, Con Loss: 1.6034, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:44:19,925 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 20:44:19,925 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:44:42,573 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.5133 | Old 0.6067 | New 0.4683
2024-12-07 20:44:42,573 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.3483 | Old 0.4483 | New 0.3000
2024-12-07 20:45:04,962 - INFO - Weighted Accuracies: All 0.4569 | Old 0.5552 | New 0.4094
2024-12-07 20:45:05,680 - INFO - Saved model!
2024-12-07 20:46:01,761 - INFO - Epoch 4/200, Total Loss: 6.2720, Base Loss: 4.6933, Con Loss: 1.5787, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:46:01,761 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 20:46:01,761 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:46:23,666 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.5500 | Old 0.6432 | New 0.5049
2024-12-07 20:46:23,666 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.3742 | Old 0.5207 | New 0.3034
2024-12-07 20:46:46,489 - INFO - Weighted Accuracies: All 0.4935 | Old 0.5962 | New 0.4439
2024-12-07 20:46:47,230 - INFO - Saved model!
2024-12-07 20:47:43,774 - INFO - Epoch 5/200, Total Loss: 5.7929, Base Loss: 4.2559, Con Loss: 1.5370, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:47:43,774 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 20:47:43,774 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:48:06,908 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.5877 | Old 0.6527 | New 0.5564
2024-12-07 20:48:06,908 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.4004 | Old 0.5997 | New 0.3041
2024-12-07 20:48:29,149 - INFO - Weighted Accuracies: All 0.5186 | Old 0.6207 | New 0.4692
2024-12-07 20:48:29,846 - INFO - Saved model!
2024-12-07 20:49:26,427 - INFO - Epoch 6/200, Total Loss: 5.4490, Base Loss: 3.9584, Con Loss: 1.4906, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:49:26,427 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 20:49:26,427 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:49:48,650 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.6147 | Old 0.6842 | New 0.5812
2024-12-07 20:49:48,650 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.4253 | Old 0.6482 | New 0.3176
2024-12-07 20:50:10,634 - INFO - Weighted Accuracies: All 0.5369 | Old 0.6092 | New 0.5021
2024-12-07 20:50:11,348 - INFO - Saved model!
2024-12-07 20:51:08,523 - INFO - Epoch 7/200, Total Loss: 5.3076, Base Loss: 3.8039, Con Loss: 1.5037, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:51:08,523 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-07 20:51:08,523 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:51:30,960 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.6261 | Old 0.6757 | New 0.6022
2024-12-07 20:51:30,960 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.4435 | Old 0.6357 | New 0.3507
2024-12-07 20:51:53,473 - INFO - Weighted Accuracies: All 0.5433 | Old 0.6377 | New 0.4977
2024-12-07 20:51:54,163 - INFO - Saved model!
2024-12-07 20:52:50,946 - INFO - Epoch 8/200, Total Loss: 5.1127, Base Loss: 3.6383, Con Loss: 1.4744, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:52:50,946 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-07 20:52:50,946 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:53:13,408 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.6556 | Old 0.7426 | New 0.6136
2024-12-07 20:53:13,408 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.4588 | Old 0.6907 | New 0.3469
2024-12-07 20:53:35,617 - INFO - Weighted Accuracies: All 0.5379 | Old 0.6427 | New 0.4873
2024-12-07 20:54:32,092 - INFO - Epoch 9/200, Total Loss: 4.9686, Base Loss: 3.5099, Con Loss: 1.4587, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:54:32,092 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-07 20:54:32,092 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:54:54,237 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.6745 | Old 0.7626 | New 0.6319
2024-12-07 20:54:54,238 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.4723 | Old 0.7046 | New 0.3601
2024-12-07 20:55:16,339 - INFO - Weighted Accuracies: All 0.5387 | Old 0.6827 | New 0.4692
2024-12-07 20:56:13,004 - INFO - Epoch 10/200, Total Loss: 4.8446, Base Loss: 3.4011, Con Loss: 1.4436, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:56:13,004 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-07 20:56:13,004 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:56:35,876 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.6982 | Old 0.7601 | New 0.6684
2024-12-07 20:56:35,877 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.4845 | Old 0.7321 | New 0.3650
2024-12-07 20:56:58,585 - INFO - Weighted Accuracies: All 0.5451 | Old 0.6622 | New 0.4885
2024-12-07 20:56:59,326 - INFO - Saved model!
2024-12-07 20:57:56,355 - INFO - Epoch 11/200, Total Loss: 4.7539, Base Loss: 3.3197, Con Loss: 1.4342, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:57:56,355 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-07 20:57:56,355 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:58:18,822 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.6938 | Old 0.7956 | New 0.6447
2024-12-07 20:58:18,822 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.4943 | Old 0.7466 | New 0.3724
2024-12-07 20:58:40,908 - INFO - Weighted Accuracies: All 0.5369 | Old 0.6717 | New 0.4719
2024-12-07 20:59:02,979 - INFO - len of text selected samples: 3334
2024-12-07 20:59:59,753 - INFO - Epoch 12/200, Total Loss: 7.6080, Base Loss: 3.2329, Con Loss: 1.4354, Pseudo Loss Image: 2.9396, Pseudo Loss Text: 0.0000
2024-12-07 20:59:59,753 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-07 20:59:59,753 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:00:23,374 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.7056 | Old 0.8246 | New 0.6481
2024-12-07 21:00:23,375 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.5348 | Old 0.7536 | New 0.4292
2024-12-07 21:00:46,704 - INFO - Weighted Accuracies: All 0.6789 | Old 0.8216 | New 0.6099
2024-12-07 21:00:47,459 - INFO - Saved model!
2024-12-07 21:01:10,502 - INFO - len of text selected samples: 3342
2024-12-07 21:02:07,261 - INFO - Epoch 13/200, Total Loss: 6.3981, Base Loss: 3.1079, Con Loss: 1.4433, Pseudo Loss Image: 1.8469, Pseudo Loss Text: 0.0000
2024-12-07 21:02:07,261 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-12-07 21:02:07,261 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:02:29,424 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.7147 | Old 0.8141 | New 0.6667
2024-12-07 21:02:29,441 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.6322 | Old 0.8176 | New 0.5426
2024-12-07 21:02:51,935 - INFO - Weighted Accuracies: All 0.7311 | Old 0.8621 | New 0.6679
2024-12-07 21:02:52,648 - INFO - Saved model!
2024-12-07 21:03:14,667 - INFO - len of text selected samples: 3364
2024-12-07 21:04:11,105 - INFO - Epoch 14/200, Total Loss: 5.7348, Base Loss: 2.9775, Con Loss: 1.4231, Pseudo Loss Image: 1.3342, Pseudo Loss Text: 0.0000
2024-12-07 21:04:11,106 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-12-07 21:04:11,106 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:04:33,158 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.7266 | Old 0.8611 | New 0.6616
2024-12-07 21:04:33,159 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.6860 | Old 0.8291 | New 0.6169
2024-12-07 21:04:55,418 - INFO - Weighted Accuracies: All 0.7510 | Old 0.8841 | New 0.6867
2024-12-07 21:04:56,164 - INFO - Saved model!
2024-12-07 21:05:18,332 - INFO - len of text selected samples: 3375
2024-12-07 21:06:15,103 - INFO - Epoch 15/200, Total Loss: 5.5440, Base Loss: 2.9160, Con Loss: 1.4219, Pseudo Loss Image: 1.2061, Pseudo Loss Text: 0.0000
2024-12-07 21:06:15,103 - INFO -    Param Group: classifier_head, Learning Rate: 0.0986
2024-12-07 21:06:15,103 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:06:36,957 - INFO - Text classifier Epoch 14 Train Accuracies: All 0.7319 | Old 0.8821 | New 0.6594
2024-12-07 21:06:36,958 - INFO - Image classifier Epoch 14 Train Accuracies: All 0.6981 | Old 0.8396 | New 0.6297
2024-12-07 21:06:59,528 - INFO - Weighted Accuracies: All 0.7596 | Old 0.8901 | New 0.6966
2024-12-07 21:07:00,214 - INFO - Saved model!
2024-12-07 21:07:22,528 - INFO - len of text selected samples: 3380
2024-12-07 21:08:20,822 - INFO - Epoch 16/200, Total Loss: 5.3332, Base Loss: 2.8821, Con Loss: 1.4012, Pseudo Loss Image: 1.0499, Pseudo Loss Text: 0.0000
2024-12-07 21:08:20,822 - INFO -    Param Group: classifier_head, Learning Rate: 0.0984
2024-12-07 21:08:20,822 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:08:43,049 - INFO - Text classifier Epoch 15 Train Accuracies: All 0.7386 | Old 0.8676 | New 0.6763
2024-12-07 21:08:43,049 - INFO - Image classifier Epoch 15 Train Accuracies: All 0.7067 | Old 0.8461 | New 0.6394
