2024-12-07 20:32:56,466 - INFO - Training scars_test_seed1 with the following settings:
2024-12-07 20:32:56,471 - INFO - Command-line arguments: output_dir=exp
 experiment_name=scars_test_seed1
 seed=1
 evaluate=False
 dataset_name=scars
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=[1, 11, 25, 38, 46, 50, 53, 75, 84, 100, 105, 117, 123, 129, 133, 134, 135, 136, 137, 138, 140, 144, 145, 146, 147, 149, 150, 151, 153, 160, 161, 162, 163, 164, 167, 168, 169, 174, 175, 180, 185, 186, 187, 192, 193, 0, 81, 97, 104, 122, 139, 141, 142, 143, 148, 152, 154, 155, 156, 157, 158, 159, 165, 166, 170, 171, 172, 173, 176, 177, 181, 184, 188, 191, 194, 195, 2, 7, 9, 16, 20, 26, 28, 44, 54, 95, 98, 102, 127, 178, 182, 22, 41, 82, 93, 112, 125, 189]
 unlabeled_classes=[23, 42, 83, 94, 113, 126, 190, 3, 8, 10, 17, 21, 27, 29, 45, 55, 96, 99, 103, 128, 179, 183, 4, 5, 6, 12, 13, 14, 15, 18, 19, 24, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 43, 47, 48, 49, 51, 52, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 76, 77, 78, 79, 80, 85, 86, 87, 88, 89, 90, 91, 92, 101, 106, 107, 108, 109, 110, 111, 114, 115, 116, 118, 119, 120, 121, 124, 130, 131, 132]
 num_labeled_classes=98
 num_unlabeled_classes=98
 log_path=exp/scars_test_seed1-2024-12-07-20-32/logs/log.txt
 model_path=exp/scars_test_seed1-2024-12-07-20-32/models/model.pth
 device=cuda
2024-12-07 20:32:56,474 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-07 20:32:58,555 - INFO - Building custom CLIP
2024-12-07 20:32:59,680 - INFO - Turning off gradients in both the image and the text encoder
2024-12-07 20:32:59,681 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 20:33:00,591 - INFO - len of train dataset: 8144
2024-12-07 20:33:00,593 - INFO - len of test dataset: 6144
2024-12-07 20:33:00,596 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 20:33:00,597 - INFO - Selecting 18 high-confidence samples for co-teaching.
2024-12-07 20:33:28,708 - INFO - Before Train Accuracies: All 0.1170 | Old 0.0530 | New 0.1480
2024-12-07 20:33:28,708 - INFO - Before Train Accuracies: All 0.0641 | Old 0.0340 | New 0.0787
2024-12-07 20:34:26,481 - INFO - Epoch 1/200, Total Loss: 11.7354, Base Loss: 9.9756, Con Loss: 1.7598, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:34:26,481 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 20:34:26,481 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:34:48,569 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.3438 | Old 0.2809 | New 0.3741
2024-12-07 20:34:48,569 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.1867 | Old 0.1674 | New 0.1960
2024-12-07 20:35:10,333 - INFO - Weighted Accuracies: All 0.2871 | Old 0.3113 | New 0.2754
2024-12-07 20:35:10,944 - INFO - Saved model!
2024-12-07 20:36:07,789 - INFO - Epoch 2/200, Total Loss: 9.6798, Base Loss: 8.0212, Con Loss: 1.6586, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:36:07,789 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 20:36:07,789 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:36:30,540 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.4583 | Old 0.5022 | New 0.4371
2024-12-07 20:36:30,540 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.2847 | Old 0.3388 | New 0.2585
2024-12-07 20:36:53,786 - INFO - Weighted Accuracies: All 0.4103 | Old 0.5062 | New 0.3640
2024-12-07 20:36:54,470 - INFO - Saved model!
2024-12-07 20:37:52,276 - INFO - Epoch 3/200, Total Loss: 7.1678, Base Loss: 5.5702, Con Loss: 1.5976, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:37:52,277 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 20:37:52,277 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:38:16,227 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.4987 | Old 0.6087 | New 0.4456
2024-12-07 20:38:16,228 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.3599 | Old 0.5057 | New 0.2894
2024-12-07 20:38:39,715 - INFO - Weighted Accuracies: All 0.4554 | Old 0.5682 | New 0.4009
2024-12-07 20:38:40,501 - INFO - Saved model!
2024-12-07 20:39:37,920 - INFO - Epoch 4/200, Total Loss: 6.2081, Base Loss: 4.6498, Con Loss: 1.5583, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:39:37,921 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 20:39:37,921 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:40:00,802 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.5496 | Old 0.6442 | New 0.5040
2024-12-07 20:40:00,802 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.3892 | Old 0.5732 | New 0.3003
2024-12-07 20:40:23,549 - INFO - Weighted Accuracies: All 0.4808 | Old 0.5947 | New 0.4258
2024-12-07 20:40:24,335 - INFO - Saved model!
2024-12-07 20:41:21,632 - INFO - Epoch 5/200, Total Loss: 5.7270, Base Loss: 4.1960, Con Loss: 1.5310, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:41:21,632 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 20:41:21,632 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:41:43,737 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.5856 | Old 0.6907 | New 0.5349
2024-12-07 20:41:43,737 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.4069 | Old 0.6212 | New 0.3034
2024-12-07 20:42:05,920 - INFO - Weighted Accuracies: All 0.5096 | Old 0.6227 | New 0.4550
2024-12-07 20:42:06,624 - INFO - Saved model!
2024-12-07 20:43:03,540 - INFO - Epoch 6/200, Total Loss: 5.4729, Base Loss: 3.9492, Con Loss: 1.5237, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:43:03,540 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 20:43:03,540 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:43:25,984 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.6183 | Old 0.6912 | New 0.5832
2024-12-07 20:43:25,984 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.4297 | Old 0.6222 | New 0.3367
2024-12-07 20:43:47,950 - INFO - Weighted Accuracies: All 0.5241 | Old 0.6387 | New 0.4687
2024-12-07 20:43:48,641 - INFO - Saved model!
2024-12-07 20:44:45,274 - INFO - Epoch 7/200, Total Loss: 5.2586, Base Loss: 3.7668, Con Loss: 1.4918, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:44:45,274 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-07 20:44:45,274 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:45:07,761 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.6372 | Old 0.7121 | New 0.6010
2024-12-07 20:45:07,761 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.4538 | Old 0.6532 | New 0.3575
2024-12-07 20:45:29,475 - INFO - Weighted Accuracies: All 0.5296 | Old 0.6482 | New 0.4724
2024-12-07 20:45:30,167 - INFO - Saved model!
2024-12-07 20:46:26,264 - INFO - Epoch 8/200, Total Loss: 5.0639, Base Loss: 3.5906, Con Loss: 1.4732, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:46:26,264 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-07 20:46:26,264 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:46:48,683 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.6419 | Old 0.7536 | New 0.5880
2024-12-07 20:46:48,683 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.4661 | Old 0.6927 | New 0.3567
2024-12-07 20:47:11,267 - INFO - Weighted Accuracies: All 0.5277 | Old 0.6977 | New 0.4456
2024-12-07 20:48:07,709 - INFO - Epoch 9/200, Total Loss: 4.9210, Base Loss: 3.4691, Con Loss: 1.4519, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:48:07,710 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-07 20:48:07,710 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:48:30,049 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.6506 | Old 0.7936 | New 0.5815
2024-12-07 20:48:30,050 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.4753 | Old 0.7166 | New 0.3587
2024-12-07 20:48:52,752 - INFO - Weighted Accuracies: All 0.5335 | Old 0.6667 | New 0.4692
2024-12-07 20:48:53,438 - INFO - Saved model!
2024-12-07 20:49:50,196 - INFO - Epoch 10/200, Total Loss: 4.8374, Base Loss: 3.3885, Con Loss: 1.4489, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:49:50,196 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-07 20:49:50,196 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:50:12,489 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.6883 | Old 0.8026 | New 0.6331
2024-12-07 20:50:12,490 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.4935 | Old 0.7496 | New 0.3698
2024-12-07 20:50:34,063 - INFO - Weighted Accuracies: All 0.5465 | Old 0.6547 | New 0.4943
2024-12-07 20:50:34,756 - INFO - Saved model!
2024-12-07 20:51:32,665 - INFO - Epoch 11/200, Total Loss: 4.7282, Base Loss: 3.3039, Con Loss: 1.4243, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:51:32,665 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-07 20:51:32,665 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:51:54,473 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.6904 | Old 0.8156 | New 0.6300
2024-12-07 20:51:54,473 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.4985 | Old 0.7606 | New 0.3720
2024-12-07 20:52:17,201 - INFO - Weighted Accuracies: All 0.5376 | Old 0.7071 | New 0.4557
2024-12-07 20:52:39,508 - INFO - len of text selected samples: 3317
2024-12-07 20:53:37,045 - INFO - Epoch 12/200, Total Loss: 7.5507, Base Loss: 3.2362, Con Loss: 1.4296, Pseudo Loss Image: 2.8848, Pseudo Loss Text: 0.0000
2024-12-07 20:53:37,046 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-07 20:53:37,046 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:53:59,633 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.7020 | Old 0.8366 | New 0.6370
2024-12-07 20:53:59,633 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.5389 | Old 0.7876 | New 0.4188
2024-12-07 20:54:22,426 - INFO - Weighted Accuracies: All 0.6877 | Old 0.8186 | New 0.6244
2024-12-07 20:54:23,116 - INFO - Saved model!
2024-12-07 20:54:45,623 - INFO - len of text selected samples: 3378
2024-12-07 20:55:42,893 - INFO - Epoch 13/200, Total Loss: 6.3974, Base Loss: 3.0757, Con Loss: 1.4522, Pseudo Loss Image: 1.8695, Pseudo Loss Text: 0.0000
2024-12-07 20:55:42,893 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-12-07 20:55:42,893 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:56:04,816 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.7121 | Old 0.8291 | New 0.6556
2024-12-07 20:56:04,816 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.6559 | Old 0.8361 | New 0.5689
2024-12-07 20:56:27,628 - INFO - Weighted Accuracies: All 0.7399 | Old 0.8771 | New 0.6737
2024-12-07 20:56:28,312 - INFO - Saved model!
2024-12-07 20:56:50,554 - INFO - len of text selected samples: 3382
2024-12-07 20:57:48,145 - INFO - Epoch 14/200, Total Loss: 5.8435, Base Loss: 2.9925, Con Loss: 1.4488, Pseudo Loss Image: 1.4022, Pseudo Loss Text: 0.0000
2024-12-07 20:57:48,145 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-12-07 20:57:48,145 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:58:11,141 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.7240 | Old 0.8491 | New 0.6635
2024-12-07 20:58:11,141 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.6921 | Old 0.8531 | New 0.6143
2024-12-07 20:58:34,135 - INFO - Weighted Accuracies: All 0.7594 | Old 0.8871 | New 0.6978
2024-12-07 20:58:34,911 - INFO - Saved model!
2024-12-07 20:58:58,401 - INFO - len of text selected samples: 3403
2024-12-07 20:59:56,539 - INFO - Epoch 15/200, Total Loss: 5.5157, Base Loss: 2.9517, Con Loss: 1.4223, Pseudo Loss Image: 1.1418, Pseudo Loss Text: 0.0000
2024-12-07 20:59:56,539 - INFO -    Param Group: classifier_head, Learning Rate: 0.0986
2024-12-07 20:59:56,539 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:00:20,582 - INFO - Text classifier Epoch 14 Train Accuracies: All 0.7160 | Old 0.8746 | New 0.6394
2024-12-07 21:00:20,582 - INFO - Image classifier Epoch 14 Train Accuracies: All 0.7131 | Old 0.8661 | New 0.6392
2024-12-07 21:00:45,525 - INFO - Weighted Accuracies: All 0.7775 | Old 0.9165 | New 0.7104
2024-12-07 21:00:46,307 - INFO - Saved model!
2024-12-07 21:01:11,059 - INFO - len of text selected samples: 3403
2024-12-07 21:02:09,679 - INFO - Epoch 16/200, Total Loss: 5.3829, Base Loss: 2.8913, Con Loss: 1.4117, Pseudo Loss Image: 1.0799, Pseudo Loss Text: 0.0000
2024-12-07 21:02:09,680 - INFO -    Param Group: classifier_head, Learning Rate: 0.0984
2024-12-07 21:02:09,680 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:02:32,978 - INFO - Text classifier Epoch 15 Train Accuracies: All 0.7355 | Old 0.8676 | New 0.6717
2024-12-07 21:02:32,978 - INFO - Image classifier Epoch 15 Train Accuracies: All 0.7194 | Old 0.8726 | New 0.6454
2024-12-07 21:02:55,896 - INFO - Weighted Accuracies: All 0.7687 | Old 0.9120 | New 0.6995
2024-12-07 21:03:42,714 - INFO - len of image selected samples: 3466
2024-12-07 21:03:42,716 - INFO - len of text selected samples: 3396
2024-12-07 21:04:41,213 - INFO - Epoch 17/200, Total Loss: 6.5361, Base Loss: 2.9166, Con Loss: 1.4433, Pseudo Loss Image: 0.9659, Pseudo Loss Text: 1.2104
2024-12-07 21:04:41,213 - INFO -    Param Group: classifier_head, Learning Rate: 0.0982
2024-12-07 21:04:41,213 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:05:04,108 - INFO - Text classifier Epoch 16 Train Accuracies: All 0.7804 | Old 0.8771 | New 0.7338
2024-12-07 21:05:04,108 - INFO - Image classifier Epoch 16 Train Accuracies: All 0.7231 | Old 0.8761 | New 0.6493
2024-12-07 21:05:26,713 - INFO - Weighted Accuracies: All 0.8008 | Old 0.9255 | New 0.7405
2024-12-07 21:05:27,509 - INFO - Saved model!
2024-12-07 21:06:13,691 - INFO - len of image selected samples: 3479
2024-12-07 21:06:13,694 - INFO - len of text selected samples: 3424
2024-12-07 21:07:12,085 - INFO - Epoch 18/200, Total Loss: 5.9581, Base Loss: 2.8417, Con Loss: 1.4205, Pseudo Loss Image: 0.8662, Pseudo Loss Text: 0.8298
2024-12-07 21:07:12,085 - INFO -    Param Group: classifier_head, Learning Rate: 0.0980
2024-12-07 21:07:12,085 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:07:37,283 - INFO - Text classifier Epoch 17 Train Accuracies: All 0.8016 | Old 0.9185 | New 0.7451
2024-12-07 21:07:37,283 - INFO - Image classifier Epoch 17 Train Accuracies: All 0.7480 | Old 0.8806 | New 0.6840
2024-12-07 21:08:02,094 - INFO - Weighted Accuracies: All 0.8117 | Old 0.9255 | New 0.7567
2024-12-07 21:08:02,901 - INFO - Saved model!
2024-12-07 21:08:50,387 - INFO - len of image selected samples: 3471
2024-12-07 21:08:50,389 - INFO - len of text selected samples: 3424
