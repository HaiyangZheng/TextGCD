2024-12-07 10:21:15,376 - INFO - Training cifar100_seed1_memax(1) with the following settings:
2024-12-07 10:21:15,376 - INFO - Command-line arguments: output_dir=exp_final_test
 experiment_name=cifar100_seed1_memax(1)
 seed=1
 evaluate=False
 dataset_name=cifar100
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=1.0
 image_size=224
 train_classes=range(0, 80)
 unlabeled_classes=range(80, 100)
 num_labeled_classes=80
 num_unlabeled_classes=20
 log_path=exp_final_test/cifar100_seed1_memax(1)-2024-12-07-10-21/logs/log.txt
 model_path=exp_final_test/cifar100_seed1_memax(1)-2024-12-07-10-21/models/model.pth
 device=cuda
2024-12-07 10:21:15,394 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-07 10:21:18,032 - INFO - Building custom CLIP
2024-12-07 10:21:19,152 - INFO - Turning off gradients in both the image and the text encoder
2024-12-07 10:21:19,153 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 10:21:24,299 - INFO - len of train dataset: 50000
2024-12-07 10:21:24,299 - INFO - len of test dataset: 30000
2024-12-07 10:21:24,310 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 10:21:24,311 - INFO - Selecting 180 high-confidence samples for co-teaching.
2024-12-07 10:22:51,409 - INFO - Before Train Accuracies: All 0.1178 | Old 0.0654 | New 0.2225
2024-12-07 10:22:51,409 - INFO - Before Train Accuracies: All 0.0723 | Old 0.0168 | New 0.1835
2024-12-07 10:28:02,074 - INFO - Epoch 1/200, Total Loss: 6.1237, Base Loss: 4.4813, Con Loss: 1.6425, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 10:28:02,074 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 10:28:02,074 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 10:29:20,356 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.6605 | Old 0.6516 | New 0.6783
2024-12-07 10:29:20,356 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.5573 | Old 0.6069 | New 0.4580
2024-12-07 10:30:38,665 - INFO - Weighted Accuracies: All 0.6672 | Old 0.6833 | New 0.6349
2024-12-07 10:30:39,260 - INFO - Saved model!
2024-12-07 10:35:49,091 - INFO - Epoch 2/200, Total Loss: 3.6547, Base Loss: 2.1255, Con Loss: 1.5292, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 10:35:49,091 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 10:35:49,091 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 10:37:07,189 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.7304 | Old 0.7815 | New 0.6282
2024-12-07 10:37:07,189 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.6141 | Old 0.6967 | New 0.4487
2024-12-07 10:38:25,357 - INFO - Weighted Accuracies: All 0.6761 | Old 0.7724 | New 0.4834
2024-12-07 10:38:26,050 - INFO - Saved model!
2024-12-07 10:43:35,871 - INFO - Epoch 3/200, Total Loss: 3.2684, Base Loss: 1.8166, Con Loss: 1.4518, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 10:43:35,871 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 10:43:35,871 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 10:44:54,195 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.7575 | Old 0.7853 | New 0.7020
2024-12-07 10:44:54,196 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.6320 | Old 0.7216 | New 0.4527
2024-12-07 10:46:12,424 - INFO - Weighted Accuracies: All 0.6878 | Old 0.8001 | New 0.4633
2024-12-07 10:46:13,109 - INFO - Saved model!
2024-12-07 10:51:23,342 - INFO - Epoch 4/200, Total Loss: 3.0845, Base Loss: 1.6779, Con Loss: 1.4066, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 10:51:23,342 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 10:51:23,342 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 10:52:41,996 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.7563 | Old 0.7853 | New 0.6984
2024-12-07 10:52:41,996 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.6522 | Old 0.7377 | New 0.4813
2024-12-07 10:54:00,512 - INFO - Weighted Accuracies: All 0.6793 | Old 0.8036 | New 0.4308
2024-12-07 10:59:11,134 - INFO - Epoch 5/200, Total Loss: 2.9941, Base Loss: 1.6152, Con Loss: 1.3788, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 10:59:11,134 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 10:59:11,134 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 11:00:29,611 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.7662 | Old 0.7894 | New 0.7196
2024-12-07 11:00:29,611 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.6652 | Old 0.7682 | New 0.4591
2024-12-07 11:01:48,161 - INFO - Weighted Accuracies: All 0.6774 | Old 0.8184 | New 0.3955
2024-12-07 11:06:58,931 - INFO - Epoch 6/200, Total Loss: 2.8928, Base Loss: 1.5477, Con Loss: 1.3451, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 11:06:58,932 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 11:06:58,932 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 11:08:17,064 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.7716 | Old 0.7874 | New 0.7398
2024-12-07 11:08:17,064 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.6765 | Old 0.7818 | New 0.4660
2024-12-07 11:09:35,688 - INFO - Weighted Accuracies: All 0.6765 | Old 0.8026 | New 0.4243
2024-12-07 11:14:46,818 - INFO - Epoch 7/200, Total Loss: 2.8461, Base Loss: 1.5138, Con Loss: 1.3322, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 11:14:46,818 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-07 11:14:46,818 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 11:16:05,064 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.7753 | Old 0.7889 | New 0.7483
2024-12-07 11:16:05,065 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.6949 | Old 0.7897 | New 0.5052
2024-12-07 11:17:23,559 - INFO - Weighted Accuracies: All 0.6830 | Old 0.8162 | New 0.4166
2024-12-07 11:22:34,233 - INFO - Epoch 8/200, Total Loss: 2.7866, Base Loss: 1.4755, Con Loss: 1.3110, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 11:22:34,233 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-07 11:22:34,233 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 11:23:52,862 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.7805 | Old 0.7898 | New 0.7619
2024-12-07 11:23:52,862 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.7078 | Old 0.7857 | New 0.5520
2024-12-07 11:25:10,977 - INFO - Weighted Accuracies: All 0.6871 | Old 0.8282 | New 0.4049
2024-12-07 11:30:21,592 - INFO - Epoch 9/200, Total Loss: 2.7270, Base Loss: 1.4357, Con Loss: 1.2914, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 11:30:21,592 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-07 11:30:21,592 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 11:31:39,897 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.7807 | Old 0.7905 | New 0.7611
2024-12-07 11:31:39,898 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.7219 | Old 0.7885 | New 0.5885
2024-12-07 11:32:58,235 - INFO - Weighted Accuracies: All 0.6726 | Old 0.8189 | New 0.3799
2024-12-07 11:38:08,862 - INFO - Epoch 10/200, Total Loss: 2.6980, Base Loss: 1.4134, Con Loss: 1.2847, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 11:38:08,862 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-07 11:38:08,862 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 11:39:26,882 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.7793 | Old 0.7932 | New 0.7516
2024-12-07 11:39:26,883 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.7254 | Old 0.7903 | New 0.5955
2024-12-07 11:40:45,479 - INFO - Weighted Accuracies: All 0.6771 | Old 0.8163 | New 0.3986
2024-12-07 11:45:56,553 - INFO - Epoch 11/200, Total Loss: 2.6679, Base Loss: 1.3965, Con Loss: 1.2714, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 11:45:56,553 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-07 11:45:56,554 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 11:47:14,570 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.7834 | Old 0.7937 | New 0.7628
2024-12-07 11:47:14,570 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.7285 | Old 0.7935 | New 0.5985
2024-12-07 11:48:32,864 - INFO - Weighted Accuracies: All 0.6813 | Old 0.8085 | New 0.4269
2024-12-07 11:49:51,492 - INFO - len of text selected samples: 18000
2024-12-07 11:55:03,161 - INFO - Epoch 12/200, Total Loss: 3.4413, Base Loss: 1.3927, Con Loss: 1.2754, Pseudo Loss Image: 0.7732, Pseudo Loss Text: 0.0000
2024-12-07 11:55:03,161 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-07 11:55:03,161 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 11:56:21,342 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.7694 | Old 0.7926 | New 0.7228
2024-12-07 11:56:21,342 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.7570 | Old 0.7762 | New 0.7185
2024-12-07 11:57:39,653 - INFO - Weighted Accuracies: All 0.8074 | Old 0.8270 | New 0.7680
2024-12-07 11:57:40,345 - INFO - Saved model!
2024-12-07 11:58:58,547 - INFO - len of text selected samples: 18000
2024-12-07 12:04:09,639 - INFO - Epoch 13/200, Total Loss: 3.2391, Base Loss: 1.3751, Con Loss: 1.2662, Pseudo Loss Image: 0.5978, Pseudo Loss Text: 0.0000
2024-12-07 12:04:09,639 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-12-07 12:04:09,639 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 12:05:27,800 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.7816 | Old 0.7920 | New 0.7610
2024-12-07 12:05:27,800 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.7603 | Old 0.7781 | New 0.7247
2024-12-07 12:06:46,235 - INFO - Weighted Accuracies: All 0.8095 | Old 0.8255 | New 0.7776
2024-12-07 12:06:46,925 - INFO - Saved model!
2024-12-07 12:08:05,337 - INFO - len of text selected samples: 18000
2024-12-07 12:13:17,537 - INFO - Epoch 14/200, Total Loss: 3.1576, Base Loss: 1.3732, Con Loss: 1.2458, Pseudo Loss Image: 0.5386, Pseudo Loss Text: 0.0000
2024-12-07 12:13:17,538 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-12-07 12:13:17,538 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 12:14:36,146 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.7794 | Old 0.7930 | New 0.7522
2024-12-07 12:14:36,147 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.7549 | Old 0.7760 | New 0.7126
2024-12-07 12:15:54,467 - INFO - Weighted Accuracies: All 0.8032 | Old 0.8237 | New 0.7623
2024-12-07 12:17:13,024 - INFO - len of text selected samples: 17999
2024-12-07 12:22:25,181 - INFO - Epoch 15/200, Total Loss: 3.1051, Base Loss: 1.3545, Con Loss: 1.2392, Pseudo Loss Image: 0.5114, Pseudo Loss Text: 0.0000
2024-12-07 12:22:25,181 - INFO -    Param Group: classifier_head, Learning Rate: 0.0986
2024-12-07 12:22:25,181 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 12:23:43,228 - INFO - Text classifier Epoch 14 Train Accuracies: All 0.7853 | Old 0.7905 | New 0.7747
2024-12-07 12:23:43,228 - INFO - Image classifier Epoch 14 Train Accuracies: All 0.7656 | Old 0.7817 | New 0.7333
2024-12-07 12:25:01,532 - INFO - Weighted Accuracies: All 0.8125 | Old 0.8255 | New 0.7866
2024-12-07 12:25:02,217 - INFO - Saved model!
2024-12-07 12:26:20,806 - INFO - len of text selected samples: 18000
2024-12-07 12:31:31,725 - INFO - Epoch 16/200, Total Loss: 3.0565, Base Loss: 1.3474, Con Loss: 1.2257, Pseudo Loss Image: 0.4835, Pseudo Loss Text: 0.0000
2024-12-07 12:31:31,726 - INFO -    Param Group: classifier_head, Learning Rate: 0.0984
2024-12-07 12:31:31,726 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 12:32:50,357 - INFO - Text classifier Epoch 15 Train Accuracies: All 0.7845 | Old 0.7946 | New 0.7643
2024-12-07 12:32:50,357 - INFO - Image classifier Epoch 15 Train Accuracies: All 0.7608 | Old 0.7927 | New 0.6968
2024-12-07 12:34:08,646 - INFO - Weighted Accuracies: All 0.8069 | Old 0.8253 | New 0.7703
2024-12-07 12:36:45,632 - INFO - len of image selected samples: 17999
2024-12-07 12:36:45,647 - INFO - len of text selected samples: 18000
2024-12-07 12:41:58,071 - INFO - Epoch 17/200, Total Loss: 3.5793, Base Loss: 1.3314, Con Loss: 1.2334, Pseudo Loss Image: 0.4828, Pseudo Loss Text: 0.5317
2024-12-07 12:41:58,072 - INFO -    Param Group: classifier_head, Learning Rate: 0.0982
2024-12-07 12:41:58,072 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 12:43:16,504 - INFO - Text classifier Epoch 16 Train Accuracies: All 0.7860 | Old 0.7916 | New 0.7747
2024-12-07 12:43:16,504 - INFO - Image classifier Epoch 16 Train Accuracies: All 0.7706 | Old 0.7888 | New 0.7342
2024-12-07 12:44:34,671 - INFO - Weighted Accuracies: All 0.8118 | Old 0.8222 | New 0.7909
2024-12-07 12:47:11,682 - INFO - len of image selected samples: 18000
2024-12-07 12:47:11,695 - INFO - len of text selected samples: 18000
2024-12-07 12:52:24,114 - INFO - Epoch 18/200, Total Loss: 3.4851, Base Loss: 1.3233, Con Loss: 1.2383, Pseudo Loss Image: 0.4613, Pseudo Loss Text: 0.4622
2024-12-07 12:52:24,114 - INFO -    Param Group: classifier_head, Learning Rate: 0.0980
2024-12-07 12:52:24,114 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 12:53:42,401 - INFO - Text classifier Epoch 17 Train Accuracies: All 0.7888 | Old 0.7943 | New 0.7779
2024-12-07 12:53:42,401 - INFO - Image classifier Epoch 17 Train Accuracies: All 0.7678 | Old 0.7853 | New 0.7330
2024-12-07 12:55:00,703 - INFO - Weighted Accuracies: All 0.8120 | Old 0.8227 | New 0.7906
2024-12-07 12:57:37,909 - INFO - len of image selected samples: 17999
2024-12-07 12:57:37,911 - INFO - len of text selected samples: 18000
2024-12-07 13:02:50,334 - INFO - Epoch 19/200, Total Loss: 3.4163, Base Loss: 1.3180, Con Loss: 1.2308, Pseudo Loss Image: 0.4449, Pseudo Loss Text: 0.4227
2024-12-07 13:02:50,334 - INFO -    Param Group: classifier_head, Learning Rate: 0.0978
2024-12-07 13:02:50,334 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 13:04:08,201 - INFO - Text classifier Epoch 18 Train Accuracies: All 0.7893 | Old 0.7961 | New 0.7757
2024-12-07 13:04:08,201 - INFO - Image classifier Epoch 18 Train Accuracies: All 0.7773 | Old 0.7888 | New 0.7542
2024-12-07 13:05:26,583 - INFO - Weighted Accuracies: All 0.8133 | Old 0.8210 | New 0.7978
2024-12-07 13:05:27,273 - INFO - Saved model!
2024-12-07 13:08:03,743 - INFO - len of image selected samples: 17998
2024-12-07 13:08:03,746 - INFO - len of text selected samples: 18000
2024-12-07 13:13:16,181 - INFO - Epoch 20/200, Total Loss: 3.3901, Base Loss: 1.3133, Con Loss: 1.2159, Pseudo Loss Image: 0.4484, Pseudo Loss Text: 0.4125
2024-12-07 13:13:16,182 - INFO -    Param Group: classifier_head, Learning Rate: 0.0976
2024-12-07 13:13:16,182 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 13:14:34,302 - INFO - Text classifier Epoch 19 Train Accuracies: All 0.7866 | Old 0.7948 | New 0.7703
2024-12-07 13:14:34,302 - INFO - Image classifier Epoch 19 Train Accuracies: All 0.7738 | Old 0.7921 | New 0.7373
2024-12-07 13:15:52,764 - INFO - Weighted Accuracies: All 0.8116 | Old 0.8238 | New 0.7872
2024-12-07 13:18:29,399 - INFO - len of image selected samples: 18000
2024-12-07 13:18:29,401 - INFO - len of text selected samples: 17998
2024-12-07 13:23:41,312 - INFO - Epoch 21/200, Total Loss: 3.3276, Base Loss: 1.3134, Con Loss: 1.2145, Pseudo Loss Image: 0.4096, Pseudo Loss Text: 0.3901
2024-12-07 13:23:41,312 - INFO -    Param Group: classifier_head, Learning Rate: 0.0973
2024-12-07 13:23:41,313 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 13:24:59,622 - INFO - Text classifier Epoch 20 Train Accuracies: All 0.7937 | Old 0.8019 | New 0.7774
2024-12-07 13:24:59,622 - INFO - Image classifier Epoch 20 Train Accuracies: All 0.7737 | Old 0.7916 | New 0.7380
2024-12-07 13:26:18,167 - INFO - Weighted Accuracies: All 0.8146 | Old 0.8246 | New 0.7945
2024-12-07 13:26:18,859 - INFO - Saved model!
2024-12-07 13:28:55,804 - INFO - len of image selected samples: 18000
2024-12-07 13:28:55,822 - INFO - len of text selected samples: 18000
2024-12-07 13:34:08,944 - INFO - Epoch 22/200, Total Loss: 3.2883, Base Loss: 1.3127, Con Loss: 1.2000, Pseudo Loss Image: 0.4022, Pseudo Loss Text: 0.3734
2024-12-07 13:34:08,945 - INFO -    Param Group: classifier_head, Learning Rate: 0.0970
2024-12-07 13:34:08,945 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 13:35:26,922 - INFO - Text classifier Epoch 21 Train Accuracies: All 0.7959 | Old 0.8043 | New 0.7792
2024-12-07 13:35:26,923 - INFO - Image classifier Epoch 21 Train Accuracies: All 0.7771 | Old 0.7928 | New 0.7456
2024-12-07 13:36:44,996 - INFO - Weighted Accuracies: All 0.8163 | Old 0.8259 | New 0.7970
2024-12-07 13:36:45,686 - INFO - Saved model!
2024-12-07 13:39:22,997 - INFO - len of image selected samples: 18000
2024-12-07 13:39:22,999 - INFO - len of text selected samples: 18000
2024-12-07 13:44:34,873 - INFO - Epoch 23/200, Total Loss: 3.2462, Base Loss: 1.2967, Con Loss: 1.1963, Pseudo Loss Image: 0.3917, Pseudo Loss Text: 0.3615
2024-12-07 13:44:34,873 - INFO -    Param Group: classifier_head, Learning Rate: 0.0968
2024-12-07 13:44:34,873 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 13:45:53,051 - INFO - Text classifier Epoch 22 Train Accuracies: All 0.7942 | Old 0.8034 | New 0.7758
2024-12-07 13:45:53,052 - INFO - Image classifier Epoch 22 Train Accuracies: All 0.7782 | Old 0.7963 | New 0.7421
2024-12-07 13:47:11,433 - INFO - Weighted Accuracies: All 0.8146 | Old 0.8250 | New 0.7936
2024-12-07 13:49:48,168 - INFO - len of image selected samples: 18000
2024-12-07 13:49:48,168 - INFO - len of text selected samples: 18000
2024-12-07 13:55:00,845 - INFO - Epoch 24/200, Total Loss: 3.1668, Base Loss: 1.2924, Con Loss: 1.1799, Pseudo Loss Image: 0.3660, Pseudo Loss Text: 0.3285
2024-12-07 13:55:00,845 - INFO -    Param Group: classifier_head, Learning Rate: 0.0965
2024-12-07 13:55:00,845 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 13:56:19,154 - INFO - Text classifier Epoch 23 Train Accuracies: All 0.7941 | Old 0.8012 | New 0.7799
2024-12-07 13:56:19,154 - INFO - Image classifier Epoch 23 Train Accuracies: All 0.7810 | Old 0.7911 | New 0.7609
2024-12-07 13:57:37,200 - INFO - Weighted Accuracies: All 0.8151 | Old 0.8253 | New 0.7949
2024-12-07 14:00:13,714 - INFO - len of image selected samples: 18000
2024-12-07 14:00:13,714 - INFO - len of text selected samples: 18000
2024-12-07 14:05:26,548 - INFO - Epoch 25/200, Total Loss: 3.1722, Base Loss: 1.2919, Con Loss: 1.1732, Pseudo Loss Image: 0.3762, Pseudo Loss Text: 0.3310
2024-12-07 14:05:26,548 - INFO -    Param Group: classifier_head, Learning Rate: 0.0962
2024-12-07 14:05:26,548 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 14:06:45,052 - INFO - Text classifier Epoch 24 Train Accuracies: All 0.7941 | Old 0.7976 | New 0.7870
2024-12-07 14:06:45,053 - INFO - Image classifier Epoch 24 Train Accuracies: All 0.7764 | Old 0.7930 | New 0.7431
2024-12-07 14:08:03,409 - INFO - Weighted Accuracies: All 0.8148 | Old 0.8207 | New 0.8030
2024-12-07 14:10:40,483 - INFO - len of image selected samples: 18000
2024-12-07 14:10:40,483 - INFO - len of text selected samples: 18000
2024-12-07 14:15:52,752 - INFO - Epoch 26/200, Total Loss: 3.1479, Base Loss: 1.2909, Con Loss: 1.1723, Pseudo Loss Image: 0.3623, Pseudo Loss Text: 0.3224
2024-12-07 14:15:52,752 - INFO -    Param Group: classifier_head, Learning Rate: 0.0959
2024-12-07 14:15:52,752 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 14:17:11,018 - INFO - Text classifier Epoch 25 Train Accuracies: All 0.7932 | Old 0.8056 | New 0.7684
2024-12-07 14:17:11,018 - INFO - Image classifier Epoch 25 Train Accuracies: All 0.7828 | Old 0.7919 | New 0.7646
2024-12-07 14:18:29,070 - INFO - Weighted Accuracies: All 0.8146 | Old 0.8259 | New 0.7921
2024-12-07 14:21:05,640 - INFO - len of image selected samples: 18000
2024-12-07 14:21:05,641 - INFO - len of text selected samples: 18000
2024-12-07 14:26:17,967 - INFO - Epoch 27/200, Total Loss: 3.1143, Base Loss: 1.2812, Con Loss: 1.1601, Pseudo Loss Image: 0.3547, Pseudo Loss Text: 0.3182
2024-12-07 14:26:17,967 - INFO -    Param Group: classifier_head, Learning Rate: 0.0956
2024-12-07 14:26:17,967 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 14:27:36,068 - INFO - Text classifier Epoch 26 Train Accuracies: All 0.7971 | Old 0.8031 | New 0.7853
2024-12-07 14:27:36,068 - INFO - Image classifier Epoch 26 Train Accuracies: All 0.7767 | Old 0.7936 | New 0.7428
2024-12-07 14:28:54,194 - INFO - Weighted Accuracies: All 0.8153 | Old 0.8232 | New 0.7994
2024-12-07 14:31:30,964 - INFO - len of image selected samples: 18000
2024-12-07 14:31:30,964 - INFO - len of text selected samples: 18000
2024-12-07 14:36:43,209 - INFO - Epoch 28/200, Total Loss: 3.0829, Base Loss: 1.2778, Con Loss: 1.1626, Pseudo Loss Image: 0.3462, Pseudo Loss Text: 0.2962
2024-12-07 14:36:43,209 - INFO -    Param Group: classifier_head, Learning Rate: 0.0952
2024-12-07 14:36:43,209 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 14:38:01,499 - INFO - Text classifier Epoch 27 Train Accuracies: All 0.7952 | Old 0.8031 | New 0.7795
2024-12-07 14:38:01,499 - INFO - Image classifier Epoch 27 Train Accuracies: All 0.7750 | Old 0.7923 | New 0.7403
2024-12-07 14:39:19,714 - INFO - Weighted Accuracies: All 0.8144 | Old 0.8220 | New 0.7991
2024-12-07 14:41:56,458 - INFO - len of image selected samples: 18000
2024-12-07 14:41:56,458 - INFO - len of text selected samples: 18000
2024-12-07 14:47:08,881 - INFO - Epoch 29/200, Total Loss: 3.0469, Base Loss: 1.2630, Con Loss: 1.1561, Pseudo Loss Image: 0.3318, Pseudo Loss Text: 0.2960
2024-12-07 14:47:08,881 - INFO -    Param Group: classifier_head, Learning Rate: 0.0949
2024-12-07 14:47:08,882 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 14:48:27,445 - INFO - Text classifier Epoch 28 Train Accuracies: All 0.7955 | Old 0.8054 | New 0.7756
2024-12-07 14:48:27,445 - INFO - Image classifier Epoch 28 Train Accuracies: All 0.7786 | Old 0.7954 | New 0.7452
2024-12-07 14:49:45,506 - INFO - Weighted Accuracies: All 0.8124 | Old 0.8212 | New 0.7948
2024-12-07 14:52:22,662 - INFO - len of image selected samples: 18000
2024-12-07 14:52:22,662 - INFO - len of text selected samples: 18000
