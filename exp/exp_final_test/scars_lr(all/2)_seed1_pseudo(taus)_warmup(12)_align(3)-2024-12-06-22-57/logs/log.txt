2024-12-06 22:57:38,350 - INFO - Training scars_lr(all/2)_seed1_pseudo(taus)_warmup(12)_align(3) with the following settings:
2024-12-06 22:57:38,351 - INFO - Command-line arguments: output_dir=exp_final_test
 experiment_name=scars_lr(all/2)_seed1_pseudo(taus)_warmup(12)_align(3)
 seed=1
 evaluate=False
 dataset_name=scars
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.00025
 classifier_lr=0.05
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=12
 class_aligning_epochs=3
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=[1, 11, 25, 38, 46, 50, 53, 75, 84, 100, 105, 117, 123, 129, 133, 134, 135, 136, 137, 138, 140, 144, 145, 146, 147, 149, 150, 151, 153, 160, 161, 162, 163, 164, 167, 168, 169, 174, 175, 180, 185, 186, 187, 192, 193, 0, 81, 97, 104, 122, 139, 141, 142, 143, 148, 152, 154, 155, 156, 157, 158, 159, 165, 166, 170, 171, 172, 173, 176, 177, 181, 184, 188, 191, 194, 195, 2, 7, 9, 16, 20, 26, 28, 44, 54, 95, 98, 102, 127, 178, 182, 22, 41, 82, 93, 112, 125, 189]
 unlabeled_classes=[23, 42, 83, 94, 113, 126, 190, 3, 8, 10, 17, 21, 27, 29, 45, 55, 96, 99, 103, 128, 179, 183, 4, 5, 6, 12, 13, 14, 15, 18, 19, 24, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 43, 47, 48, 49, 51, 52, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 76, 77, 78, 79, 80, 85, 86, 87, 88, 89, 90, 91, 92, 101, 106, 107, 108, 109, 110, 111, 114, 115, 116, 118, 119, 120, 121, 124, 130, 131, 132]
 num_labeled_classes=98
 num_unlabeled_classes=98
 log_path=exp_final_test/scars_lr(all/2)_seed1_pseudo(taus)_warmup(12)_align(3)-2024-12-06-22-57/logs/log.txt
 model_path=exp_final_test/scars_lr(all/2)_seed1_pseudo(taus)_warmup(12)_align(3)-2024-12-06-22-57/models/model.pth
 device=cuda
2024-12-06 22:57:38,355 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-06 22:57:40,343 - INFO - Building custom CLIP
2024-12-06 22:57:41,405 - INFO - Turning off gradients in both the image and the text encoder
2024-12-06 22:57:41,406 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-06 22:57:42,273 - INFO - len of train dataset: 8144
2024-12-06 22:57:42,273 - INFO - len of test dataset: 6144
2024-12-06 22:57:42,276 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-06 22:57:42,277 - INFO - Selecting 18 high-confidence samples for co-teaching.
2024-12-06 22:58:08,065 - INFO - Before Train Accuracies: All 0.1170 | Old 0.0530 | New 0.1480
2024-12-06 22:58:08,065 - INFO - Before Train Accuracies: All 0.0641 | Old 0.0340 | New 0.0787
2024-12-06 22:59:05,811 - INFO - Epoch 1/200, Total Loss: 11.9894, Base Loss: 10.1786, Con Loss: 1.8109, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 22:59:05,811 - INFO -    Param Group: classifier_head, Learning Rate: 0.0500
2024-12-06 22:59:05,811 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 22:59:27,648 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.3208 | Old 0.2724 | New 0.3442
2024-12-06 22:59:27,648 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.1471 | Old 0.1344 | New 0.1533
2024-12-06 22:59:49,230 - INFO - Weighted Accuracies: All 0.2109 | Old 0.1779 | New 0.2269
2024-12-06 22:59:49,835 - INFO - Saved model!
2024-12-06 23:00:46,268 - INFO - Epoch 2/200, Total Loss: 11.4825, Base Loss: 9.7599, Con Loss: 1.7225, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:00:46,268 - INFO -    Param Group: classifier_head, Learning Rate: 0.0500
2024-12-06 23:00:46,268 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:01:08,619 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.3854 | Old 0.3108 | New 0.4214
2024-12-06 23:01:08,619 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.1908 | Old 0.1669 | New 0.2023
2024-12-06 23:01:30,371 - INFO - Weighted Accuracies: All 0.3026 | Old 0.3498 | New 0.2797
2024-12-06 23:01:31,089 - INFO - Saved model!
2024-12-06 23:02:27,360 - INFO - Epoch 3/200, Total Loss: 10.3033, Base Loss: 8.6454, Con Loss: 1.6578, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:02:27,360 - INFO -    Param Group: classifier_head, Learning Rate: 0.0500
2024-12-06 23:02:27,360 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:02:49,160 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.4411 | Old 0.4368 | New 0.4432
2024-12-06 23:02:49,161 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.2308 | Old 0.2064 | New 0.2426
2024-12-06 23:03:11,077 - INFO - Weighted Accuracies: All 0.3713 | Old 0.4483 | New 0.3341
2024-12-06 23:03:11,794 - INFO - Saved model!
2024-12-06 23:04:07,531 - INFO - Epoch 4/200, Total Loss: 8.5421, Base Loss: 6.9263, Con Loss: 1.6158, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:04:07,531 - INFO -    Param Group: classifier_head, Learning Rate: 0.0500
2024-12-06 23:04:07,531 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:04:29,885 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.4465 | Old 0.4593 | New 0.4403
2024-12-06 23:04:29,885 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.2900 | Old 0.3478 | New 0.2621
2024-12-06 23:04:51,525 - INFO - Weighted Accuracies: All 0.4097 | Old 0.4723 | New 0.3794
2024-12-06 23:04:52,230 - INFO - Saved model!
2024-12-06 23:05:47,992 - INFO - Epoch 5/200, Total Loss: 7.1651, Base Loss: 5.5677, Con Loss: 1.5974, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:05:47,992 - INFO -    Param Group: classifier_head, Learning Rate: 0.0499
2024-12-06 23:05:47,992 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:06:10,409 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.4689 | Old 0.5542 | New 0.4277
2024-12-06 23:06:10,410 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.3299 | Old 0.4293 | New 0.2819
2024-12-06 23:06:32,332 - INFO - Weighted Accuracies: All 0.4346 | Old 0.5397 | New 0.3838
2024-12-06 23:06:33,047 - INFO - Saved model!
2024-12-06 23:07:29,328 - INFO - Epoch 6/200, Total Loss: 6.4897, Base Loss: 4.8893, Con Loss: 1.6004, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:07:29,328 - INFO -    Param Group: classifier_head, Learning Rate: 0.0499
2024-12-06 23:07:29,328 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:07:51,102 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.5015 | Old 0.5992 | New 0.4543
2024-12-06 23:07:51,102 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.3621 | Old 0.5147 | New 0.2884
2024-12-06 23:08:13,061 - INFO - Weighted Accuracies: All 0.4635 | Old 0.5512 | New 0.4212
2024-12-06 23:08:13,767 - INFO - Saved model!
2024-12-06 23:09:10,040 - INFO - Epoch 7/200, Total Loss: 6.0577, Base Loss: 4.4877, Con Loss: 1.5700, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:09:10,041 - INFO -    Param Group: classifier_head, Learning Rate: 0.0498
2024-12-06 23:09:10,041 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:09:32,307 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.5244 | Old 0.6422 | New 0.4675
2024-12-06 23:09:32,308 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.3820 | Old 0.5557 | New 0.2981
2024-12-06 23:09:54,307 - INFO - Weighted Accuracies: All 0.4723 | Old 0.5607 | New 0.4296
2024-12-06 23:09:54,989 - INFO - Saved model!
2024-12-06 23:10:50,662 - INFO - Epoch 8/200, Total Loss: 5.7516, Base Loss: 4.1964, Con Loss: 1.5553, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:10:50,662 - INFO -    Param Group: classifier_head, Learning Rate: 0.0498
2024-12-06 23:10:50,662 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:11:12,346 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.5509 | Old 0.6397 | New 0.5081
2024-12-06 23:11:12,346 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.3949 | Old 0.5627 | New 0.3138
2024-12-06 23:11:34,324 - INFO - Weighted Accuracies: All 0.4813 | Old 0.5567 | New 0.4448
2024-12-06 23:11:35,014 - INFO - Saved model!
2024-12-06 23:12:30,905 - INFO - Epoch 9/200, Total Loss: 5.5103, Base Loss: 3.9787, Con Loss: 1.5316, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:12:30,905 - INFO -    Param Group: classifier_head, Learning Rate: 0.0498
2024-12-06 23:12:30,905 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:12:53,220 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.5592 | Old 0.6547 | New 0.5132
2024-12-06 23:12:53,220 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.4080 | Old 0.5752 | New 0.3273
2024-12-06 23:13:14,960 - INFO - Weighted Accuracies: All 0.4943 | Old 0.6002 | New 0.4432
2024-12-06 23:13:15,654 - INFO - Saved model!
2024-12-06 23:14:11,781 - INFO - Epoch 10/200, Total Loss: 5.3671, Base Loss: 3.8414, Con Loss: 1.5257, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:14:11,781 - INFO -    Param Group: classifier_head, Learning Rate: 0.0497
2024-12-06 23:14:11,781 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:14:33,463 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.5687 | Old 0.6847 | New 0.5127
2024-12-06 23:14:33,463 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.4110 | Old 0.6297 | New 0.3053
2024-12-06 23:14:55,130 - INFO - Weighted Accuracies: All 0.5055 | Old 0.6182 | New 0.4511
2024-12-06 23:14:55,812 - INFO - Saved model!
2024-12-06 23:15:52,363 - INFO - Epoch 11/200, Total Loss: 5.2011, Base Loss: 3.6942, Con Loss: 1.5069, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:15:52,363 - INFO -    Param Group: classifier_head, Learning Rate: 0.0496
2024-12-06 23:15:52,363 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:16:14,409 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.5959 | Old 0.6792 | New 0.5556
2024-12-06 23:16:14,409 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.4219 | Old 0.6437 | New 0.3147
2024-12-06 23:16:37,004 - INFO - Weighted Accuracies: All 0.5132 | Old 0.6372 | New 0.4533
2024-12-06 23:16:37,692 - INFO - Saved model!
2024-12-06 23:17:34,151 - INFO - Epoch 12/200, Total Loss: 5.0833, Base Loss: 3.5824, Con Loss: 1.5009, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:17:34,151 - INFO -    Param Group: classifier_head, Learning Rate: 0.0496
2024-12-06 23:17:34,151 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:17:55,903 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.6050 | Old 0.6937 | New 0.5622
2024-12-06 23:17:55,904 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.4364 | Old 0.6182 | New 0.3485
2024-12-06 23:18:17,732 - INFO - Weighted Accuracies: All 0.5119 | Old 0.6447 | New 0.4477
2024-12-06 23:19:13,980 - INFO - Epoch 13/200, Total Loss: 5.0036, Base Loss: 3.5045, Con Loss: 1.4991, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:19:13,980 - INFO -    Param Group: classifier_head, Learning Rate: 0.0495
2024-12-06 23:19:13,980 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:19:35,425 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.6180 | Old 0.6857 | New 0.5853
2024-12-06 23:19:35,425 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.4487 | Old 0.6452 | New 0.3538
2024-12-06 23:19:57,161 - INFO - Weighted Accuracies: All 0.5164 | Old 0.6527 | New 0.4506
2024-12-06 23:19:57,846 - INFO - Saved model!
2024-12-06 23:20:19,571 - INFO - len of text selected samples: 2861
2024-12-06 23:21:16,323 - INFO - Epoch 14/200, Total Loss: 7.8744, Base Loss: 3.3988, Con Loss: 1.5006, Pseudo Loss Image: 2.9750, Pseudo Loss Text: 0.0000
2024-12-06 23:21:16,323 - INFO -    Param Group: classifier_head, Learning Rate: 0.0494
2024-12-06 23:21:16,323 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:21:38,053 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.6219 | Old 0.6872 | New 0.5904
2024-12-06 23:21:38,053 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.4434 | Old 0.6382 | New 0.3493
2024-12-06 23:22:00,127 - INFO - Weighted Accuracies: All 0.5854 | Old 0.6832 | New 0.5383
2024-12-06 23:22:00,840 - INFO - Saved model!
2024-12-06 23:22:22,963 - INFO - len of text selected samples: 2940
2024-12-06 23:23:19,024 - INFO - Epoch 15/200, Total Loss: 7.0918, Base Loss: 3.2906, Con Loss: 1.5102, Pseudo Loss Image: 2.2910, Pseudo Loss Text: 0.0000
2024-12-06 23:23:19,024 - INFO -    Param Group: classifier_head, Learning Rate: 0.0493
2024-12-06 23:23:19,024 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:23:40,798 - INFO - Text classifier Epoch 14 Train Accuracies: All 0.6278 | Old 0.6892 | New 0.5981
2024-12-06 23:23:40,798 - INFO - Image classifier Epoch 14 Train Accuracies: All 0.5348 | Old 0.7336 | New 0.4388
2024-12-06 23:24:02,936 - INFO - Weighted Accuracies: All 0.6323 | Old 0.7411 | New 0.5798
2024-12-06 23:24:03,621 - INFO - Saved model!
2024-12-06 23:24:25,475 - INFO - len of text selected samples: 2962
2024-12-06 23:25:21,957 - INFO - Epoch 16/200, Total Loss: 6.5471, Base Loss: 3.1549, Con Loss: 1.4872, Pseudo Loss Image: 1.9050, Pseudo Loss Text: 0.0000
2024-12-06 23:25:21,957 - INFO -    Param Group: classifier_head, Learning Rate: 0.0492
2024-12-06 23:25:21,957 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:25:43,718 - INFO - Text classifier Epoch 15 Train Accuracies: All 0.6364 | Old 0.6967 | New 0.6073
2024-12-06 23:25:43,719 - INFO - Image classifier Epoch 15 Train Accuracies: All 0.5905 | Old 0.7606 | New 0.5083
2024-12-06 23:26:05,695 - INFO - Weighted Accuracies: All 0.6632 | Old 0.7636 | New 0.6148
2024-12-06 23:26:06,387 - INFO - Saved model!
2024-12-06 23:26:50,108 - INFO - len of image selected samples: 3272
2024-12-06 23:26:50,108 - INFO - len of text selected samples: 3012
