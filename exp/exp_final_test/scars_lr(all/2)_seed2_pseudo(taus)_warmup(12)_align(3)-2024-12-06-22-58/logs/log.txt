2024-12-06 22:58:06,096 - INFO - Training scars_lr(all/2)_seed2_pseudo(taus)_warmup(12)_align(3) with the following settings:
2024-12-06 22:58:06,097 - INFO - Command-line arguments: output_dir=exp_final_test
 experiment_name=scars_lr(all/2)_seed2_pseudo(taus)_warmup(12)_align(3)
 seed=2
 evaluate=False
 dataset_name=scars
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.00025
 classifier_lr=0.05
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=12
 class_aligning_epochs=3
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=[1, 11, 25, 38, 46, 50, 53, 75, 84, 100, 105, 117, 123, 129, 133, 134, 135, 136, 137, 138, 140, 144, 145, 146, 147, 149, 150, 151, 153, 160, 161, 162, 163, 164, 167, 168, 169, 174, 175, 180, 185, 186, 187, 192, 193, 0, 81, 97, 104, 122, 139, 141, 142, 143, 148, 152, 154, 155, 156, 157, 158, 159, 165, 166, 170, 171, 172, 173, 176, 177, 181, 184, 188, 191, 194, 195, 2, 7, 9, 16, 20, 26, 28, 44, 54, 95, 98, 102, 127, 178, 182, 22, 41, 82, 93, 112, 125, 189]
 unlabeled_classes=[23, 42, 83, 94, 113, 126, 190, 3, 8, 10, 17, 21, 27, 29, 45, 55, 96, 99, 103, 128, 179, 183, 4, 5, 6, 12, 13, 14, 15, 18, 19, 24, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 43, 47, 48, 49, 51, 52, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 76, 77, 78, 79, 80, 85, 86, 87, 88, 89, 90, 91, 92, 101, 106, 107, 108, 109, 110, 111, 114, 115, 116, 118, 119, 120, 121, 124, 130, 131, 132]
 num_labeled_classes=98
 num_unlabeled_classes=98
 log_path=exp_final_test/scars_lr(all/2)_seed2_pseudo(taus)_warmup(12)_align(3)-2024-12-06-22-58/logs/log.txt
 model_path=exp_final_test/scars_lr(all/2)_seed2_pseudo(taus)_warmup(12)_align(3)-2024-12-06-22-58/models/model.pth
 device=cuda
2024-12-06 22:58:06,101 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-06 22:58:08,128 - INFO - Building custom CLIP
2024-12-06 22:58:09,234 - INFO - Turning off gradients in both the image and the text encoder
2024-12-06 22:58:09,236 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-06 22:58:10,138 - INFO - len of train dataset: 8144
2024-12-06 22:58:10,138 - INFO - len of test dataset: 6144
2024-12-06 22:58:10,141 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-06 22:58:10,141 - INFO - Selecting 18 high-confidence samples for co-teaching.
2024-12-06 22:58:36,227 - INFO - Before Train Accuracies: All 0.1284 | Old 0.0330 | New 0.1745
2024-12-06 22:58:36,227 - INFO - Before Train Accuracies: All 0.0418 | Old 0.0195 | New 0.0526
2024-12-06 22:59:33,756 - INFO - Epoch 1/200, Total Loss: 12.0024, Base Loss: 10.1811, Con Loss: 1.8214, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 22:59:33,756 - INFO -    Param Group: classifier_head, Learning Rate: 0.0500
2024-12-06 22:59:33,756 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 22:59:55,254 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.3569 | Old 0.3183 | New 0.3756
2024-12-06 22:59:55,254 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.1637 | Old 0.1184 | New 0.1856
2024-12-06 23:00:16,890 - INFO - Weighted Accuracies: All 0.2158 | Old 0.1819 | New 0.2322
2024-12-06 23:00:17,471 - INFO - Saved model!
2024-12-06 23:01:13,562 - INFO - Epoch 2/200, Total Loss: 11.4922, Base Loss: 9.7725, Con Loss: 1.7197, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:01:13,563 - INFO -    Param Group: classifier_head, Learning Rate: 0.0500
2024-12-06 23:01:13,563 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:01:35,137 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.3641 | Old 0.3073 | New 0.3915
2024-12-06 23:01:35,138 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.1955 | Old 0.1874 | New 0.1994
2024-12-06 23:01:56,941 - INFO - Weighted Accuracies: All 0.2902 | Old 0.3263 | New 0.2727
2024-12-06 23:01:57,605 - INFO - Saved model!
2024-12-06 23:02:53,467 - INFO - Epoch 3/200, Total Loss: 10.2376, Base Loss: 8.5729, Con Loss: 1.6647, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:02:53,468 - INFO -    Param Group: classifier_head, Learning Rate: 0.0500
2024-12-06 23:02:53,468 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:03:15,021 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.4033 | Old 0.4138 | New 0.3983
2024-12-06 23:03:15,023 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.2432 | Old 0.2474 | New 0.2411
2024-12-06 23:03:36,523 - INFO - Weighted Accuracies: All 0.3522 | Old 0.4338 | New 0.3128
2024-12-06 23:03:37,206 - INFO - Saved model!
2024-12-06 23:04:33,327 - INFO - Epoch 4/200, Total Loss: 8.5065, Base Loss: 6.8705, Con Loss: 1.6360, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:04:33,328 - INFO -    Param Group: classifier_head, Learning Rate: 0.0500
2024-12-06 23:04:33,328 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:04:54,880 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.4631 | Old 0.4738 | New 0.4579
2024-12-06 23:04:54,881 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.3018 | Old 0.3363 | New 0.2851
2024-12-06 23:05:16,369 - INFO - Weighted Accuracies: All 0.4059 | Old 0.4623 | New 0.3787
2024-12-06 23:05:17,045 - INFO - Saved model!
2024-12-06 23:06:12,927 - INFO - Epoch 5/200, Total Loss: 7.2443, Base Loss: 5.6307, Con Loss: 1.6136, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:06:12,927 - INFO -    Param Group: classifier_head, Learning Rate: 0.0499
2024-12-06 23:06:12,927 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:06:34,626 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.4840 | Old 0.5687 | New 0.4432
2024-12-06 23:06:34,626 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.3416 | Old 0.4403 | New 0.2940
2024-12-06 23:06:56,487 - INFO - Weighted Accuracies: All 0.4302 | Old 0.5172 | New 0.3881
2024-12-06 23:06:57,160 - INFO - Saved model!
2024-12-06 23:07:53,318 - INFO - Epoch 6/200, Total Loss: 6.5065, Base Loss: 4.9313, Con Loss: 1.5752, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:07:53,318 - INFO -    Param Group: classifier_head, Learning Rate: 0.0499
2024-12-06 23:07:53,318 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:08:15,434 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.5260 | Old 0.6237 | New 0.4789
2024-12-06 23:08:15,434 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.3644 | Old 0.5132 | New 0.2925
2024-12-06 23:08:36,960 - INFO - Weighted Accuracies: All 0.4533 | Old 0.5687 | New 0.3975
2024-12-06 23:08:37,627 - INFO - Saved model!
2024-12-06 23:09:33,530 - INFO - Epoch 7/200, Total Loss: 6.0708, Base Loss: 4.4979, Con Loss: 1.5729, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:09:33,531 - INFO -    Param Group: classifier_head, Learning Rate: 0.0498
2024-12-06 23:09:33,531 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:09:55,040 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.5493 | Old 0.6652 | New 0.4934
2024-12-06 23:09:55,041 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.3783 | Old 0.5717 | New 0.2848
2024-12-06 23:10:16,658 - INFO - Weighted Accuracies: All 0.4668 | Old 0.6102 | New 0.3975
2024-12-06 23:10:17,343 - INFO - Saved model!
2024-12-06 23:11:13,231 - INFO - Epoch 8/200, Total Loss: 5.8121, Base Loss: 4.2493, Con Loss: 1.5627, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:11:13,231 - INFO -    Param Group: classifier_head, Learning Rate: 0.0498
2024-12-06 23:11:13,231 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:11:35,256 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.5627 | Old 0.6402 | New 0.5252
2024-12-06 23:11:35,258 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.3924 | Old 0.5727 | New 0.3053
2024-12-06 23:11:57,304 - INFO - Weighted Accuracies: All 0.4917 | Old 0.6077 | New 0.4357
2024-12-06 23:11:57,973 - INFO - Saved model!
2024-12-06 23:12:53,846 - INFO - Epoch 9/200, Total Loss: 5.5567, Base Loss: 4.0140, Con Loss: 1.5428, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:12:53,846 - INFO -    Param Group: classifier_head, Learning Rate: 0.0498
2024-12-06 23:12:53,846 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:13:15,542 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.5806 | Old 0.6602 | New 0.5421
2024-12-06 23:13:15,543 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.4126 | Old 0.5882 | New 0.3278
2024-12-06 23:13:37,009 - INFO - Weighted Accuracies: All 0.5094 | Old 0.6077 | New 0.4620
2024-12-06 23:13:37,693 - INFO - Saved model!
2024-12-06 23:14:33,767 - INFO - Epoch 10/200, Total Loss: 5.3904, Base Loss: 3.8662, Con Loss: 1.5242, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:14:33,767 - INFO -    Param Group: classifier_head, Learning Rate: 0.0497
2024-12-06 23:14:33,767 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:14:55,477 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.5939 | Old 0.6742 | New 0.5552
2024-12-06 23:14:55,477 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.4274 | Old 0.6207 | New 0.3341
2024-12-06 23:15:16,927 - INFO - Weighted Accuracies: All 0.5269 | Old 0.6327 | New 0.4757
2024-12-06 23:15:17,603 - INFO - Saved model!
2024-12-06 23:16:12,976 - INFO - Epoch 11/200, Total Loss: 5.2522, Base Loss: 3.7341, Con Loss: 1.5181, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:16:12,976 - INFO -    Param Group: classifier_head, Learning Rate: 0.0496
2024-12-06 23:16:12,976 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:16:34,483 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.5977 | Old 0.6667 | New 0.5643
2024-12-06 23:16:34,484 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.4417 | Old 0.6257 | New 0.3529
2024-12-06 23:16:56,130 - INFO - Weighted Accuracies: All 0.5316 | Old 0.6107 | New 0.4934
2024-12-06 23:16:56,806 - INFO - Saved model!
2024-12-06 23:17:53,048 - INFO - Epoch 12/200, Total Loss: 5.1229, Base Loss: 3.6134, Con Loss: 1.5095, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:17:53,049 - INFO -    Param Group: classifier_head, Learning Rate: 0.0496
2024-12-06 23:17:53,049 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:18:14,505 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.6113 | Old 0.6527 | New 0.5914
2024-12-06 23:18:14,506 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.4486 | Old 0.6407 | New 0.3558
2024-12-06 23:18:36,157 - INFO - Weighted Accuracies: All 0.5319 | Old 0.6207 | New 0.4890
2024-12-06 23:18:36,836 - INFO - Saved model!
2024-12-06 23:19:33,298 - INFO - Epoch 13/200, Total Loss: 5.0120, Base Loss: 3.5128, Con Loss: 1.4991, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:19:33,299 - INFO -    Param Group: classifier_head, Learning Rate: 0.0495
2024-12-06 23:19:33,299 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:19:54,739 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.6183 | Old 0.6637 | New 0.5964
2024-12-06 23:19:54,740 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.4539 | Old 0.6387 | New 0.3647
2024-12-06 23:20:16,616 - INFO - Weighted Accuracies: All 0.5365 | Old 0.6282 | New 0.4922
2024-12-06 23:20:17,301 - INFO - Saved model!
2024-12-06 23:20:39,033 - INFO - len of text selected samples: 2801
2024-12-06 23:21:34,835 - INFO - Epoch 14/200, Total Loss: 7.8373, Base Loss: 3.3996, Con Loss: 1.4992, Pseudo Loss Image: 2.9385, Pseudo Loss Text: 0.0000
2024-12-06 23:21:34,837 - INFO -    Param Group: classifier_head, Learning Rate: 0.0494
2024-12-06 23:21:34,837 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:21:56,802 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.6405 | Old 0.6652 | New 0.6285
2024-12-06 23:21:56,802 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.4634 | Old 0.6417 | New 0.3773
2024-12-06 23:22:18,405 - INFO - Weighted Accuracies: All 0.5970 | Old 0.6957 | New 0.5494
2024-12-06 23:22:19,093 - INFO - Saved model!
2024-12-06 23:22:41,309 - INFO - len of text selected samples: 2890
2024-12-06 23:23:37,522 - INFO - Epoch 15/200, Total Loss: 7.1116, Base Loss: 3.2953, Con Loss: 1.4967, Pseudo Loss Image: 2.3196, Pseudo Loss Text: 0.0000
2024-12-06 23:23:37,522 - INFO -    Param Group: classifier_head, Learning Rate: 0.0493
2024-12-06 23:23:37,522 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:23:59,112 - INFO - Text classifier Epoch 14 Train Accuracies: All 0.6514 | Old 0.6702 | New 0.6423
2024-12-06 23:23:59,112 - INFO - Image classifier Epoch 14 Train Accuracies: All 0.5417 | Old 0.7216 | New 0.4547
2024-12-06 23:24:21,080 - INFO - Weighted Accuracies: All 0.6326 | Old 0.6972 | New 0.6015
2024-12-06 23:24:21,761 - INFO - Saved model!
2024-12-06 23:24:43,389 - INFO - len of text selected samples: 2936
2024-12-06 23:25:39,681 - INFO - Epoch 16/200, Total Loss: 6.5856, Base Loss: 3.1625, Con Loss: 1.4824, Pseudo Loss Image: 1.9407, Pseudo Loss Text: 0.0000
2024-12-06 23:25:39,681 - INFO -    Param Group: classifier_head, Learning Rate: 0.0492
2024-12-06 23:25:39,681 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:26:01,221 - INFO - Text classifier Epoch 15 Train Accuracies: All 0.6466 | Old 0.6872 | New 0.6271
2024-12-06 23:26:01,221 - INFO - Image classifier Epoch 15 Train Accuracies: All 0.5732 | Old 0.7411 | New 0.4922
2024-12-06 23:26:22,903 - INFO - Weighted Accuracies: All 0.6463 | Old 0.7171 | New 0.6121
2024-12-06 23:26:23,584 - INFO - Saved model!
2024-12-06 23:27:06,813 - INFO - len of image selected samples: 3226
2024-12-06 23:27:06,814 - INFO - len of text selected samples: 2963
