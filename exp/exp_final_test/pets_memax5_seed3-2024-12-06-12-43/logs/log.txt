2024-12-06 12:43:35,726 - INFO - Training pets_memax5_seed3 with the following settings:
2024-12-06 12:43:35,729 - INFO - Command-line arguments: output_dir=exp_final_test
 experiment_name=pets_memax5_seed3
 seed=3
 evaluate=False
 dataset_name=pets
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=5.0
 image_size=224
 train_classes=range(0, 19)
 unlabeled_classes=range(19, 37)
 num_labeled_classes=19
 num_unlabeled_classes=18
 log_path=exp_final_test/pets_memax5_seed3-2024-12-06-12-43/logs/log.txt
 model_path=exp_final_test/pets_memax5_seed3-2024-12-06-12-43/models/model.pth
 device=cuda
2024-12-06 12:43:35,734 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-06 12:43:38,150 - INFO - Building custom CLIP
2024-12-06 12:43:39,253 - INFO - Turning off gradients in both the image and the text encoder
2024-12-06 12:43:39,257 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-06 12:43:40,237 - INFO - len of train dataset: 3680
2024-12-06 12:43:40,240 - INFO - len of test dataset: 2738
2024-12-06 12:43:40,244 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-06 12:43:40,245 - INFO - Selecting 44 high-confidence samples for co-teaching.
2024-12-06 12:43:58,091 - INFO - Before Train Accuracies: All 0.1388 | Old 0.0106 | New 0.2061
2024-12-06 12:43:58,091 - INFO - Before Train Accuracies: All 0.1483 | Old 0.0541 | New 0.1978
2024-12-06 12:44:24,908 - INFO - Epoch 1/200, Total Loss: 26.6002, Base Loss: 24.4145, Con Loss: 2.1857, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 12:44:24,909 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-06 12:44:24,909 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 12:44:35,358 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.2648 | Old 0.1220 | New 0.3398
2024-12-06 12:44:35,358 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.0730 | Old 0.0000 | New 0.1114
2024-12-06 12:44:45,822 - INFO - Weighted Accuracies: All 0.0975 | Old 0.0710 | New 0.1114
2024-12-06 12:44:46,405 - INFO - Saved model!
2024-12-06 12:45:11,815 - INFO - Epoch 2/200, Total Loss: 13.8972, Base Loss: 11.6909, Con Loss: 2.2063, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 12:45:11,815 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-06 12:45:11,816 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 12:45:22,249 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.6077 | Old 0.6850 | New 0.5671
2024-12-06 12:45:22,249 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.4018 | Old 0.3510 | New 0.4284
2024-12-06 12:45:32,634 - INFO - Weighted Accuracies: All 0.5069 | Old 0.4242 | New 0.5504
2024-12-06 12:45:33,306 - INFO - Saved model!
2024-12-06 12:45:58,789 - INFO - Epoch 3/200, Total Loss: 6.4552, Base Loss: 4.3609, Con Loss: 2.0944, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 12:45:58,790 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-06 12:45:58,790 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 12:46:09,247 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.6541 | Old 0.7678 | New 0.5944
2024-12-06 12:46:09,248 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.4522 | Old 0.4284 | New 0.4646
2024-12-06 12:46:19,677 - INFO - Weighted Accuracies: All 0.5822 | Old 0.6310 | New 0.5565
2024-12-06 12:46:20,354 - INFO - Saved model!
2024-12-06 12:46:46,347 - INFO - Epoch 4/200, Total Loss: 5.5727, Base Loss: 3.5653, Con Loss: 2.0074, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 12:46:46,348 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-06 12:46:46,348 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 12:46:56,719 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.6925 | Old 0.7741 | New 0.6496
2024-12-06 12:46:56,719 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.4956 | Old 0.4687 | New 0.5097
2024-12-06 12:47:07,122 - INFO - Weighted Accuracies: All 0.5891 | Old 0.6797 | New 0.5415
2024-12-06 12:47:07,799 - INFO - Saved model!
2024-12-06 12:47:33,145 - INFO - Epoch 5/200, Total Loss: 5.1525, Base Loss: 3.2201, Con Loss: 1.9324, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 12:47:33,146 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-06 12:47:33,146 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 12:47:43,666 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.7169 | Old 0.7614 | New 0.6936
2024-12-06 12:47:43,666 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.5117 | Old 0.5292 | New 0.5025
2024-12-06 12:47:54,043 - INFO - Weighted Accuracies: All 0.6176 | Old 0.6935 | New 0.5777
2024-12-06 12:47:54,718 - INFO - Saved model!
2024-12-06 12:48:20,447 - INFO - Epoch 6/200, Total Loss: 4.9125, Base Loss: 3.0277, Con Loss: 1.8848, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 12:48:20,448 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-06 12:48:20,448 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 12:48:30,885 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.7115 | Old 0.7879 | New 0.6713
2024-12-06 12:48:30,885 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.5449 | Old 0.5779 | New 0.5276
2024-12-06 12:48:41,339 - INFO - Weighted Accuracies: All 0.6172 | Old 0.7264 | New 0.5599
2024-12-06 12:49:07,092 - INFO - Epoch 7/200, Total Loss: 4.7194, Base Loss: 2.8339, Con Loss: 1.8856, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 12:49:07,093 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-06 12:49:07,093 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 12:49:17,591 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.7232 | Old 0.7837 | New 0.6914
2024-12-06 12:49:17,592 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.5533 | Old 0.6448 | New 0.5053
2024-12-06 12:49:27,990 - INFO - Weighted Accuracies: All 0.6256 | Old 0.7540 | New 0.5582
2024-12-06 12:49:28,663 - INFO - Saved model!
2024-12-06 12:49:54,627 - INFO - Epoch 8/200, Total Loss: 4.4812, Base Loss: 2.6663, Con Loss: 1.8149, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 12:49:54,627 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-06 12:49:54,628 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 12:50:05,124 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.7502 | Old 0.7985 | New 0.7248
2024-12-06 12:50:05,124 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.5866 | Old 0.7275 | New 0.5125
2024-12-06 12:50:15,470 - INFO - Weighted Accuracies: All 0.6359 | Old 0.7381 | New 0.5822
2024-12-06 12:50:16,147 - INFO - Saved model!
2024-12-06 12:50:41,637 - INFO - Epoch 9/200, Total Loss: 4.3234, Base Loss: 2.5155, Con Loss: 1.8079, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 12:50:41,637 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-06 12:50:41,637 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 12:50:51,895 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.7495 | Old 0.8134 | New 0.7159
2024-12-06 12:50:51,895 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.6077 | Old 0.7041 | New 0.5571
2024-12-06 12:51:02,308 - INFO - Weighted Accuracies: All 0.6395 | Old 0.7815 | New 0.5649
2024-12-06 12:51:02,985 - INFO - Saved model!
2024-12-06 12:51:28,864 - INFO - Epoch 10/200, Total Loss: 4.1894, Base Loss: 2.4161, Con Loss: 1.7733, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 12:51:28,865 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-06 12:51:28,865 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 12:51:39,289 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.7202 | Old 0.8282 | New 0.6635
2024-12-06 12:51:39,289 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.6154 | Old 0.7285 | New 0.5560
2024-12-06 12:51:49,702 - INFO - Weighted Accuracies: All 0.6505 | Old 0.8462 | New 0.5476
2024-12-06 12:51:50,373 - INFO - Saved model!
2024-12-06 12:52:15,751 - INFO - Epoch 11/200, Total Loss: 4.1292, Base Loss: 2.3597, Con Loss: 1.7695, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 12:52:15,752 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-06 12:52:15,752 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 12:52:26,169 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.7458 | Old 0.8049 | New 0.7148
2024-12-06 12:52:26,170 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.6359 | Old 0.6925 | New 0.6061
2024-12-06 12:52:36,615 - INFO - Weighted Accuracies: All 0.6483 | Old 0.8908 | New 0.5209
2024-12-06 12:52:47,015 - INFO - len of text selected samples: 1549
2024-12-06 12:53:12,913 - INFO - Epoch 12/200, Total Loss: 6.3181, Base Loss: 2.4436, Con Loss: 1.7361, Pseudo Loss Image: 2.1383, Pseudo Loss Text: 0.0000
2024-12-06 12:53:12,914 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-06 12:53:12,914 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 12:53:23,320 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.7557 | Old 0.8028 | New 0.7309
2024-12-06 12:53:23,320 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.7016 | Old 0.7466 | New 0.6780
2024-12-06 12:53:33,789 - INFO - Weighted Accuracies: All 0.8006 | Old 0.8314 | New 0.7844
2024-12-06 12:53:34,463 - INFO - Saved model!
2024-12-06 12:53:44,852 - INFO - len of text selected samples: 1567
2024-12-06 12:54:10,487 - INFO - Epoch 13/200, Total Loss: 4.7782, Base Loss: 2.2610, Con Loss: 1.7484, Pseudo Loss Image: 0.7688, Pseudo Loss Text: 0.0000
2024-12-06 12:54:10,488 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-12-06 12:54:10,488 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 12:54:20,862 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.7462 | Old 0.8197 | New 0.7075
2024-12-06 12:54:20,862 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.7805 | Old 0.8335 | New 0.7526
2024-12-06 12:54:31,283 - INFO - Weighted Accuracies: All 0.8247 | Old 0.8600 | New 0.8061
2024-12-06 12:54:31,956 - INFO - Saved model!
2024-12-06 12:54:42,366 - INFO - len of text selected samples: 1562
2024-12-06 12:55:08,061 - INFO - Epoch 14/200, Total Loss: 4.4735, Base Loss: 2.1303, Con Loss: 1.7489, Pseudo Loss Image: 0.5942, Pseudo Loss Text: 0.0000
2024-12-06 12:55:08,061 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-12-06 12:55:08,061 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 12:55:18,468 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.7495 | Old 0.7773 | New 0.7348
2024-12-06 12:55:18,468 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.8272 | Old 0.8473 | New 0.8167
2024-12-06 12:55:28,861 - INFO - Weighted Accuracies: All 0.8298 | Old 0.8696 | New 0.8089
2024-12-06 12:55:29,539 - INFO - Saved model!
2024-12-06 12:55:39,870 - INFO - len of text selected samples: 1564
2024-12-06 12:56:05,941 - INFO - Epoch 15/200, Total Loss: 4.2270, Base Loss: 1.9948, Con Loss: 1.7225, Pseudo Loss Image: 0.5097, Pseudo Loss Text: 0.0000
2024-12-06 12:56:05,941 - INFO -    Param Group: classifier_head, Learning Rate: 0.0986
2024-12-06 12:56:05,941 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 12:56:16,396 - INFO - Text classifier Epoch 14 Train Accuracies: All 0.7516 | Old 0.8240 | New 0.7136
2024-12-06 12:56:16,396 - INFO - Image classifier Epoch 14 Train Accuracies: All 0.8126 | Old 0.7911 | New 0.8240
2024-12-06 12:56:26,852 - INFO - Weighted Accuracies: All 0.8221 | Old 0.8621 | New 0.8011
2024-12-06 12:56:37,266 - INFO - len of text selected samples: 1567
2024-12-06 12:57:03,058 - INFO - Epoch 16/200, Total Loss: 4.0745, Base Loss: 1.9480, Con Loss: 1.6890, Pseudo Loss Image: 0.4374, Pseudo Loss Text: 0.0000
2024-12-06 12:57:03,058 - INFO -    Param Group: classifier_head, Learning Rate: 0.0984
2024-12-06 12:57:03,058 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 12:57:13,533 - INFO - Text classifier Epoch 15 Train Accuracies: All 0.7593 | Old 0.8282 | New 0.7231
2024-12-06 12:57:13,533 - INFO - Image classifier Epoch 15 Train Accuracies: All 0.8236 | Old 0.8558 | New 0.8067
2024-12-06 12:57:24,005 - INFO - Weighted Accuracies: All 0.8254 | Old 0.8494 | New 0.8128
2024-12-06 12:57:44,866 - INFO - len of image selected samples: 1586
2024-12-06 12:57:44,868 - INFO - len of text selected samples: 1563
2024-12-06 12:58:10,730 - INFO - Epoch 17/200, Total Loss: 4.5163, Base Loss: 1.9243, Con Loss: 1.6678, Pseudo Loss Image: 0.4349, Pseudo Loss Text: 0.4893
2024-12-06 12:58:10,730 - INFO -    Param Group: classifier_head, Learning Rate: 0.0982
2024-12-06 12:58:10,731 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 12:58:21,183 - INFO - Text classifier Epoch 16 Train Accuracies: All 0.8112 | Old 0.8271 | New 0.8028
2024-12-06 12:58:21,183 - INFO - Image classifier Epoch 16 Train Accuracies: All 0.8214 | Old 0.8006 | New 0.8323
2024-12-06 12:58:31,629 - INFO - Weighted Accuracies: All 0.8393 | Old 0.8441 | New 0.8368
2024-12-06 12:58:32,351 - INFO - Saved model!
2024-12-06 12:58:53,240 - INFO - len of image selected samples: 1583
2024-12-06 12:58:53,243 - INFO - len of text selected samples: 1584
2024-12-06 12:59:18,573 - INFO - Epoch 18/200, Total Loss: 4.2616, Base Loss: 1.9135, Con Loss: 1.6957, Pseudo Loss Image: 0.3400, Pseudo Loss Text: 0.3125
2024-12-06 12:59:18,573 - INFO -    Param Group: classifier_head, Learning Rate: 0.0980
2024-12-06 12:59:18,573 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 12:59:29,054 - INFO - Text classifier Epoch 17 Train Accuracies: All 0.8408 | Old 0.8293 | New 0.8468
2024-12-06 12:59:29,054 - INFO - Image classifier Epoch 17 Train Accuracies: All 0.8353 | Old 0.8452 | New 0.8301
2024-12-06 12:59:39,506 - INFO - Weighted Accuracies: All 0.8444 | Old 0.8505 | New 0.8412
2024-12-06 12:59:40,192 - INFO - Saved model!
2024-12-06 13:00:01,008 - INFO - len of image selected samples: 1602
2024-12-06 13:00:01,011 - INFO - len of text selected samples: 1599
2024-12-06 13:00:26,938 - INFO - Epoch 19/200, Total Loss: 4.3041, Base Loss: 2.0269, Con Loss: 1.6865, Pseudo Loss Image: 0.3062, Pseudo Loss Text: 0.2845
2024-12-06 13:00:26,938 - INFO -    Param Group: classifier_head, Learning Rate: 0.0978
2024-12-06 13:00:26,938 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:00:37,377 - INFO - Text classifier Epoch 18 Train Accuracies: All 0.8550 | Old 0.8038 | New 0.8819
2024-12-06 13:00:37,377 - INFO - Image classifier Epoch 18 Train Accuracies: All 0.8426 | Old 0.8038 | New 0.8630
2024-12-06 13:00:47,801 - INFO - Weighted Accuracies: All 0.8590 | Old 0.8462 | New 0.8657
2024-12-06 13:00:48,478 - INFO - Saved model!
2024-12-06 13:01:09,273 - INFO - len of image selected samples: 1623
2024-12-06 13:01:09,275 - INFO - len of text selected samples: 1615
2024-12-06 13:01:34,711 - INFO - Epoch 20/200, Total Loss: 4.1573, Base Loss: 1.8992, Con Loss: 1.6729, Pseudo Loss Image: 0.2830, Pseudo Loss Text: 0.3021
2024-12-06 13:01:34,711 - INFO -    Param Group: classifier_head, Learning Rate: 0.0976
2024-12-06 13:01:34,711 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:01:45,053 - INFO - Text classifier Epoch 19 Train Accuracies: All 0.8641 | Old 0.8271 | New 0.8836
2024-12-06 13:01:45,054 - INFO - Image classifier Epoch 19 Train Accuracies: All 0.8682 | Old 0.8600 | New 0.8724
2024-12-06 13:01:55,425 - INFO - Weighted Accuracies: All 0.8820 | Old 0.8738 | New 0.8864
2024-12-06 13:01:56,105 - INFO - Saved model!
2024-12-06 13:02:16,996 - INFO - len of image selected samples: 1618
2024-12-06 13:02:16,998 - INFO - len of text selected samples: 1618
2024-12-06 13:02:43,193 - INFO - Epoch 21/200, Total Loss: 3.8888, Base Loss: 1.7869, Con Loss: 1.6436, Pseudo Loss Image: 0.2412, Pseudo Loss Text: 0.2171
2024-12-06 13:02:43,193 - INFO -    Param Group: classifier_head, Learning Rate: 0.0973
2024-12-06 13:02:43,194 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:02:53,626 - INFO - Text classifier Epoch 20 Train Accuracies: All 0.8817 | Old 0.8600 | New 0.8930
2024-12-06 13:02:53,626 - INFO - Image classifier Epoch 20 Train Accuracies: All 0.8744 | Old 0.8547 | New 0.8847
2024-12-06 13:03:04,034 - INFO - Weighted Accuracies: All 0.8901 | Old 0.8685 | New 0.9014
2024-12-06 13:03:04,714 - INFO - Saved model!
2024-12-06 13:03:25,528 - INFO - len of image selected samples: 1620
2024-12-06 13:03:25,530 - INFO - len of text selected samples: 1621
2024-12-06 13:03:51,208 - INFO - Epoch 22/200, Total Loss: 3.9772, Base Loss: 1.8681, Con Loss: 1.6453, Pseudo Loss Image: 0.2162, Pseudo Loss Text: 0.2476
2024-12-06 13:03:51,209 - INFO -    Param Group: classifier_head, Learning Rate: 0.0970
2024-12-06 13:03:51,209 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:04:01,594 - INFO - Text classifier Epoch 21 Train Accuracies: All 0.8722 | Old 0.8484 | New 0.8847
2024-12-06 13:04:01,595 - INFO - Image classifier Epoch 21 Train Accuracies: All 0.8725 | Old 0.8515 | New 0.8836
2024-12-06 13:04:11,983 - INFO - Weighted Accuracies: All 0.8860 | Old 0.8653 | New 0.8969
2024-12-06 13:04:32,908 - INFO - len of image selected samples: 1624
2024-12-06 13:04:32,910 - INFO - len of text selected samples: 1628
2024-12-06 13:04:58,469 - INFO - Epoch 23/200, Total Loss: 3.8827, Base Loss: 1.8183, Con Loss: 1.6186, Pseudo Loss Image: 0.2266, Pseudo Loss Text: 0.2192
2024-12-06 13:04:58,470 - INFO -    Param Group: classifier_head, Learning Rate: 0.0968
2024-12-06 13:04:58,470 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:05:08,802 - INFO - Text classifier Epoch 22 Train Accuracies: All 0.8784 | Old 0.8621 | New 0.8869
2024-12-06 13:05:08,802 - INFO - Image classifier Epoch 22 Train Accuracies: All 0.8755 | Old 0.8420 | New 0.8930
2024-12-06 13:05:19,198 - INFO - Weighted Accuracies: All 0.8882 | Old 0.8706 | New 0.8975
2024-12-06 13:05:39,900 - INFO - len of image selected samples: 1622
2024-12-06 13:05:39,903 - INFO - len of text selected samples: 1626
2024-12-06 13:06:05,910 - INFO - Epoch 24/200, Total Loss: 3.7873, Base Loss: 1.8031, Con Loss: 1.6063, Pseudo Loss Image: 0.1848, Pseudo Loss Text: 0.1931
2024-12-06 13:06:05,910 - INFO -    Param Group: classifier_head, Learning Rate: 0.0965
2024-12-06 13:06:05,910 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:06:16,391 - INFO - Text classifier Epoch 23 Train Accuracies: All 0.8798 | Old 0.8653 | New 0.8875
2024-12-06 13:06:16,391 - INFO - Image classifier Epoch 23 Train Accuracies: All 0.8795 | Old 0.8621 | New 0.8886
2024-12-06 13:06:26,828 - INFO - Weighted Accuracies: All 0.8890 | Old 0.8770 | New 0.8953
2024-12-06 13:06:47,730 - INFO - len of image selected samples: 1625
2024-12-06 13:06:47,733 - INFO - len of text selected samples: 1624
2024-12-06 13:07:14,107 - INFO - Epoch 25/200, Total Loss: 3.8533, Base Loss: 1.9204, Con Loss: 1.6150, Pseudo Loss Image: 0.1511, Pseudo Loss Text: 0.1668
2024-12-06 13:07:14,108 - INFO -    Param Group: classifier_head, Learning Rate: 0.0962
2024-12-06 13:07:14,108 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:07:24,565 - INFO - Text classifier Epoch 24 Train Accuracies: All 0.8879 | Old 0.8717 | New 0.8964
2024-12-06 13:07:24,565 - INFO - Image classifier Epoch 24 Train Accuracies: All 0.8860 | Old 0.8579 | New 0.9008
2024-12-06 13:07:34,985 - INFO - Weighted Accuracies: All 0.8948 | Old 0.8749 | New 0.9053
2024-12-06 13:07:35,656 - INFO - Saved model!
2024-12-06 13:07:56,448 - INFO - len of image selected samples: 1620
2024-12-06 13:07:56,450 - INFO - len of text selected samples: 1623
2024-12-06 13:08:22,531 - INFO - Epoch 26/200, Total Loss: 3.6801, Base Loss: 1.7381, Con Loss: 1.5925, Pseudo Loss Image: 0.1800, Pseudo Loss Text: 0.1694
2024-12-06 13:08:22,531 - INFO -    Param Group: classifier_head, Learning Rate: 0.0959
2024-12-06 13:08:22,532 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:08:32,945 - INFO - Text classifier Epoch 25 Train Accuracies: All 0.8842 | Old 0.8706 | New 0.8914
2024-12-06 13:08:32,947 - INFO - Image classifier Epoch 25 Train Accuracies: All 0.8974 | Old 0.8791 | New 0.9070
2024-12-06 13:08:43,317 - INFO - Weighted Accuracies: All 0.8988 | Old 0.8844 | New 0.9064
2024-12-06 13:08:43,997 - INFO - Saved model!
2024-12-06 13:09:04,839 - INFO - len of image selected samples: 1626
2024-12-06 13:09:04,842 - INFO - len of text selected samples: 1623
2024-12-06 13:09:30,605 - INFO - Epoch 27/200, Total Loss: 3.7072, Base Loss: 1.8035, Con Loss: 1.5952, Pseudo Loss Image: 0.1632, Pseudo Loss Text: 0.1454
2024-12-06 13:09:30,605 - INFO -    Param Group: classifier_head, Learning Rate: 0.0956
2024-12-06 13:09:30,605 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:09:41,067 - INFO - Text classifier Epoch 26 Train Accuracies: All 0.8941 | Old 0.8844 | New 0.8992
2024-12-06 13:09:41,067 - INFO - Image classifier Epoch 26 Train Accuracies: All 0.8912 | Old 0.8653 | New 0.9047
2024-12-06 13:09:51,494 - INFO - Weighted Accuracies: All 0.9025 | Old 0.8918 | New 0.9081
2024-12-06 13:09:52,166 - INFO - Saved model!
2024-12-06 13:10:13,056 - INFO - len of image selected samples: 1623
2024-12-06 13:10:13,058 - INFO - len of text selected samples: 1622
2024-12-06 13:10:38,602 - INFO - Epoch 28/200, Total Loss: 3.6428, Base Loss: 1.7981, Con Loss: 1.5886, Pseudo Loss Image: 0.1405, Pseudo Loss Text: 0.1156
2024-12-06 13:10:38,602 - INFO -    Param Group: classifier_head, Learning Rate: 0.0952
2024-12-06 13:10:38,602 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:10:49,072 - INFO - Text classifier Epoch 27 Train Accuracies: All 0.8937 | Old 0.8696 | New 0.9064
2024-12-06 13:10:49,073 - INFO - Image classifier Epoch 27 Train Accuracies: All 0.8970 | Old 0.8834 | New 0.9042
2024-12-06 13:10:59,525 - INFO - Weighted Accuracies: All 0.9043 | Old 0.8887 | New 0.9125
2024-12-06 13:11:00,206 - INFO - Saved model!
2024-12-06 13:11:20,944 - INFO - len of image selected samples: 1623
2024-12-06 13:11:20,946 - INFO - len of text selected samples: 1625
2024-12-06 13:11:46,553 - INFO - Epoch 29/200, Total Loss: 3.5463, Base Loss: 1.7169, Con Loss: 1.5615, Pseudo Loss Image: 0.1558, Pseudo Loss Text: 0.1121
2024-12-06 13:11:46,554 - INFO -    Param Group: classifier_head, Learning Rate: 0.0949
2024-12-06 13:11:46,554 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:11:57,061 - INFO - Text classifier Epoch 28 Train Accuracies: All 0.8893 | Old 0.8696 | New 0.8997
2024-12-06 13:11:57,061 - INFO - Image classifier Epoch 28 Train Accuracies: All 0.8955 | Old 0.8971 | New 0.8947
2024-12-06 13:12:07,491 - INFO - Weighted Accuracies: All 0.8974 | Old 0.8865 | New 0.9031
2024-12-06 13:12:28,241 - INFO - len of image selected samples: 1626
2024-12-06 13:12:28,243 - INFO - len of text selected samples: 1625
2024-12-06 13:12:54,088 - INFO - Epoch 30/200, Total Loss: 3.6118, Base Loss: 1.7804, Con Loss: 1.5685, Pseudo Loss Image: 0.1256, Pseudo Loss Text: 0.1373
2024-12-06 13:12:54,088 - INFO -    Param Group: classifier_head, Learning Rate: 0.0946
2024-12-06 13:12:54,088 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:13:04,589 - INFO - Text classifier Epoch 29 Train Accuracies: All 0.8912 | Old 0.8674 | New 0.9036
2024-12-06 13:13:04,589 - INFO - Image classifier Epoch 29 Train Accuracies: All 0.8901 | Old 0.8621 | New 0.9047
2024-12-06 13:13:14,958 - INFO - Weighted Accuracies: All 0.8999 | Old 0.8812 | New 0.9097
2024-12-06 13:13:35,757 - INFO - len of image selected samples: 1620
2024-12-06 13:13:35,759 - INFO - len of text selected samples: 1622
2024-12-06 13:14:01,760 - INFO - Epoch 31/200, Total Loss: 3.5245, Base Loss: 1.7170, Con Loss: 1.5433, Pseudo Loss Image: 0.1298, Pseudo Loss Text: 0.1344
2024-12-06 13:14:01,760 - INFO -    Param Group: classifier_head, Learning Rate: 0.0942
2024-12-06 13:14:01,760 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:14:12,242 - INFO - Text classifier Epoch 30 Train Accuracies: All 0.8890 | Old 0.8653 | New 0.9014
2024-12-06 13:14:12,242 - INFO - Image classifier Epoch 30 Train Accuracies: All 0.9003 | Old 0.8887 | New 0.9064
2024-12-06 13:14:22,687 - INFO - Weighted Accuracies: All 0.9018 | Old 0.8876 | New 0.9092
2024-12-06 13:14:43,505 - INFO - len of image selected samples: 1623
2024-12-06 13:14:43,507 - INFO - len of text selected samples: 1627
2024-12-06 13:15:09,783 - INFO - Epoch 32/200, Total Loss: 3.5427, Base Loss: 1.7572, Con Loss: 1.5366, Pseudo Loss Image: 0.1229, Pseudo Loss Text: 0.1260
2024-12-06 13:15:09,783 - INFO -    Param Group: classifier_head, Learning Rate: 0.0938
2024-12-06 13:15:09,783 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:15:20,116 - INFO - Text classifier Epoch 31 Train Accuracies: All 0.8923 | Old 0.8865 | New 0.8953
2024-12-06 13:15:20,116 - INFO - Image classifier Epoch 31 Train Accuracies: All 0.9050 | Old 0.8876 | New 0.9142
2024-12-06 13:15:30,580 - INFO - Weighted Accuracies: All 0.9050 | Old 0.8961 | New 0.9097
2024-12-06 13:15:31,250 - INFO - Saved model!
2024-12-06 13:15:51,996 - INFO - len of image selected samples: 1624
2024-12-06 13:15:51,998 - INFO - len of text selected samples: 1625
2024-12-06 13:16:18,142 - INFO - Epoch 33/200, Total Loss: 3.5226, Base Loss: 1.7239, Con Loss: 1.5406, Pseudo Loss Image: 0.1302, Pseudo Loss Text: 0.1279
2024-12-06 13:16:18,142 - INFO -    Param Group: classifier_head, Learning Rate: 0.0934
2024-12-06 13:16:18,142 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:16:28,511 - INFO - Text classifier Epoch 32 Train Accuracies: All 0.9149 | Old 0.8759 | New 0.9354
2024-12-06 13:16:28,511 - INFO - Image classifier Epoch 32 Train Accuracies: All 0.9032 | Old 0.8823 | New 0.9142
2024-12-06 13:16:38,872 - INFO - Weighted Accuracies: All 0.9149 | Old 0.8908 | New 0.9276
2024-12-06 13:16:39,579 - INFO - Saved model!
2024-12-06 13:17:00,434 - INFO - len of image selected samples: 1626
2024-12-06 13:17:00,436 - INFO - len of text selected samples: 1627
2024-12-06 13:17:26,373 - INFO - Epoch 34/200, Total Loss: 3.5619, Base Loss: 1.8081, Con Loss: 1.5351, Pseudo Loss Image: 0.1127, Pseudo Loss Text: 0.1060
2024-12-06 13:17:26,374 - INFO -    Param Group: classifier_head, Learning Rate: 0.0930
2024-12-06 13:17:26,374 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:17:36,794 - INFO - Text classifier Epoch 33 Train Accuracies: All 0.9123 | Old 0.8727 | New 0.9331
2024-12-06 13:17:36,794 - INFO - Image classifier Epoch 33 Train Accuracies: All 0.9007 | Old 0.8643 | New 0.9198
2024-12-06 13:17:47,260 - INFO - Weighted Accuracies: All 0.9164 | Old 0.8791 | New 0.9359
2024-12-06 13:17:47,940 - INFO - Saved model!
2024-12-06 13:18:08,869 - INFO - len of image selected samples: 1622
2024-12-06 13:18:08,871 - INFO - len of text selected samples: 1625
2024-12-06 13:18:34,473 - INFO - Epoch 35/200, Total Loss: 3.4273, Base Loss: 1.6989, Con Loss: 1.5099, Pseudo Loss Image: 0.1148, Pseudo Loss Text: 0.1036
2024-12-06 13:18:34,474 - INFO -    Param Group: classifier_head, Learning Rate: 0.0926
2024-12-06 13:18:34,474 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:18:44,881 - INFO - Text classifier Epoch 34 Train Accuracies: All 0.8915 | Old 0.8865 | New 0.8942
2024-12-06 13:18:44,881 - INFO - Image classifier Epoch 34 Train Accuracies: All 0.9047 | Old 0.8653 | New 0.9253
2024-12-06 13:18:55,261 - INFO - Weighted Accuracies: All 0.9032 | Old 0.8855 | New 0.9125
2024-12-06 13:19:15,964 - INFO - len of image selected samples: 1624
2024-12-06 13:19:15,965 - INFO - len of text selected samples: 1622
2024-12-06 13:19:42,054 - INFO - Epoch 36/200, Total Loss: 3.4488, Base Loss: 1.7327, Con Loss: 1.5078, Pseudo Loss Image: 0.1050, Pseudo Loss Text: 0.1033
2024-12-06 13:19:42,055 - INFO -    Param Group: classifier_head, Learning Rate: 0.0922
2024-12-06 13:19:42,055 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:19:52,542 - INFO - Text classifier Epoch 35 Train Accuracies: All 0.8963 | Old 0.8706 | New 0.9097
2024-12-06 13:19:52,542 - INFO - Image classifier Epoch 35 Train Accuracies: All 0.9061 | Old 0.8791 | New 0.9203
2024-12-06 13:20:02,998 - INFO - Weighted Accuracies: All 0.9134 | Old 0.8855 | New 0.9281
2024-12-06 13:20:23,822 - INFO - len of image selected samples: 1625
2024-12-06 13:20:23,826 - INFO - len of text selected samples: 1624
2024-12-06 13:20:49,843 - INFO - Epoch 37/200, Total Loss: 3.3035, Base Loss: 1.6161, Con Loss: 1.4818, Pseudo Loss Image: 0.1022, Pseudo Loss Text: 0.1032
2024-12-06 13:20:49,844 - INFO -    Param Group: classifier_head, Learning Rate: 0.0918
2024-12-06 13:20:49,844 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:21:00,336 - INFO - Text classifier Epoch 36 Train Accuracies: All 0.8992 | Old 0.8876 | New 0.9053
2024-12-06 13:21:00,336 - INFO - Image classifier Epoch 36 Train Accuracies: All 0.9127 | Old 0.9014 | New 0.9187
2024-12-06 13:21:10,788 - INFO - Weighted Accuracies: All 0.9123 | Old 0.8993 | New 0.9192
2024-12-06 13:21:31,566 - INFO - len of image selected samples: 1626
2024-12-06 13:21:31,568 - INFO - len of text selected samples: 1624
2024-12-06 13:21:57,213 - INFO - Epoch 38/200, Total Loss: 3.4082, Base Loss: 1.6891, Con Loss: 1.5087, Pseudo Loss Image: 0.0974, Pseudo Loss Text: 0.1130
2024-12-06 13:21:57,214 - INFO -    Param Group: classifier_head, Learning Rate: 0.0914
2024-12-06 13:21:57,214 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-06 13:22:07,708 - INFO - Text classifier Epoch 37 Train Accuracies: All 0.9083 | Old 0.8950 | New 0.9153
2024-12-06 13:22:07,709 - INFO - Image classifier Epoch 37 Train Accuracies: All 0.9083 | Old 0.9024 | New 0.9114
2024-12-06 13:22:18,160 - INFO - Weighted Accuracies: All 0.9160 | Old 0.9056 | New 0.9214
2024-12-06 13:22:39,023 - INFO - len of image selected samples: 1626
2024-12-06 13:22:39,025 - INFO - len of text selected samples: 1628
