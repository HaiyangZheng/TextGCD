2024-12-06 22:55:48,613 - INFO - Training pets_lr(all/2)_seed1_pseudo(taus)_warmup(12)_align(3) with the following settings:
2024-12-06 22:55:48,613 - INFO - Command-line arguments: output_dir=exp_final_test
 experiment_name=pets_lr(all/2)_seed1_pseudo(taus)_warmup(12)_align(3)
 seed=1
 evaluate=False
 dataset_name=pets
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.00025
 classifier_lr=0.05
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=12
 class_aligning_epochs=3
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 19)
 unlabeled_classes=range(19, 37)
 num_labeled_classes=19
 num_unlabeled_classes=18
 log_path=exp_final_test/pets_lr(all/2)_seed1_pseudo(taus)_warmup(12)_align(3)-2024-12-06-22-55/logs/log.txt
 model_path=exp_final_test/pets_lr(all/2)_seed1_pseudo(taus)_warmup(12)_align(3)-2024-12-06-22-55/models/model.pth
 device=cuda
2024-12-06 22:55:48,617 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-06 22:55:51,106 - INFO - Building custom CLIP
2024-12-06 22:55:52,222 - INFO - Turning off gradients in both the image and the text encoder
2024-12-06 22:55:52,224 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-06 22:55:53,176 - INFO - len of train dataset: 3680
2024-12-06 22:55:53,176 - INFO - len of test dataset: 2738
2024-12-06 22:55:53,180 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-06 22:55:53,181 - INFO - Selecting 44 high-confidence samples for co-teaching.
2024-12-06 22:56:09,906 - INFO - Before Train Accuracies: All 0.1728 | Old 0.0329 | New 0.2462
2024-12-06 22:56:09,906 - INFO - Before Train Accuracies: All 0.1417 | Old 0.0467 | New 0.1916
2024-12-06 22:56:36,572 - INFO - Epoch 1/200, Total Loss: 8.7880, Base Loss: 6.5652, Con Loss: 2.2228, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 22:56:36,572 - INFO -    Param Group: classifier_head, Learning Rate: 0.0500
2024-12-06 22:56:36,572 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 22:56:47,020 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.5332 | Old 0.4528 | New 0.5755
2024-12-06 22:56:47,020 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.2604 | Old 0.2800 | New 0.2501
2024-12-06 22:56:57,165 - INFO - Weighted Accuracies: All 0.4445 | Old 0.3627 | New 0.4875
2024-12-06 22:56:57,763 - INFO - Saved model!
2024-12-06 22:57:23,407 - INFO - Epoch 2/200, Total Loss: 7.1285, Base Loss: 5.0271, Con Loss: 2.1014, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 22:57:23,407 - INFO -    Param Group: classifier_head, Learning Rate: 0.0500
2024-12-06 22:57:23,407 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 22:57:33,734 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.6012 | Old 0.6363 | New 0.5827
2024-12-06 22:57:33,734 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.3747 | Old 0.4274 | New 0.3471
2024-12-06 22:57:43,899 - INFO - Weighted Accuracies: All 0.5215 | Old 0.4846 | New 0.5409
2024-12-06 22:57:44,579 - INFO - Saved model!
2024-12-06 22:58:09,922 - INFO - Epoch 3/200, Total Loss: 5.8188, Base Loss: 3.7854, Con Loss: 2.0334, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 22:58:09,922 - INFO -    Param Group: classifier_head, Learning Rate: 0.0500
2024-12-06 22:58:09,923 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 22:58:20,253 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.6790 | Old 0.7953 | New 0.6178
2024-12-06 22:58:20,254 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.4313 | Old 0.4528 | New 0.4201
2024-12-06 22:58:30,598 - INFO - Weighted Accuracies: All 0.5610 | Old 0.5705 | New 0.5560
2024-12-06 22:58:31,287 - INFO - Saved model!
2024-12-06 22:58:56,816 - INFO - Epoch 4/200, Total Loss: 5.0061, Base Loss: 3.0247, Con Loss: 1.9814, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 22:58:56,817 - INFO -    Param Group: classifier_head, Learning Rate: 0.0500
2024-12-06 22:58:56,817 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 22:59:07,208 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.7140 | Old 0.8611 | New 0.6368
2024-12-06 22:59:07,208 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.4792 | Old 0.6193 | New 0.4056
2024-12-06 22:59:17,550 - INFO - Weighted Accuracies: All 0.6114 | Old 0.6829 | New 0.5738
2024-12-06 22:59:18,242 - INFO - Saved model!
2024-12-06 22:59:43,269 - INFO - Epoch 5/200, Total Loss: 4.4488, Base Loss: 2.4886, Con Loss: 1.9601, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 22:59:43,269 - INFO -    Param Group: classifier_head, Learning Rate: 0.0499
2024-12-06 22:59:43,269 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 22:59:53,414 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.7180 | Old 0.8834 | New 0.6312
2024-12-06 22:59:53,414 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.5413 | Old 0.6797 | New 0.4685
2024-12-06 23:00:03,743 - INFO - Weighted Accuracies: All 0.6308 | Old 0.7444 | New 0.5710
2024-12-06 23:00:04,423 - INFO - Saved model!
2024-12-06 23:00:30,356 - INFO - Epoch 6/200, Total Loss: 4.0716, Base Loss: 2.1402, Con Loss: 1.9314, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:00:30,356 - INFO -    Param Group: classifier_head, Learning Rate: 0.0499
2024-12-06 23:00:30,356 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:00:40,581 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.7451 | Old 0.9046 | New 0.6613
2024-12-06 23:00:40,581 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.6045 | Old 0.7593 | New 0.5231
2024-12-06 23:00:50,915 - INFO - Weighted Accuracies: All 0.6472 | Old 0.6978 | New 0.6206
2024-12-06 23:00:51,596 - INFO - Saved model!
2024-12-06 23:01:17,364 - INFO - Epoch 7/200, Total Loss: 3.8557, Base Loss: 1.9334, Con Loss: 1.9222, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:01:17,364 - INFO -    Param Group: classifier_head, Learning Rate: 0.0498
2024-12-06 23:01:17,364 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:01:27,779 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.7626 | Old 0.8547 | New 0.7142
2024-12-06 23:01:27,780 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.6297 | Old 0.8017 | New 0.5393
2024-12-06 23:01:38,135 - INFO - Weighted Accuracies: All 0.6114 | Old 0.7476 | New 0.5398
2024-12-06 23:02:03,966 - INFO - Epoch 8/200, Total Loss: 3.5948, Base Loss: 1.7202, Con Loss: 1.8746, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:02:03,966 - INFO -    Param Group: classifier_head, Learning Rate: 0.0498
2024-12-06 23:02:03,966 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:02:14,398 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.7995 | Old 0.9046 | New 0.7443
2024-12-06 23:02:14,398 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.6928 | Old 0.7932 | New 0.6401
2024-12-06 23:02:24,754 - INFO - Weighted Accuracies: All 0.6443 | Old 0.7476 | New 0.5900
2024-12-06 23:02:50,559 - INFO - Epoch 9/200, Total Loss: 3.5413, Base Loss: 1.6288, Con Loss: 1.9125, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:02:50,559 - INFO -    Param Group: classifier_head, Learning Rate: 0.0498
2024-12-06 23:02:50,560 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:03:00,520 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.8159 | Old 0.8940 | New 0.7749
2024-12-06 23:03:00,521 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.7403 | Old 0.8918 | New 0.6607
2024-12-06 23:03:10,723 - INFO - Weighted Accuracies: All 0.6234 | Old 0.7996 | New 0.5309
2024-12-06 23:03:36,160 - INFO - Epoch 10/200, Total Loss: 3.3574, Base Loss: 1.5075, Con Loss: 1.8499, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:03:36,161 - INFO -    Param Group: classifier_head, Learning Rate: 0.0497
2024-12-06 23:03:36,161 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:03:46,660 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.8090 | Old 0.8940 | New 0.7643
2024-12-06 23:03:46,660 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.7564 | Old 0.9003 | New 0.6808
2024-12-06 23:03:57,171 - INFO - Weighted Accuracies: All 0.6651 | Old 0.7476 | New 0.6217
2024-12-06 23:03:57,848 - INFO - Saved model!
2024-12-06 23:04:23,843 - INFO - Epoch 11/200, Total Loss: 3.2585, Base Loss: 1.3829, Con Loss: 1.8756, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:04:23,844 - INFO -    Param Group: classifier_head, Learning Rate: 0.0496
2024-12-06 23:04:23,844 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:04:34,143 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.8382 | Old 0.8961 | New 0.8078
2024-12-06 23:04:34,143 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.7845 | Old 0.8993 | New 0.7242
2024-12-06 23:04:44,464 - INFO - Weighted Accuracies: All 0.6815 | Old 0.7476 | New 0.6468
2024-12-06 23:04:45,162 - INFO - Saved model!
2024-12-06 23:05:10,644 - INFO - Epoch 12/200, Total Loss: 3.1526, Base Loss: 1.3094, Con Loss: 1.8432, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:05:10,645 - INFO -    Param Group: classifier_head, Learning Rate: 0.0496
2024-12-06 23:05:10,645 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:05:21,181 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.8499 | Old 0.8940 | New 0.8267
2024-12-06 23:05:21,182 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.7816 | Old 0.8791 | New 0.7304
2024-12-06 23:05:31,401 - INFO - Weighted Accuracies: All 0.6881 | Old 0.7911 | New 0.6340
2024-12-06 23:05:32,091 - INFO - Saved model!
2024-12-06 23:05:57,775 - INFO - Epoch 13/200, Total Loss: 3.1272, Base Loss: 1.2787, Con Loss: 1.8485, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 23:05:57,776 - INFO -    Param Group: classifier_head, Learning Rate: 0.0495
2024-12-06 23:05:57,776 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:06:08,126 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.8528 | Old 0.8982 | New 0.8290
2024-12-06 23:06:08,126 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.7973 | Old 0.8632 | New 0.7627
2024-12-06 23:06:18,307 - INFO - Weighted Accuracies: All 0.6914 | Old 0.7529 | New 0.6591
2024-12-06 23:06:18,997 - INFO - Saved model!
2024-12-06 23:06:29,222 - INFO - len of text selected samples: 1602
2024-12-06 23:06:54,882 - INFO - Epoch 14/200, Total Loss: 5.0313, Base Loss: 1.2681, Con Loss: 1.8349, Pseudo Loss Image: 1.9283, Pseudo Loss Text: 0.0000
2024-12-06 23:06:54,883 - INFO -    Param Group: classifier_head, Learning Rate: 0.0494
2024-12-06 23:06:54,883 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:07:05,189 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.8546 | Old 0.8812 | New 0.8407
2024-12-06 23:07:05,189 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.7725 | Old 0.9321 | New 0.6886
2024-12-06 23:07:15,709 - INFO - Weighted Accuracies: All 0.8528 | Old 0.9385 | New 0.8078
2024-12-06 23:07:16,416 - INFO - Saved model!
2024-12-06 23:07:26,703 - INFO - len of text selected samples: 1607
2024-12-06 23:07:52,453 - INFO - Epoch 15/200, Total Loss: 3.9838, Base Loss: 1.2221, Con Loss: 1.8365, Pseudo Loss Image: 0.9252, Pseudo Loss Text: 0.0000
2024-12-06 23:07:52,453 - INFO -    Param Group: classifier_head, Learning Rate: 0.0493
2024-12-06 23:07:52,454 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:08:02,951 - INFO - Text classifier Epoch 14 Train Accuracies: All 0.8568 | Old 0.8950 | New 0.8368
2024-12-06 23:08:02,951 - INFO - Image classifier Epoch 14 Train Accuracies: All 0.8605 | Old 0.9226 | New 0.8279
2024-12-06 23:08:13,253 - INFO - Weighted Accuracies: All 0.8912 | Old 0.9300 | New 0.8708
2024-12-06 23:08:13,967 - INFO - Saved model!
2024-12-06 23:08:24,289 - INFO - len of text selected samples: 1599
2024-12-06 23:08:49,609 - INFO - Epoch 16/200, Total Loss: 3.4923, Base Loss: 1.0668, Con Loss: 1.8428, Pseudo Loss Image: 0.5828, Pseudo Loss Text: 0.0000
2024-12-06 23:08:49,609 - INFO -    Param Group: classifier_head, Learning Rate: 0.0492
2024-12-06 23:08:49,609 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:08:59,838 - INFO - Text classifier Epoch 15 Train Accuracies: All 0.8503 | Old 0.8865 | New 0.8312
2024-12-06 23:08:59,839 - INFO - Image classifier Epoch 15 Train Accuracies: All 0.8776 | Old 0.9099 | New 0.8607
2024-12-06 23:09:10,130 - INFO - Weighted Accuracies: All 0.8828 | Old 0.9056 | New 0.8708
2024-12-06 23:09:30,887 - INFO - len of image selected samples: 1606
2024-12-06 23:09:30,887 - INFO - len of text selected samples: 1599
2024-12-06 23:09:56,521 - INFO - Epoch 17/200, Total Loss: 3.8196, Base Loss: 1.0905, Con Loss: 1.8358, Pseudo Loss Image: 0.4689, Pseudo Loss Text: 0.4244
2024-12-06 23:09:56,522 - INFO -    Param Group: classifier_head, Learning Rate: 0.0491
2024-12-06 23:09:56,522 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:10:07,091 - INFO - Text classifier Epoch 16 Train Accuracies: All 0.8853 | Old 0.8865 | New 0.8847
2024-12-06 23:10:07,091 - INFO - Image classifier Epoch 16 Train Accuracies: All 0.8835 | Old 0.9046 | New 0.8724
2024-12-06 23:10:17,581 - INFO - Weighted Accuracies: All 0.9021 | Old 0.9152 | New 0.8953
2024-12-06 23:10:18,280 - INFO - Saved model!
2024-12-06 23:10:38,989 - INFO - len of image selected samples: 1602
2024-12-06 23:10:38,989 - INFO - len of text selected samples: 1598
2024-12-06 23:11:04,596 - INFO - Epoch 18/200, Total Loss: 3.5087, Base Loss: 0.9818, Con Loss: 1.8123, Pseudo Loss Image: 0.3721, Pseudo Loss Text: 0.3425
2024-12-06 23:11:04,597 - INFO -    Param Group: classifier_head, Learning Rate: 0.0490
2024-12-06 23:11:04,597 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:11:15,052 - INFO - Text classifier Epoch 17 Train Accuracies: All 0.8766 | Old 0.8876 | New 0.8708
2024-12-06 23:11:15,052 - INFO - Image classifier Epoch 17 Train Accuracies: All 0.8996 | Old 0.9183 | New 0.8897
2024-12-06 23:11:25,279 - INFO - Weighted Accuracies: All 0.9018 | Old 0.9194 | New 0.8925
2024-12-06 23:11:46,124 - INFO - len of image selected samples: 1605
2024-12-06 23:11:46,125 - INFO - len of text selected samples: 1598
2024-12-06 23:12:11,725 - INFO - Epoch 19/200, Total Loss: 3.4508, Base Loss: 0.9996, Con Loss: 1.8547, Pseudo Loss Image: 0.3229, Pseudo Loss Text: 0.2736
2024-12-06 23:12:11,725 - INFO -    Param Group: classifier_head, Learning Rate: 0.0489
2024-12-06 23:12:11,725 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:12:22,184 - INFO - Text classifier Epoch 18 Train Accuracies: All 0.8820 | Old 0.8876 | New 0.8791
2024-12-06 23:12:22,184 - INFO - Image classifier Epoch 18 Train Accuracies: All 0.9043 | Old 0.9247 | New 0.8936
2024-12-06 23:12:32,500 - INFO - Weighted Accuracies: All 0.9050 | Old 0.9247 | New 0.8947
2024-12-06 23:12:33,216 - INFO - Saved model!
2024-12-06 23:12:53,826 - INFO - len of image selected samples: 1602
2024-12-06 23:12:53,827 - INFO - len of text selected samples: 1597
2024-12-06 23:13:19,647 - INFO - Epoch 20/200, Total Loss: 3.3539, Base Loss: 0.9516, Con Loss: 1.8258, Pseudo Loss Image: 0.3092, Pseudo Loss Text: 0.2673
2024-12-06 23:13:19,648 - INFO -    Param Group: classifier_head, Learning Rate: 0.0488
2024-12-06 23:13:19,648 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:13:30,028 - INFO - Text classifier Epoch 19 Train Accuracies: All 0.8850 | Old 0.8971 | New 0.8786
2024-12-06 23:13:30,028 - INFO - Image classifier Epoch 19 Train Accuracies: All 0.9087 | Old 0.9162 | New 0.9047
2024-12-06 23:13:40,512 - INFO - Weighted Accuracies: All 0.9050 | Old 0.9236 | New 0.8953
2024-12-06 23:14:01,061 - INFO - len of image selected samples: 1603
2024-12-06 23:14:01,061 - INFO - len of text selected samples: 1603
2024-12-06 23:14:26,294 - INFO - Epoch 21/200, Total Loss: 3.2936, Base Loss: 0.9705, Con Loss: 1.8286, Pseudo Loss Image: 0.2699, Pseudo Loss Text: 0.2247
2024-12-06 23:14:26,294 - INFO -    Param Group: classifier_head, Learning Rate: 0.0487
2024-12-06 23:14:26,294 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:14:36,772 - INFO - Text classifier Epoch 20 Train Accuracies: All 0.8879 | Old 0.8993 | New 0.8819
2024-12-06 23:14:36,772 - INFO - Image classifier Epoch 20 Train Accuracies: All 0.9047 | Old 0.9077 | New 0.9031
2024-12-06 23:14:47,126 - INFO - Weighted Accuracies: All 0.9065 | Old 0.9205 | New 0.8992
2024-12-06 23:14:47,810 - INFO - Saved model!
2024-12-06 23:15:08,582 - INFO - len of image selected samples: 1604
2024-12-06 23:15:08,582 - INFO - len of text selected samples: 1606
2024-12-06 23:15:34,365 - INFO - Epoch 22/200, Total Loss: 3.2766, Base Loss: 0.9658, Con Loss: 1.8052, Pseudo Loss Image: 0.2740, Pseudo Loss Text: 0.2316
2024-12-06 23:15:34,366 - INFO -    Param Group: classifier_head, Learning Rate: 0.0485
2024-12-06 23:15:34,366 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:15:44,825 - INFO - Text classifier Epoch 21 Train Accuracies: All 0.8831 | Old 0.8908 | New 0.8791
2024-12-06 23:15:44,825 - INFO - Image classifier Epoch 21 Train Accuracies: All 0.9043 | Old 0.9035 | New 0.9047
2024-12-06 23:15:55,085 - INFO - Weighted Accuracies: All 0.9050 | Old 0.9130 | New 0.9008
2024-12-06 23:16:15,486 - INFO - len of image selected samples: 1610
2024-12-06 23:16:15,487 - INFO - len of text selected samples: 1603
2024-12-06 23:16:41,497 - INFO - Epoch 23/200, Total Loss: 3.1880, Base Loss: 0.9378, Con Loss: 1.7845, Pseudo Loss Image: 0.2621, Pseudo Loss Text: 0.2035
2024-12-06 23:16:41,497 - INFO -    Param Group: classifier_head, Learning Rate: 0.0484
2024-12-06 23:16:41,497 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:16:51,855 - INFO - Text classifier Epoch 22 Train Accuracies: All 0.8831 | Old 0.8961 | New 0.8763
2024-12-06 23:16:51,855 - INFO - Image classifier Epoch 22 Train Accuracies: All 0.8996 | Old 0.9173 | New 0.8903
2024-12-06 23:17:02,243 - INFO - Weighted Accuracies: All 0.9032 | Old 0.9205 | New 0.8942
2024-12-06 23:17:22,677 - INFO - len of image selected samples: 1604
2024-12-06 23:17:22,678 - INFO - len of text selected samples: 1608
2024-12-06 23:17:48,284 - INFO - Epoch 24/200, Total Loss: 3.0871, Base Loss: 0.9204, Con Loss: 1.7637, Pseudo Loss Image: 0.2347, Pseudo Loss Text: 0.1684
2024-12-06 23:17:48,284 - INFO -    Param Group: classifier_head, Learning Rate: 0.0482
2024-12-06 23:17:48,284 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:17:58,605 - INFO - Text classifier Epoch 23 Train Accuracies: All 0.8850 | Old 0.8897 | New 0.8825
2024-12-06 23:17:58,605 - INFO - Image classifier Epoch 23 Train Accuracies: All 0.8974 | Old 0.9162 | New 0.8875
2024-12-06 23:18:08,998 - INFO - Weighted Accuracies: All 0.9039 | Old 0.9205 | New 0.8953
2024-12-06 23:18:29,733 - INFO - len of image selected samples: 1610
2024-12-06 23:18:29,733 - INFO - len of text selected samples: 1602
2024-12-06 23:18:55,403 - INFO - Epoch 25/200, Total Loss: 3.1403, Base Loss: 0.9345, Con Loss: 1.7937, Pseudo Loss Image: 0.2422, Pseudo Loss Text: 0.1700
2024-12-06 23:18:55,403 - INFO -    Param Group: classifier_head, Learning Rate: 0.0481
2024-12-06 23:18:55,403 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:19:05,810 - INFO - Text classifier Epoch 24 Train Accuracies: All 0.8871 | Old 0.8993 | New 0.8808
2024-12-06 23:19:05,811 - INFO - Image classifier Epoch 24 Train Accuracies: All 0.9014 | Old 0.9236 | New 0.8897
2024-12-06 23:19:16,206 - INFO - Weighted Accuracies: All 0.9021 | Old 0.9236 | New 0.8908
2024-12-06 23:19:36,874 - INFO - len of image selected samples: 1608
2024-12-06 23:19:36,874 - INFO - len of text selected samples: 1600
2024-12-06 23:20:02,722 - INFO - Epoch 26/200, Total Loss: 2.9890, Base Loss: 0.8627, Con Loss: 1.7701, Pseudo Loss Image: 0.2079, Pseudo Loss Text: 0.1482
2024-12-06 23:20:02,722 - INFO -    Param Group: classifier_head, Learning Rate: 0.0479
2024-12-06 23:20:02,722 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:20:12,898 - INFO - Text classifier Epoch 25 Train Accuracies: All 0.8864 | Old 0.8982 | New 0.8802
2024-12-06 23:20:12,899 - INFO - Image classifier Epoch 25 Train Accuracies: All 0.9003 | Old 0.9226 | New 0.8886
2024-12-06 23:20:23,245 - INFO - Weighted Accuracies: All 0.9021 | Old 0.9247 | New 0.8903
2024-12-06 23:20:43,908 - INFO - len of image selected samples: 1610
2024-12-06 23:20:43,909 - INFO - len of text selected samples: 1605
2024-12-06 23:21:09,513 - INFO - Epoch 27/200, Total Loss: 3.0643, Base Loss: 0.9291, Con Loss: 1.7511, Pseudo Loss Image: 0.2148, Pseudo Loss Text: 0.1694
2024-12-06 23:21:09,513 - INFO -    Param Group: classifier_head, Learning Rate: 0.0478
2024-12-06 23:21:09,513 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:21:19,696 - INFO - Text classifier Epoch 26 Train Accuracies: All 0.8860 | Old 0.9003 | New 0.8786
2024-12-06 23:21:19,696 - INFO - Image classifier Epoch 26 Train Accuracies: All 0.8996 | Old 0.9183 | New 0.8897
2024-12-06 23:21:30,078 - INFO - Weighted Accuracies: All 0.9021 | Old 0.9215 | New 0.8919
2024-12-06 23:21:50,766 - INFO - len of image selected samples: 1609
2024-12-06 23:21:50,766 - INFO - len of text selected samples: 1609
2024-12-06 23:22:16,047 - INFO - Epoch 28/200, Total Loss: 3.0948, Base Loss: 0.9442, Con Loss: 1.7561, Pseudo Loss Image: 0.2320, Pseudo Loss Text: 0.1626
2024-12-06 23:22:16,060 - INFO -    Param Group: classifier_head, Learning Rate: 0.0476
2024-12-06 23:22:16,061 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:22:26,506 - INFO - Text classifier Epoch 27 Train Accuracies: All 0.8875 | Old 0.9014 | New 0.8802
2024-12-06 23:22:26,507 - INFO - Image classifier Epoch 27 Train Accuracies: All 0.9003 | Old 0.9205 | New 0.8897
2024-12-06 23:22:36,960 - INFO - Weighted Accuracies: All 0.9014 | Old 0.9183 | New 0.8925
2024-12-06 23:22:57,617 - INFO - len of image selected samples: 1613
2024-12-06 23:22:57,617 - INFO - len of text selected samples: 1604
2024-12-06 23:23:23,701 - INFO - Epoch 29/200, Total Loss: 3.0675, Base Loss: 0.9395, Con Loss: 1.7728, Pseudo Loss Image: 0.2037, Pseudo Loss Text: 0.1515
2024-12-06 23:23:23,701 - INFO -    Param Group: classifier_head, Learning Rate: 0.0475
2024-12-06 23:23:23,701 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:23:33,905 - INFO - Text classifier Epoch 28 Train Accuracies: All 0.8864 | Old 0.8982 | New 0.8802
2024-12-06 23:23:33,906 - INFO - Image classifier Epoch 28 Train Accuracies: All 0.8996 | Old 0.9173 | New 0.8903
2024-12-06 23:23:44,067 - INFO - Weighted Accuracies: All 0.9039 | Old 0.9236 | New 0.8936
2024-12-06 23:24:04,671 - INFO - len of image selected samples: 1609
2024-12-06 23:24:04,671 - INFO - len of text selected samples: 1604
2024-12-06 23:24:30,554 - INFO - Epoch 30/200, Total Loss: 2.9968, Base Loss: 0.9186, Con Loss: 1.7338, Pseudo Loss Image: 0.1848, Pseudo Loss Text: 0.1595
2024-12-06 23:24:30,554 - INFO -    Param Group: classifier_head, Learning Rate: 0.0473
2024-12-06 23:24:30,554 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:24:40,885 - INFO - Text classifier Epoch 29 Train Accuracies: All 0.8897 | Old 0.9003 | New 0.8841
2024-12-06 23:24:40,886 - INFO - Image classifier Epoch 29 Train Accuracies: All 0.9018 | Old 0.9152 | New 0.8947
2024-12-06 23:24:51,307 - INFO - Weighted Accuracies: All 0.9014 | Old 0.9141 | New 0.8947
2024-12-06 23:25:12,455 - INFO - len of image selected samples: 1609
2024-12-06 23:25:12,456 - INFO - len of text selected samples: 1604
2024-12-06 23:25:37,903 - INFO - Epoch 31/200, Total Loss: 2.9273, Base Loss: 0.8746, Con Loss: 1.7108, Pseudo Loss Image: 0.1895, Pseudo Loss Text: 0.1525
2024-12-06 23:25:37,903 - INFO -    Param Group: classifier_head, Learning Rate: 0.0471
2024-12-06 23:25:37,903 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:25:48,174 - INFO - Text classifier Epoch 30 Train Accuracies: All 0.8908 | Old 0.9088 | New 0.8813
2024-12-06 23:25:48,174 - INFO - Image classifier Epoch 30 Train Accuracies: All 0.8999 | Old 0.9226 | New 0.8880
2024-12-06 23:25:58,497 - INFO - Weighted Accuracies: All 0.9025 | Old 0.9236 | New 0.8914
2024-12-06 23:26:19,429 - INFO - len of image selected samples: 1612
2024-12-06 23:26:19,430 - INFO - len of text selected samples: 1607
2024-12-06 23:26:45,610 - INFO - Epoch 32/200, Total Loss: 2.9438, Base Loss: 0.8962, Con Loss: 1.7245, Pseudo Loss Image: 0.1866, Pseudo Loss Text: 0.1364
2024-12-06 23:26:45,610 - INFO -    Param Group: classifier_head, Learning Rate: 0.0469
2024-12-06 23:26:45,610 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 23:26:55,579 - INFO - Text classifier Epoch 31 Train Accuracies: All 0.8952 | Old 0.9088 | New 0.8880
2024-12-06 23:26:55,580 - INFO - Image classifier Epoch 31 Train Accuracies: All 0.9028 | Old 0.9162 | New 0.8958
2024-12-06 23:27:05,979 - INFO - Weighted Accuracies: All 0.9032 | Old 0.9162 | New 0.8964
2024-12-06 23:27:26,456 - INFO - len of image selected samples: 1608
2024-12-06 23:27:26,456 - INFO - len of text selected samples: 1603
