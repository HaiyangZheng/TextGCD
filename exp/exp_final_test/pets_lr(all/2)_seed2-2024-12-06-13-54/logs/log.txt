2024-12-06 13:54:45,506 - INFO - Training pets_lr(all/2)_seed2 with the following settings:
2024-12-06 13:54:45,507 - INFO - Command-line arguments: output_dir=exp_final_test
 experiment_name=pets_lr(all/2)_seed2
 seed=2
 evaluate=False
 dataset_name=pets
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.00025
 classifier_lr=0.05
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 19)
 unlabeled_classes=range(19, 37)
 num_labeled_classes=19
 num_unlabeled_classes=18
 log_path=exp_final_test/pets_lr(all/2)_seed2-2024-12-06-13-54/logs/log.txt
 model_path=exp_final_test/pets_lr(all/2)_seed2-2024-12-06-13-54/models/model.pth
 device=cuda
2024-12-06 13:54:45,512 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-06 13:54:47,942 - INFO - Building custom CLIP
2024-12-06 13:54:49,041 - INFO - Turning off gradients in both the image and the text encoder
2024-12-06 13:54:49,043 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-06 13:54:50,027 - INFO - len of train dataset: 3680
2024-12-06 13:54:50,028 - INFO - len of test dataset: 2738
2024-12-06 13:54:50,032 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-06 13:54:50,033 - INFO - Selecting 44 high-confidence samples for co-teaching.
2024-12-06 13:55:07,182 - INFO - Before Train Accuracies: All 0.2458 | Old 0.0785 | New 0.3337
2024-12-06 13:55:07,182 - INFO - Before Train Accuracies: All 0.1486 | Old 0.0180 | New 0.2173
2024-12-06 13:55:34,835 - INFO - Epoch 1/200, Total Loss: 8.8077, Base Loss: 6.5914, Con Loss: 2.2164, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 13:55:34,836 - INFO -    Param Group: classifier_head, Learning Rate: 0.0500
2024-12-06 13:55:34,836 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 13:55:45,419 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.4985 | Old 0.3415 | New 0.5811
2024-12-06 13:55:45,419 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.2962 | Old 0.1877 | New 0.3532
2024-12-06 13:55:55,916 - INFO - Weighted Accuracies: All 0.3773 | Old 0.4062 | New 0.3621
2024-12-06 13:55:56,513 - INFO - Saved model!
2024-12-06 13:56:22,400 - INFO - Epoch 2/200, Total Loss: 7.2569, Base Loss: 5.1547, Con Loss: 2.1022, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 13:56:22,400 - INFO -    Param Group: classifier_head, Learning Rate: 0.0500
2024-12-06 13:56:22,400 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 13:56:33,015 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.6045 | Old 0.6013 | New 0.6061
2024-12-06 13:56:33,016 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.3722 | Old 0.2831 | New 0.4189
2024-12-06 13:56:43,638 - INFO - Weighted Accuracies: All 0.4993 | Old 0.5302 | New 0.4830
2024-12-06 13:56:44,365 - INFO - Saved model!
2024-12-06 13:57:10,184 - INFO - Epoch 3/200, Total Loss: 5.9409, Base Loss: 3.8924, Con Loss: 2.0485, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 13:57:10,184 - INFO -    Param Group: classifier_head, Learning Rate: 0.0500
2024-12-06 13:57:10,184 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 13:57:20,750 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.7045 | Old 0.6713 | New 0.7220
2024-12-06 13:57:20,750 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.4719 | Old 0.4146 | New 0.5019
2024-12-06 13:57:31,381 - INFO - Weighted Accuracies: All 0.5716 | Old 0.6299 | New 0.5409
2024-12-06 13:57:32,098 - INFO - Saved model!
2024-12-06 13:57:58,171 - INFO - Epoch 4/200, Total Loss: 5.0284, Base Loss: 3.0291, Con Loss: 1.9993, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 13:57:58,171 - INFO -    Param Group: classifier_head, Learning Rate: 0.0500
2024-12-06 13:57:58,171 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 13:58:08,734 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.6958 | Old 0.7572 | New 0.6635
2024-12-06 13:58:08,734 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.5457 | Old 0.5175 | New 0.5604
2024-12-06 13:58:19,371 - INFO - Weighted Accuracies: All 0.6432 | Old 0.6808 | New 0.6234
2024-12-06 13:58:20,062 - INFO - Saved model!
2024-12-06 13:58:46,105 - INFO - Epoch 5/200, Total Loss: 4.4795, Base Loss: 2.5274, Con Loss: 1.9521, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 13:58:46,105 - INFO -    Param Group: classifier_head, Learning Rate: 0.0499
2024-12-06 13:58:46,105 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 13:58:56,755 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.7330 | Old 0.8176 | New 0.6886
2024-12-06 13:58:56,755 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.5774 | Old 0.6501 | New 0.5393
2024-12-06 13:59:07,313 - INFO - Weighted Accuracies: All 0.6943 | Old 0.6872 | New 0.6981
2024-12-06 13:59:08,011 - INFO - Saved model!
2024-12-06 13:59:34,400 - INFO - Epoch 6/200, Total Loss: 3.9990, Base Loss: 2.0778, Con Loss: 1.9212, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 13:59:34,401 - INFO -    Param Group: classifier_head, Learning Rate: 0.0499
2024-12-06 13:59:34,401 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 13:59:44,982 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.7608 | Old 0.8611 | New 0.7081
2024-12-06 13:59:44,983 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.6066 | Old 0.6946 | New 0.5604
2024-12-06 13:59:55,617 - INFO - Weighted Accuracies: All 0.7345 | Old 0.6882 | New 0.7588
2024-12-06 13:59:56,305 - INFO - Saved model!
2024-12-06 14:00:22,445 - INFO - Epoch 7/200, Total Loss: 3.7926, Base Loss: 1.8678, Con Loss: 1.9249, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 14:00:22,446 - INFO -    Param Group: classifier_head, Learning Rate: 0.0498
2024-12-06 14:00:22,446 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 14:00:33,124 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.8002 | Old 0.8600 | New 0.7688
2024-12-06 14:00:33,125 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.6220 | Old 0.7720 | New 0.5432
2024-12-06 14:00:43,668 - INFO - Weighted Accuracies: All 0.7257 | Old 0.7487 | New 0.7136
2024-12-06 14:01:09,492 - INFO - Epoch 8/200, Total Loss: 3.6281, Base Loss: 1.7006, Con Loss: 1.9275, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 14:01:09,493 - INFO -    Param Group: classifier_head, Learning Rate: 0.0498
2024-12-06 14:01:09,493 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 14:01:20,085 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.8170 | Old 0.8441 | New 0.8028
2024-12-06 14:01:20,086 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.6545 | Old 0.9130 | New 0.5187
2024-12-06 14:01:30,707 - INFO - Weighted Accuracies: All 0.7330 | Old 0.7847 | New 0.7058
2024-12-06 14:01:56,990 - INFO - Epoch 9/200, Total Loss: 3.4774, Base Loss: 1.5811, Con Loss: 1.8964, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 14:01:56,990 - INFO -    Param Group: classifier_head, Learning Rate: 0.0498
2024-12-06 14:01:56,990 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 14:02:07,675 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.8214 | Old 0.9109 | New 0.7744
2024-12-06 14:02:07,675 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.6907 | Old 0.9099 | New 0.5755
2024-12-06 14:02:18,244 - INFO - Weighted Accuracies: All 0.7169 | Old 0.7826 | New 0.6825
2024-12-06 14:02:43,779 - INFO - Epoch 10/200, Total Loss: 3.3470, Base Loss: 1.4886, Con Loss: 1.8584, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 14:02:43,779 - INFO -    Param Group: classifier_head, Learning Rate: 0.0497
2024-12-06 14:02:43,780 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
2024-12-06 14:02:54,529 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.8404 | Old 0.9067 | New 0.8056
2024-12-06 14:02:54,529 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.7356 | Old 0.9056 | New 0.6462
2024-12-06 14:03:05,160 - INFO - Weighted Accuracies: All 0.7111 | Old 0.8494 | New 0.6384
2024-12-06 14:03:31,339 - INFO - Epoch 11/200, Total Loss: 3.2509, Base Loss: 1.3933, Con Loss: 1.8576, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-06 14:03:31,340 - INFO -    Param Group: classifier_head, Learning Rate: 0.0496
2024-12-06 14:03:31,340 - INFO -    Param Group: base_parameters, Learning Rate: 0.0003
