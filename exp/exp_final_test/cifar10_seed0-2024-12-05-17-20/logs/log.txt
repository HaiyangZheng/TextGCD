2024-12-05 17:20:59,863 - INFO - Training cifar10_seed0 with the following settings:
2024-12-05 17:20:59,865 - INFO - Command-line arguments: output_dir=exp_final_test
 experiment_name=cifar10_seed0
 seed=0
 evaluate=False
 dataset_name=cifar10
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.1
 tau_t_start=0.07
 tau_t_end=0.04
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 5)
 unlabeled_classes=range(5, 10)
 num_labeled_classes=5
 num_unlabeled_classes=5
 log_path=exp_final_test/cifar10_seed0-2024-12-05-17-20/logs/log.txt
 model_path=exp_final_test/cifar10_seed0-2024-12-05-17-20/models/model.pth
 device=cuda
2024-12-05 17:20:59,873 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-05 17:21:02,907 - INFO - Building custom CLIP
2024-12-05 17:21:04,061 - INFO - Turning off gradients in both the image and the text encoder
2024-12-05 17:21:04,063 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-05 17:21:09,109 - INFO - len of train dataset: 50000
2024-12-05 17:21:09,109 - INFO - len of test dataset: 37500
2024-12-05 17:21:09,121 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-05 17:21:09,122 - INFO - Selecting 2250 high-confidence samples for co-teaching.
2024-12-05 17:23:03,738 - INFO - Before Train Accuracies: All 0.2663 | Old 0.0633 | New 0.3678
2024-12-05 17:23:03,738 - INFO - Before Train Accuracies: All 0.2521 | Old 0.0063 | New 0.3750
2024-12-05 17:28:15,356 - INFO - Epoch 1/200, Total Loss: 3.5260, Base Loss: 1.4639, Con Loss: 2.0622, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 17:28:15,356 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-05 17:28:15,356 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 17:29:52,155 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.9688 | Old 0.9413 | New 0.9826
2024-12-05 17:29:52,155 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.8384 | Old 0.9063 | New 0.8044
2024-12-05 17:31:29,491 - INFO - Weighted Accuracies: All 0.8459 | Old 0.9658 | New 0.7859
2024-12-05 17:31:30,131 - INFO - Saved model!
2024-12-05 17:36:39,877 - INFO - Epoch 2/200, Total Loss: 2.5397, Base Loss: 0.6486, Con Loss: 1.8911, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 17:36:39,877 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-05 17:36:39,877 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 17:38:16,626 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.9713 | Old 0.9488 | New 0.9825
2024-12-05 17:38:16,626 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.9470 | Old 0.9310 | New 0.9550
2024-12-05 17:39:53,973 - INFO - Weighted Accuracies: All 0.8112 | Old 0.9751 | New 0.7293
2024-12-05 17:45:04,282 - INFO - Epoch 3/200, Total Loss: 2.3774, Base Loss: 0.5822, Con Loss: 1.7952, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 17:45:04,282 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-05 17:45:04,282 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 17:46:41,825 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.9702 | Old 0.9415 | New 0.9845
2024-12-05 17:46:41,826 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.9530 | Old 0.9263 | New 0.9663
2024-12-05 17:48:18,838 - INFO - Weighted Accuracies: All 0.8245 | Old 0.9715 | New 0.7510
2024-12-05 17:53:29,040 - INFO - Epoch 4/200, Total Loss: 2.2774, Base Loss: 0.5371, Con Loss: 1.7403, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 17:53:29,040 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-05 17:53:29,040 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 17:55:06,274 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.9666 | Old 0.9307 | New 0.9845
2024-12-05 17:55:06,275 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.9497 | Old 0.9168 | New 0.9661
2024-12-05 17:56:43,799 - INFO - Weighted Accuracies: All 0.8195 | Old 0.9662 | New 0.7461
2024-12-05 18:01:54,621 - INFO - Epoch 5/200, Total Loss: 2.2255, Base Loss: 0.5222, Con Loss: 1.7033, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:01:54,621 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-05 18:01:54,621 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:03:32,014 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.9697 | Old 0.9438 | New 0.9826
2024-12-05 18:03:32,015 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.9554 | Old 0.9278 | New 0.9692
2024-12-05 18:05:08,727 - INFO - Weighted Accuracies: All 0.8262 | Old 0.9712 | New 0.7537
2024-12-05 18:10:19,758 - INFO - Epoch 6/200, Total Loss: 2.1693, Base Loss: 0.5047, Con Loss: 1.6646, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:10:19,758 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-05 18:10:19,758 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:11:57,343 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.9703 | Old 0.9433 | New 0.9839
2024-12-05 18:11:57,343 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.9591 | Old 0.9289 | New 0.9743
2024-12-05 18:13:34,739 - INFO - Weighted Accuracies: All 0.8332 | Old 0.9727 | New 0.7634
2024-12-05 18:18:44,982 - INFO - Epoch 7/200, Total Loss: 2.1260, Base Loss: 0.4961, Con Loss: 1.6300, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:18:44,984 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-05 18:18:44,984 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:20:22,433 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.9690 | Old 0.9348 | New 0.9860
2024-12-05 18:20:22,434 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.9601 | Old 0.9362 | New 0.9721
2024-12-05 18:21:59,261 - INFO - Weighted Accuracies: All 0.8411 | Old 0.9738 | New 0.7747
2024-12-05 18:27:09,463 - INFO - Epoch 8/200, Total Loss: 2.0872, Base Loss: 0.4873, Con Loss: 1.5999, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:27:09,463 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-05 18:27:09,463 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:28:46,964 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.9692 | Old 0.9404 | New 0.9836
2024-12-05 18:28:46,964 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.9558 | Old 0.9318 | New 0.9678
2024-12-05 18:30:24,006 - INFO - Weighted Accuracies: All 0.8356 | Old 0.9725 | New 0.7672
2024-12-05 18:35:34,572 - INFO - Epoch 9/200, Total Loss: 2.0589, Base Loss: 0.4924, Con Loss: 1.5665, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:35:34,572 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-05 18:35:34,572 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:37:11,632 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.9706 | Old 0.9439 | New 0.9840
2024-12-05 18:37:11,634 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.9591 | Old 0.9317 | New 0.9729
2024-12-05 18:38:48,922 - INFO - Weighted Accuracies: All 0.8209 | Old 0.9758 | New 0.7435
2024-12-05 18:43:59,706 - INFO - Epoch 10/200, Total Loss: 2.0326, Base Loss: 0.4766, Con Loss: 1.5559, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:43:59,707 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-05 18:43:59,707 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:45:37,075 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.9700 | Old 0.9437 | New 0.9831
2024-12-05 18:45:37,076 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.9560 | Old 0.9388 | New 0.9646
2024-12-05 18:47:14,551 - INFO - Weighted Accuracies: All 0.8255 | Old 0.9740 | New 0.7512
2024-12-05 18:52:24,824 - INFO - Epoch 11/200, Total Loss: 2.0013, Base Loss: 0.4734, Con Loss: 1.5279, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:52:24,824 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-05 18:52:24,824 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:54:02,695 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.9725 | Old 0.9494 | New 0.9841
2024-12-05 18:54:02,695 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.9601 | Old 0.9421 | New 0.9692
2024-12-05 18:55:40,195 - INFO - Weighted Accuracies: All 0.8137 | Old 0.9794 | New 0.7308
2024-12-05 18:57:17,797 - INFO - len of text selected samples: 22500
2024-12-05 19:02:29,594 - INFO - Epoch 12/200, Total Loss: 2.1654, Base Loss: 0.4746, Con Loss: 1.5045, Pseudo Loss Image: 0.1863, Pseudo Loss Image: 0.1863
2024-12-05 19:02:29,594 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-05 19:02:29,594 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
