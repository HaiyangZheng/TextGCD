2024-12-07 13:00:03,841 - INFO - Training cifar100_seed0_memax(1) with the following settings:
2024-12-07 13:00:03,841 - INFO - Command-line arguments: output_dir=exp_final_test
 experiment_name=cifar100_seed0_memax(1)
 seed=0
 evaluate=False
 dataset_name=cifar100
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=1.0
 image_size=224
 train_classes=range(0, 80)
 unlabeled_classes=range(80, 100)
 num_labeled_classes=80
 num_unlabeled_classes=20
 log_path=exp_final_test/cifar100_seed0_memax(1)-2024-12-07-13-00/logs/log.txt
 model_path=exp_final_test/cifar100_seed0_memax(1)-2024-12-07-13-00/models/model.pth
 device=cuda
2024-12-07 13:00:03,852 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-07 13:00:06,269 - INFO - Building custom CLIP
2024-12-07 13:00:07,373 - INFO - Turning off gradients in both the image and the text encoder
2024-12-07 13:00:07,375 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 13:00:12,605 - INFO - len of train dataset: 50000
2024-12-07 13:00:12,605 - INFO - len of test dataset: 30000
2024-12-07 13:00:12,619 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 13:00:12,620 - INFO - Selecting 180 high-confidence samples for co-teaching.
2024-12-07 13:01:35,300 - INFO - Before Train Accuracies: All 0.1160 | Old 0.0548 | New 0.2383
2024-12-07 13:01:35,300 - INFO - Before Train Accuracies: All 0.0706 | Old 0.0245 | New 0.1626
2024-12-07 13:06:45,982 - INFO - Epoch 1/200, Total Loss: 6.0879, Base Loss: 4.4515, Con Loss: 1.6365, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 13:06:45,982 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 13:06:45,982 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 13:08:04,183 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.6573 | Old 0.6490 | New 0.6740
2024-12-07 13:08:04,183 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.5750 | Old 0.6137 | New 0.4976
2024-12-07 13:09:21,870 - INFO - Weighted Accuracies: All 0.6611 | Old 0.6704 | New 0.6425
2024-12-07 13:09:22,464 - INFO - Saved model!
2024-12-07 13:14:32,653 - INFO - Epoch 2/200, Total Loss: 3.6423, Base Loss: 2.1237, Con Loss: 1.5187, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 13:14:32,653 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 13:14:32,653 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 13:15:50,735 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.7222 | Old 0.7409 | New 0.6848
2024-12-07 13:15:50,735 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.6003 | Old 0.6573 | New 0.4864
2024-12-07 13:17:08,870 - INFO - Weighted Accuracies: All 0.6732 | Old 0.7246 | New 0.5706
2024-12-07 13:17:09,553 - INFO - Saved model!
2024-12-07 13:22:19,507 - INFO - Epoch 3/200, Total Loss: 3.2953, Base Loss: 1.8417, Con Loss: 1.4535, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 13:22:19,507 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 13:22:19,507 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 13:23:37,225 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.7592 | Old 0.7835 | New 0.7104
2024-12-07 13:23:37,225 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.6154 | Old 0.6982 | New 0.4498
2024-12-07 13:24:55,696 - INFO - Weighted Accuracies: All 0.6763 | Old 0.7641 | New 0.5006
2024-12-07 13:24:56,380 - INFO - Saved model!
2024-12-07 13:30:06,472 - INFO - Epoch 4/200, Total Loss: 3.0975, Base Loss: 1.6859, Con Loss: 1.4116, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 13:30:06,472 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 13:30:06,472 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 13:31:24,191 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.7623 | Old 0.7865 | New 0.7138
2024-12-07 13:31:24,191 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.6410 | Old 0.7323 | New 0.4583
2024-12-07 13:32:42,305 - INFO - Weighted Accuracies: All 0.6773 | Old 0.7884 | New 0.4551
2024-12-07 13:32:42,997 - INFO - Saved model!
2024-12-07 13:37:53,886 - INFO - Epoch 5/200, Total Loss: 2.9777, Base Loss: 1.6074, Con Loss: 1.3702, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 13:37:53,886 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 13:37:53,886 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 13:39:12,058 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.7707 | Old 0.7899 | New 0.7324
2024-12-07 13:39:12,058 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.6479 | Old 0.7586 | New 0.4265
2024-12-07 13:40:29,823 - INFO - Weighted Accuracies: All 0.6794 | Old 0.7941 | New 0.4502
2024-12-07 13:40:30,510 - INFO - Saved model!
2024-12-07 13:45:40,242 - INFO - Epoch 6/200, Total Loss: 2.9185, Base Loss: 1.5621, Con Loss: 1.3564, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 13:45:40,242 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 13:45:40,242 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 13:46:58,594 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.7760 | Old 0.7876 | New 0.7527
2024-12-07 13:46:58,595 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.6756 | Old 0.7544 | New 0.5179
2024-12-07 13:48:16,417 - INFO - Weighted Accuracies: All 0.6768 | Old 0.8023 | New 0.4257
2024-12-07 13:53:26,244 - INFO - Epoch 7/200, Total Loss: 2.8360, Base Loss: 1.5072, Con Loss: 1.3287, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 13:53:26,244 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-07 13:53:26,244 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 13:54:44,418 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.7802 | Old 0.7878 | New 0.7649
2024-12-07 13:54:44,419 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.6904 | Old 0.7630 | New 0.5452
2024-12-07 13:56:02,512 - INFO - Weighted Accuracies: All 0.6824 | Old 0.8037 | New 0.4398
2024-12-07 13:56:03,193 - INFO - Saved model!
2024-12-07 14:01:14,094 - INFO - Epoch 8/200, Total Loss: 2.7882, Base Loss: 1.4780, Con Loss: 1.3101, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 14:01:14,094 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-07 14:01:14,094 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 14:02:32,368 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.7695 | Old 0.7925 | New 0.7235
2024-12-07 14:02:32,368 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.7044 | Old 0.7782 | New 0.5568
2024-12-07 14:03:50,118 - INFO - Weighted Accuracies: All 0.6728 | Old 0.7945 | New 0.4295
2024-12-07 14:09:00,454 - INFO - Epoch 9/200, Total Loss: 2.7383, Base Loss: 1.4452, Con Loss: 1.2931, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 14:09:00,454 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-07 14:09:00,454 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 14:10:18,479 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.7743 | Old 0.7978 | New 0.7272
2024-12-07 14:10:18,479 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.7070 | Old 0.7877 | New 0.5455
2024-12-07 14:11:36,692 - INFO - Weighted Accuracies: All 0.6896 | Old 0.8034 | New 0.4619
2024-12-07 14:11:37,377 - INFO - Saved model!
2024-12-07 14:16:47,510 - INFO - Epoch 10/200, Total Loss: 2.6919, Base Loss: 1.4197, Con Loss: 1.2722, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 14:16:47,510 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-07 14:16:47,510 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 14:18:05,829 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.7750 | Old 0.8042 | New 0.7166
2024-12-07 14:18:05,829 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.7093 | Old 0.7899 | New 0.5482
2024-12-07 14:19:24,079 - INFO - Weighted Accuracies: All 0.6883 | Old 0.8069 | New 0.4510
2024-12-07 14:24:34,766 - INFO - Epoch 11/200, Total Loss: 2.6562, Base Loss: 1.3903, Con Loss: 1.2658, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 14:24:34,766 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-07 14:24:34,766 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 14:25:52,451 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.7717 | Old 0.8001 | New 0.7149
2024-12-07 14:25:52,451 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.7131 | Old 0.7923 | New 0.5547
2024-12-07 14:27:10,562 - INFO - Weighted Accuracies: All 0.6901 | Old 0.8072 | New 0.4559
2024-12-07 14:27:11,249 - INFO - Saved model!
2024-12-07 14:28:29,268 - INFO - len of text selected samples: 18000
2024-12-07 14:33:40,831 - INFO - Epoch 12/200, Total Loss: 3.4645, Base Loss: 1.3930, Con Loss: 1.2782, Pseudo Loss Image: 0.7933, Pseudo Loss Text: 0.0000
2024-12-07 14:33:40,832 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-07 14:33:40,832 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 14:34:58,826 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.7678 | Old 0.8024 | New 0.6986
2024-12-07 14:34:58,826 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.7516 | Old 0.7793 | New 0.6962
2024-12-07 14:36:17,159 - INFO - Weighted Accuracies: All 0.8024 | Old 0.8326 | New 0.7420
2024-12-07 14:36:17,860 - INFO - Saved model!
2024-12-07 14:37:35,791 - INFO - len of text selected samples: 18000
2024-12-07 14:42:46,959 - INFO - Epoch 13/200, Total Loss: 3.2280, Base Loss: 1.3674, Con Loss: 1.2615, Pseudo Loss Image: 0.5991, Pseudo Loss Text: 0.0000
2024-12-07 14:42:46,959 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-12-07 14:42:46,959 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 14:44:04,655 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.7663 | Old 0.8027 | New 0.6934
2024-12-07 14:44:04,656 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.7523 | Old 0.7850 | New 0.6871
2024-12-07 14:45:22,366 - INFO - Weighted Accuracies: All 0.7980 | Old 0.8349 | New 0.7242
2024-12-07 14:46:40,236 - INFO - len of text selected samples: 18000
2024-12-07 14:51:51,250 - INFO - Epoch 14/200, Total Loss: 3.1843, Base Loss: 1.3789, Con Loss: 1.2606, Pseudo Loss Image: 0.5449, Pseudo Loss Text: 0.0000
2024-12-07 14:51:51,250 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-12-07 14:51:51,250 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 14:53:09,704 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.7642 | Old 0.7986 | New 0.6955
2024-12-07 14:53:09,704 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.7472 | Old 0.7894 | New 0.6627
