2024-12-05 08:58:02,831 - INFO - Training cifar100_seed4 with the following settings:
2024-12-05 08:58:02,832 - INFO - Command-line arguments: output_dir=exp_final_test
 experiment_name=cifar100_seed4
 seed=4
 evaluate=False
 dataset_name=cifar100
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 80)
 unlabeled_classes=range(80, 100)
 num_labeled_classes=80
 num_unlabeled_classes=20
 log_path=exp_final_test/cifar100_seed4-2024-12-05-08-58/logs/log.txt
 model_path=exp_final_test/cifar100_seed4-2024-12-05-08-58/models/model.pth
 device=cuda
2024-12-05 08:58:02,843 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-05 08:58:05,693 - INFO - Building custom CLIP
2024-12-05 08:58:06,830 - INFO - Turning off gradients in both the image and the text encoder
2024-12-05 08:58:06,832 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-05 08:58:12,074 - INFO - len of train dataset: 50000
2024-12-05 08:58:12,074 - INFO - len of test dataset: 30000
2024-12-05 08:58:12,090 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-05 08:58:12,091 - INFO - Selecting 180 high-confidence samples for co-teaching.
2024-12-05 08:59:50,889 - INFO - Before Train Accuracies: All 0.1103 | Old 0.0539 | New 0.2229
2024-12-05 08:59:50,890 - INFO - Before Train Accuracies: All 0.0627 | Old 0.0307 | New 0.1268
2024-12-05 09:05:02,344 - INFO - Epoch 1/200, Total Loss: 6.5810, Base Loss: 4.9446, Con Loss: 1.6364, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 09:05:02,344 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-05 09:05:02,344 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 09:06:20,400 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.6765 | Old 0.7203 | New 0.5889
2024-12-05 09:06:20,400 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.5732 | Old 0.6443 | New 0.4311
2024-12-05 09:07:37,808 - INFO - Weighted Accuracies: All 0.6482 | Old 0.7504 | New 0.4439
2024-12-05 09:07:38,395 - INFO - Saved model!
2024-12-05 09:12:47,312 - INFO - Epoch 2/200, Total Loss: 4.1930, Base Loss: 2.6715, Con Loss: 1.5215, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 09:12:47,312 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-05 09:12:47,312 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 09:14:05,171 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.7121 | Old 0.7965 | New 0.5433
2024-12-05 09:14:05,171 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.6193 | Old 0.7176 | New 0.4227
2024-12-05 09:15:23,153 - INFO - Weighted Accuracies: All 0.6614 | Old 0.7840 | New 0.4163
2024-12-05 09:15:23,838 - INFO - Saved model!
2024-12-05 09:20:33,499 - INFO - Epoch 3/200, Total Loss: 3.8943, Base Loss: 2.4406, Con Loss: 1.4536, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 09:20:33,499 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-05 09:20:33,499 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 09:21:51,257 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.7243 | Old 0.7926 | New 0.5876
2024-12-05 09:21:51,257 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.6356 | Old 0.7513 | New 0.4042
2024-12-05 09:23:09,230 - INFO - Weighted Accuracies: All 0.6550 | Old 0.8006 | New 0.3637
2024-12-05 09:28:17,958 - INFO - Epoch 4/200, Total Loss: 3.7174, Base Loss: 2.3134, Con Loss: 1.4039, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 09:28:17,958 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-05 09:28:17,958 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 09:29:35,971 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.7436 | Old 0.7974 | New 0.6358
2024-12-05 09:29:35,972 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.6447 | Old 0.7408 | New 0.4527
2024-12-05 09:30:53,900 - INFO - Weighted Accuracies: All 0.6654 | Old 0.8219 | New 0.3523
2024-12-05 09:30:54,592 - INFO - Saved model!
2024-12-05 09:36:04,014 - INFO - Epoch 5/200, Total Loss: 3.6195, Base Loss: 2.2402, Con Loss: 1.3793, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 09:36:04,014 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-05 09:36:04,014 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 09:37:21,814 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.7287 | Old 0.7998 | New 0.5865
2024-12-05 09:37:21,814 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.6431 | Old 0.7528 | New 0.4237
2024-12-05 09:38:39,750 - INFO - Weighted Accuracies: All 0.6646 | Old 0.8000 | New 0.3939
2024-12-05 09:43:48,884 - INFO - Epoch 6/200, Total Loss: 3.5571, Base Loss: 2.2040, Con Loss: 1.3531, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 09:43:48,884 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-05 09:43:48,884 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 09:45:06,758 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.7381 | Old 0.8141 | New 0.5860
2024-12-05 09:45:06,759 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.6556 | Old 0.7777 | New 0.4114
2024-12-05 09:46:24,716 - INFO - Weighted Accuracies: All 0.6662 | Old 0.8171 | New 0.3643
2024-12-05 09:46:25,405 - INFO - Saved model!
2024-12-05 09:51:34,594 - INFO - Epoch 7/200, Total Loss: 3.5103, Base Loss: 2.1710, Con Loss: 1.3393, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 09:51:34,595 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-05 09:51:34,595 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 09:52:52,192 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.7207 | Old 0.8146 | New 0.5328
2024-12-05 09:52:52,192 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.6579 | Old 0.7773 | New 0.4190
2024-12-05 09:54:10,144 - INFO - Weighted Accuracies: All 0.6596 | Old 0.8243 | New 0.3302
2024-12-05 09:59:19,684 - INFO - Epoch 8/200, Total Loss: 3.4461, Base Loss: 2.1376, Con Loss: 1.3085, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 09:59:19,684 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-05 09:59:19,684 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 10:00:37,630 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.7453 | Old 0.8125 | New 0.6109
2024-12-05 10:00:37,630 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.6673 | Old 0.7785 | New 0.4449
2024-12-05 10:01:55,522 - INFO - Weighted Accuracies: All 0.6574 | Old 0.8101 | New 0.3519
2024-12-05 10:07:04,519 - INFO - Epoch 9/200, Total Loss: 3.4177, Base Loss: 2.1162, Con Loss: 1.3014, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 10:07:04,520 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-05 10:07:04,520 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 10:08:22,296 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.7197 | Old 0.8074 | New 0.5444
2024-12-05 10:08:22,296 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.6636 | Old 0.7766 | New 0.4376
2024-12-05 10:09:39,763 - INFO - Weighted Accuracies: All 0.6672 | Old 0.7823 | New 0.4370
2024-12-05 10:09:40,429 - INFO - Saved model!
2024-12-05 10:14:49,783 - INFO - Epoch 10/200, Total Loss: 3.3607, Base Loss: 2.0818, Con Loss: 1.2789, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 10:14:49,783 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-05 10:14:49,783 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 10:16:07,877 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.7365 | Old 0.8122 | New 0.5853
2024-12-05 10:16:07,877 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.6650 | Old 0.7792 | New 0.4365
2024-12-05 10:17:25,599 - INFO - Weighted Accuracies: All 0.6624 | Old 0.8058 | New 0.3756
2024-12-05 10:22:34,557 - INFO - Epoch 11/200, Total Loss: 3.3208, Base Loss: 2.0581, Con Loss: 1.2627, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 10:22:34,557 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-05 10:22:34,557 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 10:23:52,424 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.7516 | Old 0.8137 | New 0.6274
2024-12-05 10:23:52,424 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.6684 | Old 0.7885 | New 0.4281
2024-12-05 10:25:10,366 - INFO - Weighted Accuracies: All 0.6594 | Old 0.8397 | New 0.2987
2024-12-05 10:26:28,361 - INFO - len of text selected samples: 18000
2024-12-05 10:31:39,021 - INFO - Epoch 12/200, Total Loss: 4.2409, Base Loss: 2.0301, Con Loss: 1.2797, Pseudo Loss Image: 0.9310, Pseudo Loss Image: 0.9310
2024-12-05 10:31:39,021 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-05 10:31:39,021 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 10:32:57,085 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.7404 | Old 0.8158 | New 0.5897
2024-12-05 10:32:57,086 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.7472 | Old 0.8043 | New 0.6330
2024-12-05 10:34:14,567 - INFO - Weighted Accuracies: All 0.7947 | Old 0.8578 | New 0.6685
2024-12-05 10:34:15,313 - INFO - Saved model!
2024-12-05 10:35:33,456 - INFO - len of text selected samples: 18000
2024-12-05 10:40:43,207 - INFO - Epoch 13/200, Total Loss: 3.9391, Base Loss: 1.9984, Con Loss: 1.2652, Pseudo Loss Image: 0.6755, Pseudo Loss Image: 0.6755
2024-12-05 10:40:43,208 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-12-05 10:40:43,208 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 10:42:01,260 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.7303 | Old 0.8189 | New 0.5531
2024-12-05 10:42:01,260 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.7309 | Old 0.8076 | New 0.5775
2024-12-05 10:43:19,379 - INFO - Weighted Accuracies: All 0.7801 | Old 0.8592 | New 0.6217
2024-12-05 10:44:37,024 - INFO - len of text selected samples: 18000
2024-12-05 10:49:46,861 - INFO - Epoch 14/200, Total Loss: 3.8418, Base Loss: 1.9712, Con Loss: 1.2529, Pseudo Loss Image: 0.6176, Pseudo Loss Image: 0.6176
2024-12-05 10:49:46,861 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-12-05 10:49:46,861 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 10:51:04,930 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.7612 | Old 0.8115 | New 0.6606
2024-12-05 10:51:04,930 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.7416 | Old 0.8091 | New 0.6066
2024-12-05 10:52:22,871 - INFO - Weighted Accuracies: All 0.7912 | Old 0.8539 | New 0.6657
2024-12-05 10:53:40,567 - INFO - len of text selected samples: 18000
2024-12-05 10:58:50,862 - INFO - Epoch 15/200, Total Loss: 3.7889, Base Loss: 1.9745, Con Loss: 1.2425, Pseudo Loss Image: 0.5720, Pseudo Loss Image: 0.5720
2024-12-05 10:58:50,862 - INFO -    Param Group: classifier_head, Learning Rate: 0.0986
2024-12-05 10:58:50,863 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 11:00:08,998 - INFO - Text classifier Epoch 14 Train Accuracies: All 0.7653 | Old 0.8161 | New 0.6639
2024-12-05 11:00:08,998 - INFO - Image classifier Epoch 14 Train Accuracies: All 0.7676 | Old 0.8165 | New 0.6699
2024-12-05 11:01:26,513 - INFO - Weighted Accuracies: All 0.8091 | Old 0.8578 | New 0.7119
2024-12-05 11:01:27,206 - INFO - Saved model!
2024-12-05 11:02:45,358 - INFO - len of text selected samples: 18000
2024-12-05 11:07:55,665 - INFO - Epoch 16/200, Total Loss: 3.7342, Base Loss: 1.9757, Con Loss: 1.2348, Pseudo Loss Image: 0.5237, Pseudo Loss Image: 0.5237
2024-12-05 11:07:55,665 - INFO -    Param Group: classifier_head, Learning Rate: 0.0984
2024-12-05 11:07:55,665 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 11:09:13,743 - INFO - Text classifier Epoch 15 Train Accuracies: All 0.7685 | Old 0.8188 | New 0.6677
2024-12-05 11:09:13,743 - INFO - Image classifier Epoch 15 Train Accuracies: All 0.7722 | Old 0.8130 | New 0.6906
2024-12-05 11:10:31,715 - INFO - Weighted Accuracies: All 0.8158 | Old 0.8568 | New 0.7338
2024-12-05 11:10:32,417 - INFO - Saved model!
2024-12-05 11:13:08,551 - INFO - len of image selected samples: 17992
2024-12-05 11:13:08,551 - INFO - len of text selected samples: 18000
2024-12-05 11:18:18,901 - INFO - Epoch 17/200, Total Loss: 4.2359, Base Loss: 1.9250, Con Loss: 1.2396, Pseudo Loss Image: 0.5006, Pseudo Loss Image: 0.5006
2024-12-05 11:18:18,901 - INFO -    Param Group: classifier_head, Learning Rate: 0.0982
2024-12-05 11:18:18,901 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 11:19:37,145 - INFO - Text classifier Epoch 16 Train Accuracies: All 0.8037 | Old 0.8219 | New 0.7674
2024-12-05 11:19:37,145 - INFO - Image classifier Epoch 16 Train Accuracies: All 0.7637 | Old 0.8151 | New 0.6609
2024-12-05 11:20:55,225 - INFO - Weighted Accuracies: All 0.8290 | Old 0.8564 | New 0.7742
2024-12-05 11:20:55,961 - INFO - Saved model!
2024-12-05 11:23:32,362 - INFO - len of image selected samples: 18000
2024-12-05 11:23:32,362 - INFO - len of text selected samples: 18000
2024-12-05 11:28:43,224 - INFO - Epoch 18/200, Total Loss: 4.0934, Base Loss: 1.9171, Con Loss: 1.2345, Pseudo Loss Image: 0.4677, Pseudo Loss Image: 0.4677
2024-12-05 11:28:43,224 - INFO -    Param Group: classifier_head, Learning Rate: 0.0980
2024-12-05 11:28:43,225 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 11:30:01,256 - INFO - Text classifier Epoch 17 Train Accuracies: All 0.8034 | Old 0.8269 | New 0.7564
2024-12-05 11:30:01,256 - INFO - Image classifier Epoch 17 Train Accuracies: All 0.7891 | Old 0.8183 | New 0.7306
2024-12-05 11:31:19,317 - INFO - Weighted Accuracies: All 0.8296 | Old 0.8583 | New 0.7720
2024-12-05 11:31:20,002 - INFO - Saved model!
2024-12-05 11:33:56,406 - INFO - len of image selected samples: 18000
2024-12-05 11:33:56,406 - INFO - len of text selected samples: 18000
2024-12-05 11:39:08,116 - INFO - Epoch 19/200, Total Loss: 4.0511, Base Loss: 1.9080, Con Loss: 1.2227, Pseudo Loss Image: 0.4621, Pseudo Loss Image: 0.4621
2024-12-05 11:39:08,117 - INFO -    Param Group: classifier_head, Learning Rate: 0.0978
2024-12-05 11:39:08,117 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 11:40:26,185 - INFO - Text classifier Epoch 18 Train Accuracies: All 0.8169 | Old 0.8276 | New 0.7953
2024-12-05 11:40:26,186 - INFO - Image classifier Epoch 18 Train Accuracies: All 0.7904 | Old 0.8175 | New 0.7361
2024-12-05 11:41:44,325 - INFO - Weighted Accuracies: All 0.8346 | Old 0.8574 | New 0.7889
2024-12-05 11:41:45,025 - INFO - Saved model!
2024-12-05 11:44:21,999 - INFO - len of image selected samples: 18000
2024-12-05 11:44:21,999 - INFO - len of text selected samples: 18000
2024-12-05 11:49:32,844 - INFO - Epoch 20/200, Total Loss: 3.9675, Base Loss: 1.9094, Con Loss: 1.2139, Pseudo Loss Image: 0.4391, Pseudo Loss Image: 0.4391
2024-12-05 11:49:32,844 - INFO -    Param Group: classifier_head, Learning Rate: 0.0976
2024-12-05 11:49:32,844 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 11:50:50,801 - INFO - Text classifier Epoch 19 Train Accuracies: All 0.8138 | Old 0.8292 | New 0.7830
2024-12-05 11:50:50,801 - INFO - Image classifier Epoch 19 Train Accuracies: All 0.8028 | Old 0.8199 | New 0.7685
2024-12-05 11:52:08,505 - INFO - Weighted Accuracies: All 0.8288 | Old 0.8580 | New 0.7702
2024-12-05 11:54:45,005 - INFO - len of image selected samples: 17999
2024-12-05 11:54:45,005 - INFO - len of text selected samples: 18000
2024-12-05 11:59:56,012 - INFO - Epoch 21/200, Total Loss: 3.9222, Base Loss: 1.9064, Con Loss: 1.2087, Pseudo Loss Image: 0.4209, Pseudo Loss Image: 0.4209
2024-12-05 11:59:56,012 - INFO -    Param Group: classifier_head, Learning Rate: 0.0973
2024-12-05 11:59:56,012 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 12:01:14,233 - INFO - Text classifier Epoch 20 Train Accuracies: All 0.8213 | Old 0.8250 | New 0.8138
2024-12-05 12:01:14,233 - INFO - Image classifier Epoch 20 Train Accuracies: All 0.8032 | Old 0.8168 | New 0.7760
2024-12-05 12:02:32,174 - INFO - Weighted Accuracies: All 0.8392 | Old 0.8531 | New 0.8113
2024-12-05 12:02:32,879 - INFO - Saved model!
2024-12-05 12:05:09,236 - INFO - len of image selected samples: 17999
2024-12-05 12:05:09,237 - INFO - len of text selected samples: 18000
2024-12-05 12:10:20,109 - INFO - Epoch 22/200, Total Loss: 3.8621, Base Loss: 1.8939, Con Loss: 1.1985, Pseudo Loss Image: 0.4066, Pseudo Loss Image: 0.4066
2024-12-05 12:10:20,109 - INFO -    Param Group: classifier_head, Learning Rate: 0.0970
2024-12-05 12:10:20,109 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 12:11:38,027 - INFO - Text classifier Epoch 21 Train Accuracies: All 0.8236 | Old 0.8237 | New 0.8234
2024-12-05 12:11:38,027 - INFO - Image classifier Epoch 21 Train Accuracies: All 0.8014 | Old 0.8115 | New 0.7812
2024-12-05 12:12:56,077 - INFO - Weighted Accuracies: All 0.8396 | Old 0.8514 | New 0.8160
2024-12-05 12:12:56,762 - INFO - Saved model!
2024-12-05 12:15:33,392 - INFO - len of image selected samples: 18000
2024-12-05 12:15:33,392 - INFO - len of text selected samples: 18000
2024-12-05 12:20:44,769 - INFO - Epoch 23/200, Total Loss: 3.8216, Base Loss: 1.8901, Con Loss: 1.1891, Pseudo Loss Image: 0.3896, Pseudo Loss Image: 0.3896
2024-12-05 12:20:44,769 - INFO -    Param Group: classifier_head, Learning Rate: 0.0968
2024-12-05 12:20:44,769 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 12:22:02,428 - INFO - Text classifier Epoch 22 Train Accuracies: All 0.8285 | Old 0.8255 | New 0.8344
2024-12-05 12:22:02,428 - INFO - Image classifier Epoch 22 Train Accuracies: All 0.8064 | Old 0.8164 | New 0.7865
2024-12-05 12:23:20,604 - INFO - Weighted Accuracies: All 0.8375 | Old 0.8504 | New 0.8117
2024-12-05 12:25:56,815 - INFO - len of image selected samples: 18000
2024-12-05 12:25:56,816 - INFO - len of text selected samples: 18000
2024-12-05 12:31:08,325 - INFO - Epoch 24/200, Total Loss: 3.8023, Base Loss: 1.8860, Con Loss: 1.1860, Pseudo Loss Image: 0.3847, Pseudo Loss Image: 0.3847
2024-12-05 12:31:08,326 - INFO -    Param Group: classifier_head, Learning Rate: 0.0965
2024-12-05 12:31:08,326 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 12:32:26,597 - INFO - Text classifier Epoch 23 Train Accuracies: All 0.8262 | Old 0.8279 | New 0.8228
2024-12-05 12:32:26,597 - INFO - Image classifier Epoch 23 Train Accuracies: All 0.8118 | Old 0.8197 | New 0.7959
2024-12-05 12:33:44,639 - INFO - Weighted Accuracies: All 0.8471 | Old 0.8532 | New 0.8347
2024-12-05 12:33:45,346 - INFO - Saved model!
2024-12-05 12:36:21,458 - INFO - len of image selected samples: 18000
2024-12-05 12:36:21,458 - INFO - len of text selected samples: 18000
2024-12-05 12:41:32,146 - INFO - Epoch 25/200, Total Loss: 3.7729, Base Loss: 1.8863, Con Loss: 1.1808, Pseudo Loss Image: 0.3737, Pseudo Loss Image: 0.3737
2024-12-05 12:41:32,146 - INFO -    Param Group: classifier_head, Learning Rate: 0.0962
2024-12-05 12:41:32,146 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 12:42:50,286 - INFO - Text classifier Epoch 24 Train Accuracies: All 0.8287 | Old 0.8285 | New 0.8291
2024-12-05 12:42:50,286 - INFO - Image classifier Epoch 24 Train Accuracies: All 0.8070 | Old 0.8178 | New 0.7853
2024-12-05 12:44:08,384 - INFO - Weighted Accuracies: All 0.8443 | Old 0.8544 | New 0.8242
2024-12-05 12:46:44,714 - INFO - len of image selected samples: 18000
2024-12-05 12:46:44,714 - INFO - len of text selected samples: 18000
2024-12-05 12:51:56,120 - INFO - Epoch 26/200, Total Loss: 3.7448, Base Loss: 1.8857, Con Loss: 1.1750, Pseudo Loss Image: 0.3629, Pseudo Loss Image: 0.3629
2024-12-05 12:51:56,120 - INFO -    Param Group: classifier_head, Learning Rate: 0.0959
2024-12-05 12:51:56,120 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 12:53:14,333 - INFO - Text classifier Epoch 25 Train Accuracies: All 0.8294 | Old 0.8300 | New 0.8283
2024-12-05 12:53:14,333 - INFO - Image classifier Epoch 25 Train Accuracies: All 0.8133 | Old 0.8199 | New 0.8000
2024-12-05 12:54:32,477 - INFO - Weighted Accuracies: All 0.8398 | Old 0.8532 | New 0.8129
2024-12-05 12:57:07,648 - INFO - len of image selected samples: 18000
2024-12-05 12:57:07,648 - INFO - len of text selected samples: 18000
2024-12-05 13:02:19,343 - INFO - Epoch 27/200, Total Loss: 3.7199, Base Loss: 1.8935, Con Loss: 1.1700, Pseudo Loss Image: 0.3479, Pseudo Loss Image: 0.3479
2024-12-05 13:02:19,344 - INFO -    Param Group: classifier_head, Learning Rate: 0.0956
2024-12-05 13:02:19,344 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 13:03:37,533 - INFO - Text classifier Epoch 26 Train Accuracies: All 0.8329 | Old 0.8283 | New 0.8423
2024-12-05 13:03:37,533 - INFO - Image classifier Epoch 26 Train Accuracies: All 0.8091 | Old 0.8193 | New 0.7887
2024-12-05 13:04:55,535 - INFO - Weighted Accuracies: All 0.8472 | Old 0.8532 | New 0.8352
2024-12-05 13:04:56,240 - INFO - Saved model!
2024-12-05 13:07:32,134 - INFO - len of image selected samples: 18000
2024-12-05 13:07:32,134 - INFO - len of text selected samples: 18000
2024-12-05 13:12:44,400 - INFO - Epoch 28/200, Total Loss: 3.6708, Base Loss: 1.8843, Con Loss: 1.1561, Pseudo Loss Image: 0.3337, Pseudo Loss Image: 0.3337
2024-12-05 13:12:44,401 - INFO -    Param Group: classifier_head, Learning Rate: 0.0952
2024-12-05 13:12:44,401 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 13:14:02,632 - INFO - Text classifier Epoch 27 Train Accuracies: All 0.8301 | Old 0.8328 | New 0.8247
2024-12-05 13:14:02,632 - INFO - Image classifier Epoch 27 Train Accuracies: All 0.8127 | Old 0.8189 | New 0.8002
2024-12-05 13:15:20,879 - INFO - Weighted Accuracies: All 0.8450 | Old 0.8537 | New 0.8277
2024-12-05 13:17:57,040 - INFO - len of image selected samples: 18000
2024-12-05 13:17:57,040 - INFO - len of text selected samples: 18000
2024-12-05 13:23:08,096 - INFO - Epoch 29/200, Total Loss: 3.6557, Base Loss: 1.8802, Con Loss: 1.1480, Pseudo Loss Image: 0.3331, Pseudo Loss Image: 0.3331
2024-12-05 13:23:08,096 - INFO -    Param Group: classifier_head, Learning Rate: 0.0949
2024-12-05 13:23:08,096 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 13:24:26,710 - INFO - Text classifier Epoch 28 Train Accuracies: All 0.8328 | Old 0.8319 | New 0.8345
2024-12-05 13:24:26,710 - INFO - Image classifier Epoch 28 Train Accuracies: All 0.8116 | Old 0.8199 | New 0.7951
2024-12-05 13:25:44,994 - INFO - Weighted Accuracies: All 0.8409 | Old 0.8525 | New 0.8178
2024-12-05 13:28:22,868 - INFO - len of image selected samples: 18000
2024-12-05 13:28:22,879 - INFO - len of text selected samples: 18000
2024-12-05 13:33:33,934 - INFO - Epoch 30/200, Total Loss: 3.6432, Base Loss: 1.8726, Con Loss: 1.1481, Pseudo Loss Image: 0.3338, Pseudo Loss Image: 0.3338
2024-12-05 13:33:33,949 - INFO -    Param Group: classifier_head, Learning Rate: 0.0946
2024-12-05 13:33:33,949 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 13:34:52,051 - INFO - Text classifier Epoch 29 Train Accuracies: All 0.8319 | Old 0.8321 | New 0.8315
2024-12-05 13:34:52,052 - INFO - Image classifier Epoch 29 Train Accuracies: All 0.8150 | Old 0.8233 | New 0.7984
2024-12-05 13:36:10,203 - INFO - Weighted Accuracies: All 0.8457 | Old 0.8540 | New 0.8292
2024-12-05 13:38:46,187 - INFO - len of image selected samples: 18000
2024-12-05 13:38:46,187 - INFO - len of text selected samples: 18000
2024-12-05 13:43:57,685 - INFO - Epoch 31/200, Total Loss: 3.6204, Base Loss: 1.8850, Con Loss: 1.1386, Pseudo Loss Image: 0.3113, Pseudo Loss Image: 0.3113
2024-12-05 13:43:57,685 - INFO -    Param Group: classifier_head, Learning Rate: 0.0942
2024-12-05 13:43:57,685 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 13:45:15,509 - INFO - Text classifier Epoch 30 Train Accuracies: All 0.8337 | Old 0.8330 | New 0.8350
2024-12-05 13:45:15,509 - INFO - Image classifier Epoch 30 Train Accuracies: All 0.8119 | Old 0.8220 | New 0.7916
2024-12-05 13:46:33,567 - INFO - Weighted Accuracies: All 0.8463 | Old 0.8544 | New 0.8300
2024-12-05 13:49:09,831 - INFO - len of image selected samples: 18000
2024-12-05 13:49:09,835 - INFO - len of text selected samples: 18000
2024-12-05 13:54:20,439 - INFO - Epoch 32/200, Total Loss: 3.5939, Base Loss: 1.8666, Con Loss: 1.1369, Pseudo Loss Image: 0.3149, Pseudo Loss Image: 0.3149
2024-12-05 13:54:20,440 - INFO -    Param Group: classifier_head, Learning Rate: 0.0938
2024-12-05 13:54:20,440 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 13:55:38,606 - INFO - Text classifier Epoch 31 Train Accuracies: All 0.8329 | Old 0.8327 | New 0.8334
2024-12-05 13:55:38,606 - INFO - Image classifier Epoch 31 Train Accuracies: All 0.8149 | Old 0.8264 | New 0.7920
2024-12-05 13:56:56,697 - INFO - Weighted Accuracies: All 0.8439 | Old 0.8541 | New 0.8235
2024-12-05 13:59:33,180 - INFO - len of image selected samples: 18000
2024-12-05 13:59:33,180 - INFO - len of text selected samples: 18000
