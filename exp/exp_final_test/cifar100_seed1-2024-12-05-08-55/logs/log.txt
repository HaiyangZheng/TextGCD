2024-12-05 08:55:52,242 - INFO - Training cifar100_seed1 with the following settings:
2024-12-05 08:55:52,242 - INFO - Command-line arguments: output_dir=exp_final_test
 experiment_name=cifar100_seed1
 seed=1
 evaluate=False
 dataset_name=cifar100
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 80)
 unlabeled_classes=range(80, 100)
 num_labeled_classes=80
 num_unlabeled_classes=20
 log_path=exp_final_test/cifar100_seed1-2024-12-05-08-55/logs/log.txt
 model_path=exp_final_test/cifar100_seed1-2024-12-05-08-55/models/model.pth
 device=cuda
2024-12-05 08:55:52,253 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-05 08:55:54,313 - INFO - Building custom CLIP
2024-12-05 08:55:55,482 - INFO - Turning off gradients in both the image and the text encoder
2024-12-05 08:55:55,484 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-05 08:56:00,959 - INFO - len of train dataset: 50000
2024-12-05 08:56:00,959 - INFO - len of test dataset: 30000
2024-12-05 08:56:00,967 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-05 08:56:00,968 - INFO - Selecting 180 high-confidence samples for co-teaching.
2024-12-05 08:57:22,517 - INFO - Before Train Accuracies: All 0.1178 | Old 0.0654 | New 0.2225
2024-12-05 08:57:22,517 - INFO - Before Train Accuracies: All 0.0723 | Old 0.0168 | New 0.1835
2024-12-05 09:02:35,684 - INFO - Epoch 1/200, Total Loss: 6.6268, Base Loss: 4.9867, Con Loss: 1.6401, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 09:02:35,685 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-05 09:02:35,685 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 09:03:54,802 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.6864 | Old 0.7512 | New 0.5567
2024-12-05 09:03:54,802 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.5579 | Old 0.6576 | New 0.3586
2024-12-05 09:05:13,874 - INFO - Weighted Accuracies: All 0.6577 | Old 0.7166 | New 0.5401
2024-12-05 09:05:14,522 - INFO - Saved model!
2024-12-05 09:10:27,266 - INFO - Epoch 2/200, Total Loss: 4.2282, Base Loss: 2.6987, Con Loss: 1.5295, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 09:10:27,266 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-05 09:10:27,266 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 09:11:46,124 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.7036 | Old 0.7859 | New 0.5389
2024-12-05 09:11:46,124 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.6001 | Old 0.6887 | New 0.4229
2024-12-05 09:13:05,371 - INFO - Weighted Accuracies: All 0.6502 | Old 0.7501 | New 0.4503
2024-12-05 09:18:18,029 - INFO - Epoch 3/200, Total Loss: 3.8888, Base Loss: 2.4365, Con Loss: 1.4522, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 09:18:18,029 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-05 09:18:18,029 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 09:19:37,017 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.7182 | Old 0.8124 | New 0.5299
2024-12-05 09:19:37,017 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.6060 | Old 0.7460 | New 0.3261
2024-12-05 09:20:56,312 - INFO - Weighted Accuracies: All 0.6590 | Old 0.7783 | New 0.4204
2024-12-05 09:20:57,095 - INFO - Saved model!
2024-12-05 09:26:09,964 - INFO - Epoch 4/200, Total Loss: 3.7261, Base Loss: 2.3185, Con Loss: 1.4077, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 09:26:09,964 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-05 09:26:09,964 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 09:27:29,342 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.7123 | Old 0.7993 | New 0.5385
2024-12-05 09:27:29,342 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.6245 | Old 0.7541 | New 0.3652
2024-12-05 09:28:48,189 - INFO - Weighted Accuracies: All 0.6562 | Old 0.7853 | New 0.3981
2024-12-05 09:34:00,876 - INFO - Epoch 5/200, Total Loss: 3.6525, Base Loss: 2.2726, Con Loss: 1.3799, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 09:34:00,876 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-05 09:34:00,876 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 09:35:20,172 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.7045 | Old 0.8127 | New 0.4881
2024-12-05 09:35:20,172 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.6276 | Old 0.7617 | New 0.3595
2024-12-05 09:36:39,234 - INFO - Weighted Accuracies: All 0.6510 | Old 0.7967 | New 0.3597
2024-12-05 09:41:52,256 - INFO - Epoch 6/200, Total Loss: 3.5549, Base Loss: 2.2087, Con Loss: 1.3462, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 09:41:52,256 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-05 09:41:52,256 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 09:43:11,498 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.7080 | Old 0.8119 | New 0.5000
2024-12-05 09:43:11,498 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.6424 | Old 0.7658 | New 0.3955
2024-12-05 09:44:30,759 - INFO - Weighted Accuracies: All 0.6472 | Old 0.7926 | New 0.3562
2024-12-05 09:49:43,103 - INFO - Epoch 7/200, Total Loss: 3.5093, Base Loss: 2.1757, Con Loss: 1.3336, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 09:49:43,103 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-05 09:49:43,103 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 09:51:02,466 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.7238 | Old 0.8125 | New 0.5465
2024-12-05 09:51:02,466 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.6563 | Old 0.7768 | New 0.4153
2024-12-05 09:52:22,015 - INFO - Weighted Accuracies: All 0.6498 | Old 0.7957 | New 0.3578
2024-12-05 09:57:34,008 - INFO - Epoch 8/200, Total Loss: 3.4486, Base Loss: 2.1365, Con Loss: 1.3121, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 09:57:34,008 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-05 09:57:34,008 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 09:58:53,270 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.7150 | Old 0.8168 | New 0.5112
2024-12-05 09:58:53,270 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.6656 | Old 0.7768 | New 0.4434
2024-12-05 10:00:12,128 - INFO - Weighted Accuracies: All 0.6453 | Old 0.8142 | New 0.3075
2024-12-05 10:05:24,490 - INFO - Epoch 9/200, Total Loss: 3.3948, Base Loss: 2.1025, Con Loss: 1.2923, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 10:05:24,491 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-05 10:05:24,491 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 10:06:43,612 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.7308 | Old 0.8238 | New 0.5448
2024-12-05 10:06:43,612 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.6723 | Old 0.7880 | New 0.4411
2024-12-05 10:08:02,985 - INFO - Weighted Accuracies: All 0.6428 | Old 0.8157 | New 0.2969
2024-12-05 10:13:15,345 - INFO - Epoch 10/200, Total Loss: 3.3658, Base Loss: 2.0801, Con Loss: 1.2857, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 10:13:15,345 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-05 10:13:15,345 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 10:14:34,170 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.7199 | Old 0.8212 | New 0.5173
2024-12-05 10:14:34,171 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.6706 | Old 0.7907 | New 0.4302
2024-12-05 10:15:52,981 - INFO - Weighted Accuracies: All 0.6460 | Old 0.7831 | New 0.3718
2024-12-05 10:21:05,912 - INFO - Epoch 11/200, Total Loss: 3.3340, Base Loss: 2.0616, Con Loss: 1.2725, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 10:21:05,912 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-05 10:21:05,913 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 10:22:24,760 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.7157 | Old 0.8176 | New 0.5117
2024-12-05 10:22:24,761 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.6830 | Old 0.7917 | New 0.4655
2024-12-05 10:23:43,561 - INFO - Weighted Accuracies: All 0.6419 | Old 0.8145 | New 0.2967
2024-12-05 10:25:02,520 - INFO - len of text selected samples: 18000
2024-12-05 10:30:14,382 - INFO - Epoch 12/200, Total Loss: 4.2420, Base Loss: 2.0224, Con Loss: 1.2776, Pseudo Loss Image: 0.9419, Pseudo Loss Image: 0.9419
2024-12-05 10:30:14,383 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-05 10:30:14,383 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 10:31:33,572 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.7167 | Old 0.8138 | New 0.5225
2024-12-05 10:31:33,573 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.7216 | Old 0.7944 | New 0.5760
2024-12-05 10:32:52,366 - INFO - Weighted Accuracies: All 0.7717 | Old 0.8535 | New 0.6081
2024-12-05 10:32:53,126 - INFO - Saved model!
2024-12-05 10:34:12,440 - INFO - len of text selected samples: 18000
2024-12-05 10:39:25,463 - INFO - Epoch 13/200, Total Loss: 3.9387, Base Loss: 1.9925, Con Loss: 1.2678, Pseudo Loss Image: 0.6784, Pseudo Loss Image: 0.6784
2024-12-05 10:39:25,463 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-12-05 10:39:25,463 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 10:40:44,015 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.7376 | Old 0.8192 | New 0.5744
2024-12-05 10:40:44,016 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.7314 | Old 0.7967 | New 0.6007
2024-12-05 10:42:03,021 - INFO - Weighted Accuracies: All 0.7783 | Old 0.8449 | New 0.6450
2024-12-05 10:42:03,784 - INFO - Saved model!
2024-12-05 10:43:22,586 - INFO - len of text selected samples: 18000
2024-12-05 10:48:35,942 - INFO - Epoch 14/200, Total Loss: 3.8390, Base Loss: 1.9853, Con Loss: 1.2468, Pseudo Loss Image: 0.6069, Pseudo Loss Image: 0.6069
2024-12-05 10:48:35,942 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-12-05 10:48:35,942 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 10:49:55,173 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.7428 | Old 0.8184 | New 0.5917
2024-12-05 10:49:55,174 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.7442 | Old 0.8077 | New 0.6173
2024-12-05 10:51:14,135 - INFO - Weighted Accuracies: All 0.7933 | Old 0.8552 | New 0.6696
2024-12-05 10:51:14,838 - INFO - Saved model!
2024-12-05 10:52:33,997 - INFO - len of text selected samples: 18000
2024-12-05 10:57:47,277 - INFO - Epoch 15/200, Total Loss: 3.7803, Base Loss: 1.9712, Con Loss: 1.2398, Pseudo Loss Image: 0.5693, Pseudo Loss Image: 0.5693
2024-12-05 10:57:47,277 - INFO -    Param Group: classifier_head, Learning Rate: 0.0986
2024-12-05 10:57:47,277 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 10:59:06,487 - INFO - Text classifier Epoch 14 Train Accuracies: All 0.7605 | Old 0.8251 | New 0.6313
2024-12-05 10:59:06,487 - INFO - Image classifier Epoch 14 Train Accuracies: All 0.7483 | Old 0.8032 | New 0.6384
2024-12-05 11:00:25,287 - INFO - Weighted Accuracies: All 0.8005 | Old 0.8458 | New 0.7098
2024-12-05 11:00:26,014 - INFO - Saved model!
2024-12-05 11:01:44,752 - INFO - len of text selected samples: 18000
2024-12-05 11:06:58,032 - INFO - Epoch 16/200, Total Loss: 3.7209, Base Loss: 1.9640, Con Loss: 1.2263, Pseudo Loss Image: 0.5306, Pseudo Loss Image: 0.5306
2024-12-05 11:06:58,033 - INFO -    Param Group: classifier_head, Learning Rate: 0.0984
2024-12-05 11:06:58,033 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 11:08:17,044 - INFO - Text classifier Epoch 15 Train Accuracies: All 0.7505 | Old 0.8198 | New 0.6120
2024-12-05 11:08:17,045 - INFO - Image classifier Epoch 15 Train Accuracies: All 0.7633 | Old 0.8073 | New 0.6754
2024-12-05 11:09:35,778 - INFO - Weighted Accuracies: All 0.8024 | Old 0.8568 | New 0.6937
2024-12-05 11:09:36,487 - INFO - Saved model!
2024-12-05 11:12:14,584 - INFO - len of image selected samples: 18000
2024-12-05 11:12:14,585 - INFO - len of text selected samples: 18000
2024-12-05 11:17:28,889 - INFO - Epoch 17/200, Total Loss: 4.2603, Base Loss: 1.9239, Con Loss: 1.2348, Pseudo Loss Image: 0.5265, Pseudo Loss Image: 0.5265
2024-12-05 11:17:28,889 - INFO -    Param Group: classifier_head, Learning Rate: 0.0982
2024-12-05 11:17:28,889 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 11:18:48,013 - INFO - Text classifier Epoch 16 Train Accuracies: All 0.7997 | Old 0.8175 | New 0.7642
2024-12-05 11:18:48,014 - INFO - Image classifier Epoch 16 Train Accuracies: All 0.7541 | Old 0.8172 | New 0.6281
2024-12-05 11:20:06,898 - INFO - Weighted Accuracies: All 0.8173 | Old 0.8494 | New 0.7530
2024-12-05 11:20:07,649 - INFO - Saved model!
2024-12-05 11:22:46,039 - INFO - len of image selected samples: 18000
2024-12-05 11:22:46,039 - INFO - len of text selected samples: 18000
2024-12-05 11:27:59,933 - INFO - Epoch 18/200, Total Loss: 4.1323, Base Loss: 1.9125, Con Loss: 1.2384, Pseudo Loss Image: 0.4933, Pseudo Loss Image: 0.4933
2024-12-05 11:27:59,934 - INFO -    Param Group: classifier_head, Learning Rate: 0.0980
2024-12-05 11:27:59,934 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 11:29:18,733 - INFO - Text classifier Epoch 17 Train Accuracies: All 0.7914 | Old 0.8247 | New 0.7247
2024-12-05 11:29:18,733 - INFO - Image classifier Epoch 17 Train Accuracies: All 0.7804 | Old 0.8055 | New 0.7302
2024-12-05 11:30:37,769 - INFO - Weighted Accuracies: All 0.8093 | Old 0.8498 | New 0.7283
2024-12-05 11:33:15,351 - INFO - len of image selected samples: 18000
2024-12-05 11:33:15,351 - INFO - len of text selected samples: 18000
2024-12-05 11:38:29,500 - INFO - Epoch 19/200, Total Loss: 4.0644, Base Loss: 1.9128, Con Loss: 1.2295, Pseudo Loss Image: 0.4755, Pseudo Loss Image: 0.4755
2024-12-05 11:38:29,501 - INFO -    Param Group: classifier_head, Learning Rate: 0.0978
2024-12-05 11:38:29,501 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 11:39:48,661 - INFO - Text classifier Epoch 18 Train Accuracies: All 0.7995 | Old 0.8235 | New 0.7514
2024-12-05 11:39:48,662 - INFO - Image classifier Epoch 18 Train Accuracies: All 0.7760 | Old 0.8049 | New 0.7183
2024-12-05 11:41:07,272 - INFO - Weighted Accuracies: All 0.8182 | Old 0.8514 | New 0.7518
2024-12-05 11:41:08,022 - INFO - Saved model!
2024-12-05 11:43:46,189 - INFO - len of image selected samples: 18000
2024-12-05 11:43:46,189 - INFO - len of text selected samples: 18000
2024-12-05 11:48:59,993 - INFO - Epoch 20/200, Total Loss: 4.0093, Base Loss: 1.9072, Con Loss: 1.2147, Pseudo Loss Image: 0.4543, Pseudo Loss Image: 0.4543
2024-12-05 11:48:59,993 - INFO -    Param Group: classifier_head, Learning Rate: 0.0976
2024-12-05 11:48:59,993 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 11:50:19,274 - INFO - Text classifier Epoch 19 Train Accuracies: All 0.8006 | Old 0.8345 | New 0.7329
2024-12-05 11:50:19,274 - INFO - Image classifier Epoch 19 Train Accuracies: All 0.7879 | Old 0.8122 | New 0.7395
2024-12-05 11:51:38,474 - INFO - Weighted Accuracies: All 0.8184 | Old 0.8546 | New 0.7461
2024-12-05 11:51:39,206 - INFO - Saved model!
2024-12-05 11:54:16,769 - INFO - len of image selected samples: 18000
2024-12-05 11:54:16,769 - INFO - len of text selected samples: 18000
2024-12-05 11:59:30,203 - INFO - Epoch 21/200, Total Loss: 3.9463, Base Loss: 1.9128, Con Loss: 1.2131, Pseudo Loss Image: 0.4287, Pseudo Loss Image: 0.4287
2024-12-05 11:59:30,204 - INFO -    Param Group: classifier_head, Learning Rate: 0.0973
2024-12-05 11:59:30,204 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 12:00:48,965 - INFO - Text classifier Epoch 20 Train Accuracies: All 0.8071 | Old 0.8270 | New 0.7672
2024-12-05 12:00:48,965 - INFO - Image classifier Epoch 20 Train Accuracies: All 0.7863 | Old 0.8256 | New 0.7077
2024-12-05 12:02:08,180 - INFO - Weighted Accuracies: All 0.8221 | Old 0.8557 | New 0.7549
2024-12-05 12:02:08,917 - INFO - Saved model!
2024-12-05 12:04:47,108 - INFO - len of image selected samples: 18000
2024-12-05 12:04:47,108 - INFO - len of text selected samples: 18000
2024-12-05 12:10:00,977 - INFO - Epoch 22/200, Total Loss: 3.8790, Base Loss: 1.9024, Con Loss: 1.1987, Pseudo Loss Image: 0.4037, Pseudo Loss Image: 0.4037
2024-12-05 12:10:00,977 - INFO -    Param Group: classifier_head, Learning Rate: 0.0970
2024-12-05 12:10:00,977 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 12:11:20,092 - INFO - Text classifier Epoch 21 Train Accuracies: All 0.8123 | Old 0.8308 | New 0.7752
2024-12-05 12:11:20,092 - INFO - Image classifier Epoch 21 Train Accuracies: All 0.7913 | Old 0.8166 | New 0.7407
2024-12-05 12:12:39,050 - INFO - Weighted Accuracies: All 0.8212 | Old 0.8565 | New 0.7507
2024-12-05 12:15:17,060 - INFO - len of image selected samples: 18000
2024-12-05 12:15:17,061 - INFO - len of text selected samples: 18000
2024-12-05 12:20:30,789 - INFO - Epoch 23/200, Total Loss: 3.8549, Base Loss: 1.8937, Con Loss: 1.1941, Pseudo Loss Image: 0.3974, Pseudo Loss Image: 0.3974
2024-12-05 12:20:30,791 - INFO -    Param Group: classifier_head, Learning Rate: 0.0968
2024-12-05 12:20:30,791 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 12:21:49,412 - INFO - Text classifier Epoch 22 Train Accuracies: All 0.8113 | Old 0.8305 | New 0.7729
2024-12-05 12:21:49,412 - INFO - Image classifier Epoch 22 Train Accuracies: All 0.7907 | Old 0.8235 | New 0.7252
2024-12-05 12:23:08,207 - INFO - Weighted Accuracies: All 0.8234 | Old 0.8591 | New 0.7521
2024-12-05 12:23:08,922 - INFO - Saved model!
2024-12-05 12:25:47,083 - INFO - len of image selected samples: 18000
2024-12-05 12:25:47,083 - INFO - len of text selected samples: 18000
2024-12-05 12:31:00,399 - INFO - Epoch 24/200, Total Loss: 3.7946, Base Loss: 1.8846, Con Loss: 1.1776, Pseudo Loss Image: 0.3827, Pseudo Loss Image: 0.3827
2024-12-05 12:31:00,400 - INFO -    Param Group: classifier_head, Learning Rate: 0.0965
2024-12-05 12:31:00,400 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 12:32:19,162 - INFO - Text classifier Epoch 23 Train Accuracies: All 0.8108 | Old 0.8306 | New 0.7713
2024-12-05 12:32:19,162 - INFO - Image classifier Epoch 23 Train Accuracies: All 0.7977 | Old 0.8196 | New 0.7541
2024-12-05 12:33:38,332 - INFO - Weighted Accuracies: All 0.8237 | Old 0.8550 | New 0.7611
2024-12-05 12:33:39,050 - INFO - Saved model!
2024-12-05 12:36:17,163 - INFO - len of image selected samples: 18000
2024-12-05 12:36:17,163 - INFO - len of text selected samples: 18000
2024-12-05 12:41:31,557 - INFO - Epoch 25/200, Total Loss: 3.7911, Base Loss: 1.8939, Con Loss: 1.1713, Pseudo Loss Image: 0.3743, Pseudo Loss Image: 0.3743
2024-12-05 12:41:31,557 - INFO -    Param Group: classifier_head, Learning Rate: 0.0962
2024-12-05 12:41:31,557 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 12:42:50,665 - INFO - Text classifier Epoch 24 Train Accuracies: All 0.8189 | Old 0.8326 | New 0.7915
2024-12-05 12:42:50,666 - INFO - Image classifier Epoch 24 Train Accuracies: All 0.7896 | Old 0.8202 | New 0.7285
2024-12-05 12:44:09,900 - INFO - Weighted Accuracies: All 0.8282 | Old 0.8569 | New 0.7708
2024-12-05 12:44:10,612 - INFO - Saved model!
2024-12-05 12:46:48,664 - INFO - len of image selected samples: 18000
2024-12-05 12:46:48,664 - INFO - len of text selected samples: 18000
2024-12-05 12:52:02,657 - INFO - Epoch 26/200, Total Loss: 3.7563, Base Loss: 1.8882, Con Loss: 1.1700, Pseudo Loss Image: 0.3649, Pseudo Loss Image: 0.3649
2024-12-05 12:52:02,657 - INFO -    Param Group: classifier_head, Learning Rate: 0.0959
2024-12-05 12:52:02,657 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 12:53:21,519 - INFO - Text classifier Epoch 25 Train Accuracies: All 0.8125 | Old 0.8356 | New 0.7663
2024-12-05 12:53:21,519 - INFO - Image classifier Epoch 25 Train Accuracies: All 0.7976 | Old 0.8232 | New 0.7466
2024-12-05 12:54:40,217 - INFO - Weighted Accuracies: All 0.8219 | Old 0.8586 | New 0.7484
2024-12-05 12:57:18,143 - INFO - len of image selected samples: 18000
2024-12-05 12:57:18,143 - INFO - len of text selected samples: 18000
2024-12-05 13:02:31,169 - INFO - Epoch 27/200, Total Loss: 3.7169, Base Loss: 1.8808, Con Loss: 1.1583, Pseudo Loss Image: 0.3504, Pseudo Loss Image: 0.3504
2024-12-05 13:02:31,169 - INFO -    Param Group: classifier_head, Learning Rate: 0.0956
2024-12-05 13:02:31,169 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 13:03:50,273 - INFO - Text classifier Epoch 26 Train Accuracies: All 0.8174 | Old 0.8350 | New 0.7821
2024-12-05 13:03:50,273 - INFO - Image classifier Epoch 26 Train Accuracies: All 0.7946 | Old 0.8263 | New 0.7311
2024-12-05 13:05:09,482 - INFO - Weighted Accuracies: All 0.8243 | Old 0.8590 | New 0.7549
2024-12-05 13:07:47,543 - INFO - len of image selected samples: 18000
2024-12-05 13:07:47,544 - INFO - len of text selected samples: 18000
2024-12-05 13:13:01,473 - INFO - Epoch 28/200, Total Loss: 3.7111, Base Loss: 1.8765, Con Loss: 1.1608, Pseudo Loss Image: 0.3539, Pseudo Loss Image: 0.3539
2024-12-05 13:13:01,473 - INFO -    Param Group: classifier_head, Learning Rate: 0.0952
2024-12-05 13:13:01,473 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 13:14:20,389 - INFO - Text classifier Epoch 27 Train Accuracies: All 0.8156 | Old 0.8361 | New 0.7745
2024-12-05 13:14:20,389 - INFO - Image classifier Epoch 27 Train Accuracies: All 0.7930 | Old 0.8252 | New 0.7287
2024-12-05 13:15:39,532 - INFO - Weighted Accuracies: All 0.8224 | Old 0.8579 | New 0.7512
2024-12-05 13:18:17,078 - INFO - len of image selected samples: 18000
2024-12-05 13:18:17,079 - INFO - len of text selected samples: 18000
2024-12-05 13:23:30,713 - INFO - Epoch 29/200, Total Loss: 3.6531, Base Loss: 1.8678, Con Loss: 1.1545, Pseudo Loss Image: 0.3276, Pseudo Loss Image: 0.3276
2024-12-05 13:23:30,713 - INFO -    Param Group: classifier_head, Learning Rate: 0.0949
2024-12-05 13:23:30,713 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 13:24:50,112 - INFO - Text classifier Epoch 28 Train Accuracies: All 0.8168 | Old 0.8366 | New 0.7773
2024-12-05 13:24:50,112 - INFO - Image classifier Epoch 28 Train Accuracies: All 0.7985 | Old 0.8268 | New 0.7418
2024-12-05 13:26:09,263 - INFO - Weighted Accuracies: All 0.8291 | Old 0.8582 | New 0.7707
2024-12-05 13:26:10,000 - INFO - Saved model!
2024-12-05 13:28:49,378 - INFO - len of image selected samples: 18000
2024-12-05 13:28:49,381 - INFO - len of text selected samples: 18000
2024-12-05 13:34:02,726 - INFO - Epoch 30/200, Total Loss: 3.6515, Base Loss: 1.8652, Con Loss: 1.1491, Pseudo Loss Image: 0.3231, Pseudo Loss Image: 0.3231
2024-12-05 13:34:02,734 - INFO -    Param Group: classifier_head, Learning Rate: 0.0946
2024-12-05 13:34:02,734 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 13:35:21,815 - INFO - Text classifier Epoch 29 Train Accuracies: All 0.8150 | Old 0.8468 | New 0.7514
2024-12-05 13:35:21,815 - INFO - Image classifier Epoch 29 Train Accuracies: All 0.8009 | Old 0.8281 | New 0.7466
2024-12-05 13:36:41,108 - INFO - Weighted Accuracies: All 0.8233 | Old 0.8588 | New 0.7522
2024-12-05 13:39:19,008 - INFO - len of image selected samples: 18000
2024-12-05 13:39:19,008 - INFO - len of text selected samples: 18000
2024-12-05 13:44:32,628 - INFO - Epoch 31/200, Total Loss: 3.6192, Base Loss: 1.8512, Con Loss: 1.1427, Pseudo Loss Image: 0.3205, Pseudo Loss Image: 0.3205
2024-12-05 13:44:32,628 - INFO -    Param Group: classifier_head, Learning Rate: 0.0942
2024-12-05 13:44:32,628 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 13:45:51,749 - INFO - Text classifier Epoch 30 Train Accuracies: All 0.8184 | Old 0.8356 | New 0.7842
2024-12-05 13:45:51,750 - INFO - Image classifier Epoch 30 Train Accuracies: All 0.7944 | Old 0.8247 | New 0.7339
2024-12-05 13:47:10,774 - INFO - Weighted Accuracies: All 0.8257 | Old 0.8578 | New 0.7615
2024-12-05 13:49:48,365 - INFO - len of image selected samples: 18000
2024-12-05 13:49:48,365 - INFO - len of text selected samples: 18000
2024-12-05 13:55:00,979 - INFO - Epoch 32/200, Total Loss: 3.6263, Base Loss: 1.8634, Con Loss: 1.1348, Pseudo Loss Image: 0.3290, Pseudo Loss Image: 0.3290
2024-12-05 13:55:00,979 - INFO -    Param Group: classifier_head, Learning Rate: 0.0938
2024-12-05 13:55:00,979 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 13:56:19,476 - INFO - Text classifier Epoch 31 Train Accuracies: All 0.8170 | Old 0.8388 | New 0.7734
2024-12-05 13:56:19,476 - INFO - Image classifier Epoch 31 Train Accuracies: All 0.8013 | Old 0.8296 | New 0.7448
2024-12-05 13:57:38,637 - INFO - Weighted Accuracies: All 0.8261 | Old 0.8598 | New 0.7587
2024-12-05 14:00:15,907 - INFO - len of image selected samples: 18000
2024-12-05 14:00:15,908 - INFO - len of text selected samples: 18000
