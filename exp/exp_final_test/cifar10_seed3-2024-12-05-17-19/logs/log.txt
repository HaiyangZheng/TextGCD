2024-12-05 17:19:38,522 - INFO - Training cifar10_seed3 with the following settings:
2024-12-05 17:19:38,523 - INFO - Command-line arguments: output_dir=exp_final_test
 experiment_name=cifar10_seed3
 seed=3
 evaluate=False
 dataset_name=cifar10
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.1
 tau_t_start=0.07
 tau_t_end=0.04
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 5)
 unlabeled_classes=range(5, 10)
 num_labeled_classes=5
 num_unlabeled_classes=5
 log_path=exp_final_test/cifar10_seed3-2024-12-05-17-19/logs/log.txt
 model_path=exp_final_test/cifar10_seed3-2024-12-05-17-19/models/model.pth
 device=cuda
2024-12-05 17:19:38,528 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-05 17:19:40,567 - INFO - Building custom CLIP
2024-12-05 17:19:41,690 - INFO - Turning off gradients in both the image and the text encoder
2024-12-05 17:19:41,692 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-05 17:19:47,027 - INFO - len of train dataset: 50000
2024-12-05 17:19:47,028 - INFO - len of test dataset: 37500
2024-12-05 17:19:47,035 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-05 17:19:47,036 - INFO - Selecting 2250 high-confidence samples for co-teaching.
2024-12-05 17:21:27,837 - INFO - Before Train Accuracies: All 0.2259 | Old 0.0529 | New 0.3124
2024-12-05 17:21:27,838 - INFO - Before Train Accuracies: All 0.3202 | Old 0.0573 | New 0.4517
2024-12-05 17:26:40,570 - INFO - Epoch 1/200, Total Loss: 3.4835, Base Loss: 1.4255, Con Loss: 2.0579, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 17:26:40,570 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-05 17:26:40,570 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 17:28:18,507 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.9713 | Old 0.9501 | New 0.9819
2024-12-05 17:28:18,507 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.9439 | Old 0.9306 | New 0.9506
2024-12-05 17:29:56,560 - INFO - Weighted Accuracies: All 0.7951 | Old 0.9750 | New 0.7052
2024-12-05 17:29:57,197 - INFO - Saved model!
2024-12-05 17:35:09,733 - INFO - Epoch 2/200, Total Loss: 2.5067, Base Loss: 0.6202, Con Loss: 1.8864, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 17:35:09,733 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-05 17:35:09,733 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 17:36:47,857 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.9723 | Old 0.9486 | New 0.9842
2024-12-05 17:36:47,857 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.9542 | Old 0.9316 | New 0.9655
2024-12-05 17:38:26,460 - INFO - Weighted Accuracies: All 0.7928 | Old 0.9754 | New 0.7015
2024-12-05 17:43:40,855 - INFO - Epoch 3/200, Total Loss: 2.3810, Base Loss: 0.5726, Con Loss: 1.8084, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 17:43:40,855 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-05 17:43:40,855 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 17:45:19,082 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.9694 | Old 0.9404 | New 0.9838
2024-12-05 17:45:19,082 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.9573 | Old 0.9256 | New 0.9732
2024-12-05 17:46:57,446 - INFO - Weighted Accuracies: All 0.8087 | Old 0.9738 | New 0.7261
2024-12-05 17:46:58,245 - INFO - Saved model!
2024-12-05 17:52:12,201 - INFO - Epoch 4/200, Total Loss: 2.2756, Base Loss: 0.5361, Con Loss: 1.7395, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 17:52:12,201 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-05 17:52:12,201 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 17:53:50,902 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.9712 | Old 0.9501 | New 0.9817
2024-12-05 17:53:50,902 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.9568 | Old 0.9335 | New 0.9684
2024-12-05 17:55:29,557 - INFO - Weighted Accuracies: All 0.8265 | Old 0.9770 | New 0.7512
2024-12-05 17:55:30,321 - INFO - Saved model!
2024-12-05 18:00:43,155 - INFO - Epoch 5/200, Total Loss: 2.2194, Base Loss: 0.5258, Con Loss: 1.6935, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:00:43,155 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-05 18:00:43,155 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:02:21,685 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.9699 | Old 0.9430 | New 0.9834
2024-12-05 18:02:21,686 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.9560 | Old 0.9273 | New 0.9704
2024-12-05 18:04:00,536 - INFO - Weighted Accuracies: All 0.8019 | Old 0.9765 | New 0.7146
2024-12-05 18:09:12,969 - INFO - Epoch 6/200, Total Loss: 2.1695, Base Loss: 0.5043, Con Loss: 1.6652, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:09:12,969 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-05 18:09:12,969 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:10:51,603 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.9711 | Old 0.9458 | New 0.9838
2024-12-05 18:10:51,603 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.9589 | Old 0.9350 | New 0.9708
2024-12-05 18:12:29,789 - INFO - Weighted Accuracies: All 0.8114 | Old 0.9794 | New 0.7273
2024-12-05 18:17:42,716 - INFO - Epoch 7/200, Total Loss: 2.1220, Base Loss: 0.5010, Con Loss: 1.6210, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:17:42,716 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-05 18:17:42,716 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:19:21,138 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.9700 | Old 0.9450 | New 0.9824
2024-12-05 18:19:21,147 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.9574 | Old 0.9341 | New 0.9690
2024-12-05 18:20:59,694 - INFO - Weighted Accuracies: All 0.8030 | Old 0.9785 | New 0.7153
2024-12-05 18:26:12,843 - INFO - Epoch 8/200, Total Loss: 2.0899, Base Loss: 0.4928, Con Loss: 1.5970, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:26:12,843 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-05 18:26:12,843 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:27:51,265 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.9702 | Old 0.9446 | New 0.9830
2024-12-05 18:27:51,265 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.9576 | Old 0.9406 | New 0.9660
2024-12-05 18:29:29,179 - INFO - Weighted Accuracies: All 0.8202 | Old 0.9784 | New 0.7411
2024-12-05 18:34:42,173 - INFO - Epoch 9/200, Total Loss: 2.0525, Base Loss: 0.4763, Con Loss: 1.5762, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:34:42,174 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-05 18:34:42,174 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:36:20,166 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.9689 | Old 0.9376 | New 0.9846
2024-12-05 18:36:20,168 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.9609 | Old 0.9322 | New 0.9752
2024-12-05 18:37:58,873 - INFO - Weighted Accuracies: All 0.8025 | Old 0.9754 | New 0.7160
2024-12-05 18:43:12,052 - INFO - Epoch 10/200, Total Loss: 2.0229, Base Loss: 0.4709, Con Loss: 1.5520, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:43:12,052 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-05 18:43:12,052 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:44:50,387 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.9716 | Old 0.9462 | New 0.9843
2024-12-05 18:44:50,387 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.9605 | Old 0.9331 | New 0.9742
2024-12-05 18:46:29,040 - INFO - Weighted Accuracies: All 0.7959 | Old 0.9801 | New 0.7038
2024-12-05 18:51:42,416 - INFO - Epoch 11/200, Total Loss: 1.9924, Base Loss: 0.4685, Con Loss: 1.5239, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:51:42,416 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-05 18:51:42,416 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:53:20,668 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.9722 | Old 0.9494 | New 0.9836
2024-12-05 18:53:20,668 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.9612 | Old 0.9449 | New 0.9694
2024-12-05 18:54:58,656 - INFO - Weighted Accuracies: All 0.7866 | Old 0.9805 | New 0.6897
2024-12-05 18:56:36,800 - INFO - len of text selected samples: 22500
2024-12-05 19:01:50,332 - INFO - Epoch 12/200, Total Loss: 2.1801, Base Loss: 0.4736, Con Loss: 1.5115, Pseudo Loss Image: 0.1949, Pseudo Loss Image: 0.1949
2024-12-05 19:01:50,332 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-05 19:01:50,333 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
