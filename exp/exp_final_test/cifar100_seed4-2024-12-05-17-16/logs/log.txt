2024-12-05 17:16:48,543 - INFO - Training cifar100_seed4 with the following settings:
2024-12-05 17:16:48,544 - INFO - Command-line arguments: output_dir=exp_final_test
 experiment_name=cifar100_seed4
 seed=4
 evaluate=False
 dataset_name=cifar100
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 80)
 unlabeled_classes=range(80, 100)
 num_labeled_classes=80
 num_unlabeled_classes=20
 log_path=exp_final_test/cifar100_seed4-2024-12-05-17-16/logs/log.txt
 model_path=exp_final_test/cifar100_seed4-2024-12-05-17-16/models/model.pth
 device=cuda
2024-12-05 17:16:48,549 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-05 17:16:51,917 - INFO - Building custom CLIP
2024-12-05 17:16:53,139 - INFO - Turning off gradients in both the image and the text encoder
2024-12-05 17:16:53,141 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-05 17:16:59,054 - INFO - len of train dataset: 50000
2024-12-05 17:16:59,054 - INFO - len of test dataset: 30000
2024-12-05 17:16:59,072 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-05 17:16:59,073 - INFO - Selecting 180 high-confidence samples for co-teaching.
2024-12-05 17:18:34,835 - INFO - Before Train Accuracies: All 0.1103 | Old 0.0539 | New 0.2229
2024-12-05 17:18:34,836 - INFO - Before Train Accuracies: All 0.0627 | Old 0.0307 | New 0.1268
2024-12-05 17:23:53,929 - INFO - Epoch 1/200, Total Loss: 6.5810, Base Loss: 4.9446, Con Loss: 1.6364, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 17:23:53,929 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-05 17:23:53,929 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 17:25:13,539 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.6765 | Old 0.7203 | New 0.5889
2024-12-05 17:25:13,540 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.5732 | Old 0.6443 | New 0.4311
2024-12-05 17:26:33,622 - INFO - Weighted Accuracies: All 0.6482 | Old 0.7504 | New 0.4439
2024-12-05 17:26:34,355 - INFO - Saved model!
2024-12-05 17:31:51,095 - INFO - Epoch 2/200, Total Loss: 4.1930, Base Loss: 2.6715, Con Loss: 1.5215, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 17:31:51,096 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-05 17:31:51,096 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 17:33:11,833 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.7121 | Old 0.7965 | New 0.5433
2024-12-05 17:33:11,834 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.6193 | Old 0.7176 | New 0.4227
2024-12-05 17:34:32,340 - INFO - Weighted Accuracies: All 0.6614 | Old 0.7840 | New 0.4163
2024-12-05 17:34:33,230 - INFO - Saved model!
2024-12-05 17:39:51,574 - INFO - Epoch 3/200, Total Loss: 3.8943, Base Loss: 2.4406, Con Loss: 1.4536, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 17:39:51,575 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-05 17:39:51,575 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 17:41:11,262 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.7243 | Old 0.7926 | New 0.5876
2024-12-05 17:41:11,262 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.6356 | Old 0.7513 | New 0.4042
2024-12-05 17:42:30,814 - INFO - Weighted Accuracies: All 0.6550 | Old 0.8006 | New 0.3637
2024-12-05 17:47:47,697 - INFO - Epoch 4/200, Total Loss: 3.7174, Base Loss: 2.3134, Con Loss: 1.4039, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 17:47:47,697 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-05 17:47:47,697 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 17:49:07,475 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.7436 | Old 0.7974 | New 0.6358
2024-12-05 17:49:07,476 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.6447 | Old 0.7408 | New 0.4527
2024-12-05 17:50:27,742 - INFO - Weighted Accuracies: All 0.6654 | Old 0.8219 | New 0.3523
2024-12-05 17:50:28,510 - INFO - Saved model!
2024-12-05 17:55:45,652 - INFO - Epoch 5/200, Total Loss: 3.6195, Base Loss: 2.2402, Con Loss: 1.3793, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 17:55:45,653 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-05 17:55:45,653 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 17:57:05,833 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.7287 | Old 0.7998 | New 0.5865
2024-12-05 17:57:05,834 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.6431 | Old 0.7528 | New 0.4237
2024-12-05 17:58:26,079 - INFO - Weighted Accuracies: All 0.6646 | Old 0.8000 | New 0.3939
2024-12-05 18:03:42,445 - INFO - Epoch 6/200, Total Loss: 3.5571, Base Loss: 2.2040, Con Loss: 1.3531, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:03:42,445 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-05 18:03:42,445 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:05:02,752 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.7381 | Old 0.8141 | New 0.5860
2024-12-05 18:05:02,752 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.6556 | Old 0.7777 | New 0.4114
2024-12-05 18:06:23,423 - INFO - Weighted Accuracies: All 0.6662 | Old 0.8171 | New 0.3643
2024-12-05 18:06:24,327 - INFO - Saved model!
2024-12-05 18:11:41,315 - INFO - Epoch 7/200, Total Loss: 3.5103, Base Loss: 2.1710, Con Loss: 1.3393, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:11:41,315 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-05 18:11:41,315 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:13:01,672 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.7207 | Old 0.8146 | New 0.5328
2024-12-05 18:13:01,672 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.6579 | Old 0.7773 | New 0.4190
2024-12-05 18:14:22,282 - INFO - Weighted Accuracies: All 0.6596 | Old 0.8243 | New 0.3302
2024-12-05 18:19:39,335 - INFO - Epoch 8/200, Total Loss: 3.4461, Base Loss: 2.1376, Con Loss: 1.3085, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:19:39,338 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-05 18:19:39,338 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:20:59,997 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.7453 | Old 0.8125 | New 0.6109
2024-12-05 18:20:59,998 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.6673 | Old 0.7785 | New 0.4449
2024-12-05 18:22:20,807 - INFO - Weighted Accuracies: All 0.6574 | Old 0.8101 | New 0.3519
2024-12-05 18:27:39,402 - INFO - Epoch 9/200, Total Loss: 3.4177, Base Loss: 2.1162, Con Loss: 1.3014, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:27:39,402 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-05 18:27:39,402 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:29:00,279 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.7197 | Old 0.8074 | New 0.5444
2024-12-05 18:29:00,279 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.6636 | Old 0.7766 | New 0.4376
2024-12-05 18:30:21,321 - INFO - Weighted Accuracies: All 0.6672 | Old 0.7823 | New 0.4370
2024-12-05 18:30:22,232 - INFO - Saved model!
2024-12-05 18:35:40,432 - INFO - Epoch 10/200, Total Loss: 3.3607, Base Loss: 2.0818, Con Loss: 1.2789, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:35:40,432 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-05 18:35:40,432 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:37:01,175 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.7365 | Old 0.8122 | New 0.5853
2024-12-05 18:37:01,177 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.6650 | Old 0.7792 | New 0.4365
2024-12-05 18:38:22,000 - INFO - Weighted Accuracies: All 0.6624 | Old 0.8058 | New 0.3756
2024-12-05 18:43:40,796 - INFO - Epoch 11/200, Total Loss: 3.3208, Base Loss: 2.0581, Con Loss: 1.2627, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:43:40,796 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-05 18:43:40,796 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:45:01,665 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.7516 | Old 0.8137 | New 0.6274
2024-12-05 18:45:01,665 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.6684 | Old 0.7885 | New 0.4281
2024-12-05 18:46:22,781 - INFO - Weighted Accuracies: All 0.6594 | Old 0.8397 | New 0.2987
2024-12-05 18:47:43,727 - INFO - len of text selected samples: 18000
2024-12-05 18:53:02,270 - INFO - Epoch 12/200, Total Loss: 4.2409, Base Loss: 2.0301, Con Loss: 1.2797, Pseudo Loss Image: 0.9310, Pseudo Loss Image: 0.9310
2024-12-05 18:53:02,270 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-05 18:53:02,270 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:54:22,882 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.7404 | Old 0.8158 | New 0.5897
2024-12-05 18:54:22,882 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.7472 | Old 0.8043 | New 0.6330
2024-12-05 18:55:43,854 - INFO - Weighted Accuracies: All 0.7947 | Old 0.8578 | New 0.6685
2024-12-05 18:55:44,619 - INFO - Saved model!
2024-12-05 18:57:04,624 - INFO - len of text selected samples: 18000
2024-12-05 19:02:23,388 - INFO - Epoch 13/200, Total Loss: 3.9391, Base Loss: 1.9984, Con Loss: 1.2652, Pseudo Loss Image: 0.6755, Pseudo Loss Image: 0.6755
2024-12-05 19:02:23,389 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-12-05 19:02:23,389 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 19:03:43,720 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.7303 | Old 0.8189 | New 0.5531
2024-12-05 19:03:43,720 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.7309 | Old 0.8076 | New 0.5775
2024-12-05 19:05:03,275 - INFO - Weighted Accuracies: All 0.7801 | Old 0.8592 | New 0.6217
2024-12-05 19:06:22,867 - INFO - len of text selected samples: 18000
2024-12-05 19:11:41,674 - INFO - Epoch 14/200, Total Loss: 3.8418, Base Loss: 1.9712, Con Loss: 1.2529, Pseudo Loss Image: 0.6176, Pseudo Loss Image: 0.6176
2024-12-05 19:11:41,674 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-12-05 19:11:41,674 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 19:13:01,393 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.7612 | Old 0.8115 | New 0.6606
2024-12-05 19:13:01,393 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.7416 | Old 0.8091 | New 0.6066
2024-12-05 19:14:21,276 - INFO - Weighted Accuracies: All 0.7912 | Old 0.8539 | New 0.6657
2024-12-05 19:15:41,474 - INFO - len of text selected samples: 18000
2024-12-05 19:21:00,294 - INFO - Epoch 15/200, Total Loss: 3.7889, Base Loss: 1.9745, Con Loss: 1.2425, Pseudo Loss Image: 0.5720, Pseudo Loss Image: 0.5720
2024-12-05 19:21:00,295 - INFO -    Param Group: classifier_head, Learning Rate: 0.0986
2024-12-05 19:21:00,295 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 19:22:20,160 - INFO - Text classifier Epoch 14 Train Accuracies: All 0.7653 | Old 0.8161 | New 0.6639
2024-12-05 19:22:20,160 - INFO - Image classifier Epoch 14 Train Accuracies: All 0.7676 | Old 0.8165 | New 0.6699
2024-12-05 19:23:40,584 - INFO - Weighted Accuracies: All 0.8091 | Old 0.8578 | New 0.7119
2024-12-05 19:23:41,418 - INFO - Saved model!
2024-12-05 19:25:01,684 - INFO - len of text selected samples: 18000
2024-12-05 19:30:21,201 - INFO - Epoch 16/200, Total Loss: 3.7342, Base Loss: 1.9757, Con Loss: 1.2348, Pseudo Loss Image: 0.5237, Pseudo Loss Image: 0.5237
2024-12-05 19:30:21,201 - INFO -    Param Group: classifier_head, Learning Rate: 0.0984
2024-12-05 19:30:21,201 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 19:31:40,760 - INFO - Text classifier Epoch 15 Train Accuracies: All 0.7685 | Old 0.8188 | New 0.6677
2024-12-05 19:31:40,760 - INFO - Image classifier Epoch 15 Train Accuracies: All 0.7722 | Old 0.8130 | New 0.6906
2024-12-05 19:33:00,837 - INFO - Weighted Accuracies: All 0.8158 | Old 0.8568 | New 0.7338
2024-12-05 19:33:01,673 - INFO - Saved model!
2024-12-05 19:35:42,005 - INFO - len of image selected samples: 17992
2024-12-05 19:35:42,005 - INFO - len of text selected samples: 18000
2024-12-05 19:41:01,048 - INFO - Epoch 17/200, Total Loss: 4.2359, Base Loss: 1.9250, Con Loss: 1.2396, Pseudo Loss Image: 0.5006, Pseudo Loss Image: 0.5006
2024-12-05 19:41:01,048 - INFO -    Param Group: classifier_head, Learning Rate: 0.0982
2024-12-05 19:41:01,048 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 19:42:21,594 - INFO - Text classifier Epoch 16 Train Accuracies: All 0.8037 | Old 0.8219 | New 0.7674
2024-12-05 19:42:21,594 - INFO - Image classifier Epoch 16 Train Accuracies: All 0.7637 | Old 0.8151 | New 0.6609
2024-12-05 19:43:41,678 - INFO - Weighted Accuracies: All 0.8290 | Old 0.8564 | New 0.7742
2024-12-05 19:43:42,546 - INFO - Saved model!
2024-12-05 19:46:22,311 - INFO - len of image selected samples: 18000
2024-12-05 19:46:22,311 - INFO - len of text selected samples: 18000
2024-12-05 19:51:42,332 - INFO - Epoch 18/200, Total Loss: 4.0934, Base Loss: 1.9171, Con Loss: 1.2345, Pseudo Loss Image: 0.4677, Pseudo Loss Image: 0.4677
2024-12-05 19:51:42,332 - INFO -    Param Group: classifier_head, Learning Rate: 0.0980
2024-12-05 19:51:42,332 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 19:53:01,943 - INFO - Text classifier Epoch 17 Train Accuracies: All 0.8034 | Old 0.8269 | New 0.7564
2024-12-05 19:53:01,943 - INFO - Image classifier Epoch 17 Train Accuracies: All 0.7891 | Old 0.8183 | New 0.7306
2024-12-05 19:54:21,761 - INFO - Weighted Accuracies: All 0.8296 | Old 0.8583 | New 0.7720
2024-12-05 19:54:22,564 - INFO - Saved model!
2024-12-05 19:57:03,778 - INFO - len of image selected samples: 18000
2024-12-05 19:57:03,778 - INFO - len of text selected samples: 18000
2024-12-05 20:02:23,932 - INFO - Epoch 19/200, Total Loss: 4.0511, Base Loss: 1.9080, Con Loss: 1.2227, Pseudo Loss Image: 0.4621, Pseudo Loss Image: 0.4621
2024-12-05 20:02:23,933 - INFO -    Param Group: classifier_head, Learning Rate: 0.0978
2024-12-05 20:02:23,933 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 20:03:44,334 - INFO - Text classifier Epoch 18 Train Accuracies: All 0.8169 | Old 0.8276 | New 0.7953
2024-12-05 20:03:44,334 - INFO - Image classifier Epoch 18 Train Accuracies: All 0.7904 | Old 0.8175 | New 0.7361
2024-12-05 20:05:04,970 - INFO - Weighted Accuracies: All 0.8346 | Old 0.8574 | New 0.7889
2024-12-05 20:05:05,815 - INFO - Saved model!
2024-12-05 20:07:46,213 - INFO - len of image selected samples: 18000
2024-12-05 20:07:46,213 - INFO - len of text selected samples: 18000
2024-12-05 20:13:05,990 - INFO - Epoch 20/200, Total Loss: 3.9675, Base Loss: 1.9094, Con Loss: 1.2139, Pseudo Loss Image: 0.4391, Pseudo Loss Image: 0.4391
2024-12-05 20:13:05,990 - INFO -    Param Group: classifier_head, Learning Rate: 0.0976
2024-12-05 20:13:05,990 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 20:14:25,944 - INFO - Text classifier Epoch 19 Train Accuracies: All 0.8138 | Old 0.8292 | New 0.7830
2024-12-05 20:14:25,944 - INFO - Image classifier Epoch 19 Train Accuracies: All 0.8028 | Old 0.8199 | New 0.7685
2024-12-05 20:15:45,902 - INFO - Weighted Accuracies: All 0.8288 | Old 0.8580 | New 0.7702
2024-12-05 20:18:25,814 - INFO - len of image selected samples: 17999
2024-12-05 20:18:25,815 - INFO - len of text selected samples: 18000
2024-12-05 20:23:46,080 - INFO - Epoch 21/200, Total Loss: 3.9222, Base Loss: 1.9064, Con Loss: 1.2087, Pseudo Loss Image: 0.4209, Pseudo Loss Image: 0.4209
2024-12-05 20:23:46,080 - INFO -    Param Group: classifier_head, Learning Rate: 0.0973
2024-12-05 20:23:46,080 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 20:25:05,532 - INFO - Text classifier Epoch 20 Train Accuracies: All 0.8213 | Old 0.8250 | New 0.8138
2024-12-05 20:25:05,532 - INFO - Image classifier Epoch 20 Train Accuracies: All 0.8032 | Old 0.8168 | New 0.7760
2024-12-05 20:26:25,361 - INFO - Weighted Accuracies: All 0.8392 | Old 0.8531 | New 0.8113
2024-12-05 20:26:26,208 - INFO - Saved model!
2024-12-05 20:29:07,562 - INFO - len of image selected samples: 17999
2024-12-05 20:29:07,562 - INFO - len of text selected samples: 18000
2024-12-05 20:34:27,203 - INFO - Epoch 22/200, Total Loss: 3.8621, Base Loss: 1.8939, Con Loss: 1.1985, Pseudo Loss Image: 0.4066, Pseudo Loss Image: 0.4066
2024-12-05 20:34:27,204 - INFO -    Param Group: classifier_head, Learning Rate: 0.0970
2024-12-05 20:34:27,204 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 20:35:47,988 - INFO - Text classifier Epoch 21 Train Accuracies: All 0.8236 | Old 0.8237 | New 0.8234
2024-12-05 20:35:47,988 - INFO - Image classifier Epoch 21 Train Accuracies: All 0.8014 | Old 0.8115 | New 0.7812
2024-12-05 20:37:08,340 - INFO - Weighted Accuracies: All 0.8396 | Old 0.8514 | New 0.8160
2024-12-05 20:37:09,191 - INFO - Saved model!
2024-12-05 20:39:49,280 - INFO - len of image selected samples: 18000
2024-12-05 20:39:49,280 - INFO - len of text selected samples: 18000
2024-12-05 20:45:09,187 - INFO - Epoch 23/200, Total Loss: 3.8216, Base Loss: 1.8901, Con Loss: 1.1891, Pseudo Loss Image: 0.3896, Pseudo Loss Image: 0.3896
2024-12-05 20:45:09,188 - INFO -    Param Group: classifier_head, Learning Rate: 0.0968
2024-12-05 20:45:09,188 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 20:46:28,874 - INFO - Text classifier Epoch 22 Train Accuracies: All 0.8285 | Old 0.8255 | New 0.8344
2024-12-05 20:46:28,874 - INFO - Image classifier Epoch 22 Train Accuracies: All 0.8064 | Old 0.8164 | New 0.7865
2024-12-05 20:47:48,314 - INFO - Weighted Accuracies: All 0.8375 | Old 0.8504 | New 0.8117
2024-12-05 20:50:28,988 - INFO - len of image selected samples: 18000
2024-12-05 20:50:28,988 - INFO - len of text selected samples: 18000
2024-12-05 20:55:47,614 - INFO - Epoch 24/200, Total Loss: 3.8023, Base Loss: 1.8860, Con Loss: 1.1860, Pseudo Loss Image: 0.3847, Pseudo Loss Image: 0.3847
2024-12-05 20:55:47,614 - INFO -    Param Group: classifier_head, Learning Rate: 0.0965
2024-12-05 20:55:47,614 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 20:57:08,167 - INFO - Text classifier Epoch 23 Train Accuracies: All 0.8262 | Old 0.8279 | New 0.8228
2024-12-05 20:57:08,167 - INFO - Image classifier Epoch 23 Train Accuracies: All 0.8118 | Old 0.8197 | New 0.7959
2024-12-05 20:58:28,298 - INFO - Weighted Accuracies: All 0.8471 | Old 0.8532 | New 0.8347
2024-12-05 20:58:29,090 - INFO - Saved model!
2024-12-05 21:01:10,264 - INFO - len of image selected samples: 18000
2024-12-05 21:01:10,264 - INFO - len of text selected samples: 18000
2024-12-05 21:06:29,675 - INFO - Epoch 25/200, Total Loss: 3.7729, Base Loss: 1.8863, Con Loss: 1.1808, Pseudo Loss Image: 0.3737, Pseudo Loss Image: 0.3737
2024-12-05 21:06:29,675 - INFO -    Param Group: classifier_head, Learning Rate: 0.0962
2024-12-05 21:06:29,675 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 21:07:50,234 - INFO - Text classifier Epoch 24 Train Accuracies: All 0.8287 | Old 0.8285 | New 0.8291
2024-12-05 21:07:50,235 - INFO - Image classifier Epoch 24 Train Accuracies: All 0.8070 | Old 0.8178 | New 0.7853
2024-12-05 21:09:10,370 - INFO - Weighted Accuracies: All 0.8443 | Old 0.8544 | New 0.8242
2024-12-05 21:11:51,609 - INFO - len of image selected samples: 18000
2024-12-05 21:11:51,609 - INFO - len of text selected samples: 18000
2024-12-05 21:17:16,542 - INFO - Epoch 26/200, Total Loss: 3.7448, Base Loss: 1.8857, Con Loss: 1.1750, Pseudo Loss Image: 0.3629, Pseudo Loss Image: 0.3629
2024-12-05 21:17:16,543 - INFO -    Param Group: classifier_head, Learning Rate: 0.0959
2024-12-05 21:17:16,543 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 21:18:36,882 - INFO - Text classifier Epoch 25 Train Accuracies: All 0.8294 | Old 0.8300 | New 0.8283
2024-12-05 21:18:36,883 - INFO - Image classifier Epoch 25 Train Accuracies: All 0.8133 | Old 0.8199 | New 0.8000
2024-12-05 21:19:56,715 - INFO - Weighted Accuracies: All 0.8398 | Old 0.8532 | New 0.8129
2024-12-05 21:22:40,473 - INFO - len of image selected samples: 18000
2024-12-05 21:22:40,474 - INFO - len of text selected samples: 18000
2024-12-05 21:28:03,551 - INFO - Epoch 27/200, Total Loss: 3.7199, Base Loss: 1.8935, Con Loss: 1.1700, Pseudo Loss Image: 0.3479, Pseudo Loss Image: 0.3479
2024-12-05 21:28:03,551 - INFO -    Param Group: classifier_head, Learning Rate: 0.0956
2024-12-05 21:28:03,551 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 21:29:24,423 - INFO - Text classifier Epoch 26 Train Accuracies: All 0.8329 | Old 0.8283 | New 0.8423
2024-12-05 21:29:24,423 - INFO - Image classifier Epoch 26 Train Accuracies: All 0.8091 | Old 0.8193 | New 0.7887
2024-12-05 21:30:45,788 - INFO - Weighted Accuracies: All 0.8472 | Old 0.8532 | New 0.8352
2024-12-05 21:30:46,652 - INFO - Saved model!
2024-12-05 21:33:30,092 - INFO - len of image selected samples: 18000
2024-12-05 21:33:30,092 - INFO - len of text selected samples: 18000
2024-12-05 21:38:51,259 - INFO - Epoch 28/200, Total Loss: 3.6708, Base Loss: 1.8843, Con Loss: 1.1561, Pseudo Loss Image: 0.3337, Pseudo Loss Image: 0.3337
2024-12-05 21:38:51,260 - INFO -    Param Group: classifier_head, Learning Rate: 0.0952
2024-12-05 21:38:51,260 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 21:40:13,308 - INFO - Text classifier Epoch 27 Train Accuracies: All 0.8301 | Old 0.8328 | New 0.8247
2024-12-05 21:40:13,308 - INFO - Image classifier Epoch 27 Train Accuracies: All 0.8127 | Old 0.8189 | New 0.8002
2024-12-05 21:41:35,154 - INFO - Weighted Accuracies: All 0.8450 | Old 0.8537 | New 0.8277
2024-12-05 21:44:15,006 - INFO - len of image selected samples: 18000
2024-12-05 21:44:15,006 - INFO - len of text selected samples: 18000
2024-12-05 21:49:38,719 - INFO - Epoch 29/200, Total Loss: 3.6557, Base Loss: 1.8802, Con Loss: 1.1480, Pseudo Loss Image: 0.3331, Pseudo Loss Image: 0.3331
2024-12-05 21:49:38,719 - INFO -    Param Group: classifier_head, Learning Rate: 0.0949
2024-12-05 21:49:38,719 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 21:50:59,488 - INFO - Text classifier Epoch 28 Train Accuracies: All 0.8328 | Old 0.8319 | New 0.8345
2024-12-05 21:50:59,488 - INFO - Image classifier Epoch 28 Train Accuracies: All 0.8116 | Old 0.8199 | New 0.7951
2024-12-05 21:52:19,778 - INFO - Weighted Accuracies: All 0.8409 | Old 0.8525 | New 0.8178
2024-12-05 21:55:01,169 - INFO - len of image selected samples: 18000
2024-12-05 21:55:01,170 - INFO - len of text selected samples: 18000
2024-12-05 22:00:25,424 - INFO - Epoch 30/200, Total Loss: 3.6432, Base Loss: 1.8726, Con Loss: 1.1481, Pseudo Loss Image: 0.3338, Pseudo Loss Image: 0.3338
2024-12-05 22:00:25,424 - INFO -    Param Group: classifier_head, Learning Rate: 0.0946
2024-12-05 22:00:25,424 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 22:01:46,073 - INFO - Text classifier Epoch 29 Train Accuracies: All 0.8319 | Old 0.8321 | New 0.8315
2024-12-05 22:01:46,074 - INFO - Image classifier Epoch 29 Train Accuracies: All 0.8150 | Old 0.8233 | New 0.7984
2024-12-05 22:03:07,527 - INFO - Weighted Accuracies: All 0.8457 | Old 0.8540 | New 0.8292
2024-12-05 22:05:53,843 - INFO - len of image selected samples: 18000
2024-12-05 22:05:53,844 - INFO - len of text selected samples: 18000
2024-12-05 22:11:14,934 - INFO - Epoch 31/200, Total Loss: 3.6204, Base Loss: 1.8850, Con Loss: 1.1386, Pseudo Loss Image: 0.3113, Pseudo Loss Image: 0.3113
2024-12-05 22:11:14,935 - INFO -    Param Group: classifier_head, Learning Rate: 0.0942
2024-12-05 22:11:14,935 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 22:12:37,057 - INFO - Text classifier Epoch 30 Train Accuracies: All 0.8337 | Old 0.8330 | New 0.8350
2024-12-05 22:12:37,057 - INFO - Image classifier Epoch 30 Train Accuracies: All 0.8119 | Old 0.8220 | New 0.7916
2024-12-05 22:13:58,584 - INFO - Weighted Accuracies: All 0.8463 | Old 0.8544 | New 0.8300
2024-12-05 22:16:41,537 - INFO - len of image selected samples: 18000
2024-12-05 22:16:41,537 - INFO - len of text selected samples: 18000
2024-12-05 22:22:03,030 - INFO - Epoch 32/200, Total Loss: 3.5939, Base Loss: 1.8666, Con Loss: 1.1369, Pseudo Loss Image: 0.3149, Pseudo Loss Image: 0.3149
2024-12-05 22:22:03,030 - INFO -    Param Group: classifier_head, Learning Rate: 0.0938
2024-12-05 22:22:03,030 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 22:23:24,790 - INFO - Text classifier Epoch 31 Train Accuracies: All 0.8329 | Old 0.8327 | New 0.8334
2024-12-05 22:23:24,791 - INFO - Image classifier Epoch 31 Train Accuracies: All 0.8149 | Old 0.8264 | New 0.7920
2024-12-05 22:24:45,178 - INFO - Weighted Accuracies: All 0.8439 | Old 0.8541 | New 0.8235
2024-12-05 22:27:26,147 - INFO - len of image selected samples: 18000
2024-12-05 22:27:26,148 - INFO - len of text selected samples: 18000
2024-12-05 22:32:51,015 - INFO - Epoch 33/200, Total Loss: 3.5711, Base Loss: 1.8792, Con Loss: 1.1303, Pseudo Loss Image: 0.3063, Pseudo Loss Image: 0.3063
2024-12-05 22:32:51,015 - INFO -    Param Group: classifier_head, Learning Rate: 0.0934
2024-12-05 22:32:51,015 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 22:34:11,345 - INFO - Text classifier Epoch 32 Train Accuracies: All 0.8346 | Old 0.8328 | New 0.8380
2024-12-05 22:34:11,345 - INFO - Image classifier Epoch 32 Train Accuracies: All 0.8097 | Old 0.8255 | New 0.7782
2024-12-05 22:35:31,680 - INFO - Weighted Accuracies: All 0.8496 | Old 0.8538 | New 0.8411
2024-12-05 22:35:32,465 - INFO - Saved model!
2024-12-05 22:38:15,062 - INFO - len of image selected samples: 18000
2024-12-05 22:38:15,062 - INFO - len of text selected samples: 18000
2024-12-05 22:43:36,710 - INFO - Epoch 34/200, Total Loss: 3.5309, Base Loss: 1.8495, Con Loss: 1.1212, Pseudo Loss Image: 0.2955, Pseudo Loss Image: 0.2955
2024-12-05 22:43:36,711 - INFO -    Param Group: classifier_head, Learning Rate: 0.0930
2024-12-05 22:43:36,711 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 22:44:57,589 - INFO - Text classifier Epoch 33 Train Accuracies: All 0.8344 | Old 0.8351 | New 0.8329
2024-12-05 22:44:57,589 - INFO - Image classifier Epoch 33 Train Accuracies: All 0.8154 | Old 0.8234 | New 0.7994
2024-12-05 22:46:19,813 - INFO - Weighted Accuracies: All 0.8448 | Old 0.8551 | New 0.8241
2024-12-05 22:49:02,440 - INFO - len of image selected samples: 18000
2024-12-05 22:49:02,441 - INFO - len of text selected samples: 18000
2024-12-05 22:54:24,122 - INFO - Epoch 35/200, Total Loss: 3.5538, Base Loss: 1.8682, Con Loss: 1.1191, Pseudo Loss Image: 0.2939, Pseudo Loss Image: 0.2939
2024-12-05 22:54:24,122 - INFO -    Param Group: classifier_head, Learning Rate: 0.0926
2024-12-05 22:54:24,122 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 22:55:46,360 - INFO - Text classifier Epoch 34 Train Accuracies: All 0.8358 | Old 0.8359 | New 0.8356
2024-12-05 22:55:46,361 - INFO - Image classifier Epoch 34 Train Accuracies: All 0.8162 | Old 0.8296 | New 0.7893
2024-12-05 22:57:08,289 - INFO - Weighted Accuracies: All 0.8477 | Old 0.8565 | New 0.8302
2024-12-05 22:59:49,081 - INFO - len of image selected samples: 18000
2024-12-05 22:59:49,082 - INFO - len of text selected samples: 18000
2024-12-05 23:05:12,554 - INFO - Epoch 36/200, Total Loss: 3.5027, Base Loss: 1.8604, Con Loss: 1.1210, Pseudo Loss Image: 0.2785, Pseudo Loss Image: 0.2785
2024-12-05 23:05:12,555 - INFO -    Param Group: classifier_head, Learning Rate: 0.0922
2024-12-05 23:05:12,555 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 23:06:34,674 - INFO - Text classifier Epoch 35 Train Accuracies: All 0.8349 | Old 0.8361 | New 0.8324
2024-12-05 23:06:34,674 - INFO - Image classifier Epoch 35 Train Accuracies: All 0.8146 | Old 0.8287 | New 0.7864
2024-12-05 23:07:55,299 - INFO - Weighted Accuracies: All 0.8403 | Old 0.8555 | New 0.8101
2024-12-05 23:10:36,432 - INFO - len of image selected samples: 18000
2024-12-05 23:10:36,432 - INFO - len of text selected samples: 18000
