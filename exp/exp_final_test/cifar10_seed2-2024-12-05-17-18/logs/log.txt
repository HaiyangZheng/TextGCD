2024-12-05 17:18:22,578 - INFO - Training cifar10_seed2 with the following settings:
2024-12-05 17:18:22,579 - INFO - Command-line arguments: output_dir=exp_final_test
 experiment_name=cifar10_seed2
 seed=2
 evaluate=False
 dataset_name=cifar10
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.1
 tau_t_start=0.07
 tau_t_end=0.04
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 5)
 unlabeled_classes=range(5, 10)
 num_labeled_classes=5
 num_unlabeled_classes=5
 log_path=exp_final_test/cifar10_seed2-2024-12-05-17-18/logs/log.txt
 model_path=exp_final_test/cifar10_seed2-2024-12-05-17-18/models/model.pth
 device=cuda
2024-12-05 17:18:22,584 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-05 17:18:25,374 - INFO - Building custom CLIP
2024-12-05 17:18:26,481 - INFO - Turning off gradients in both the image and the text encoder
2024-12-05 17:18:26,483 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-05 17:18:31,363 - INFO - len of train dataset: 50000
2024-12-05 17:18:31,363 - INFO - len of test dataset: 37500
2024-12-05 17:18:31,374 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-05 17:18:31,375 - INFO - Selecting 2250 high-confidence samples for co-teaching.
2024-12-05 17:20:18,135 - INFO - Before Train Accuracies: All 0.2494 | Old 0.0198 | New 0.3643
2024-12-05 17:20:18,135 - INFO - Before Train Accuracies: All 0.2188 | Old 0.1313 | New 0.2625
2024-12-05 17:25:29,613 - INFO - Epoch 1/200, Total Loss: 3.5102, Base Loss: 1.4465, Con Loss: 2.0638, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 17:25:29,613 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-05 17:25:29,613 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 17:27:06,548 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.9711 | Old 0.9509 | New 0.9812
2024-12-05 17:27:06,548 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.9447 | Old 0.9273 | New 0.9534
2024-12-05 17:28:44,294 - INFO - Weighted Accuracies: All 0.8241 | Old 0.9727 | New 0.7497
2024-12-05 17:28:44,928 - INFO - Saved model!
2024-12-05 17:33:54,706 - INFO - Epoch 2/200, Total Loss: 2.5059, Base Loss: 0.6200, Con Loss: 1.8859, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 17:33:54,706 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-05 17:33:54,706 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 17:35:31,998 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.9698 | Old 0.9390 | New 0.9852
2024-12-05 17:35:31,998 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.9490 | Old 0.9064 | New 0.9704
2024-12-05 17:37:09,580 - INFO - Weighted Accuracies: All 0.8169 | Old 0.9645 | New 0.7431
2024-12-05 17:42:20,611 - INFO - Epoch 3/200, Total Loss: 2.3816, Base Loss: 0.5721, Con Loss: 1.8095, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 17:42:20,611 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-05 17:42:20,611 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 17:43:57,757 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.9725 | Old 0.9506 | New 0.9835
2024-12-05 17:43:57,757 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.9558 | Old 0.9294 | New 0.9690
2024-12-05 17:45:35,447 - INFO - Weighted Accuracies: All 0.8517 | Old 0.9732 | New 0.7910
2024-12-05 17:45:36,138 - INFO - Saved model!
2024-12-05 17:50:46,581 - INFO - Epoch 4/200, Total Loss: 2.2895, Base Loss: 0.5478, Con Loss: 1.7418, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 17:50:46,581 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-05 17:50:46,581 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 17:52:24,045 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.9704 | Old 0.9450 | New 0.9832
2024-12-05 17:52:24,046 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.9546 | Old 0.9350 | New 0.9644
2024-12-05 17:54:01,742 - INFO - Weighted Accuracies: All 0.8524 | Old 0.9721 | New 0.7926
2024-12-05 17:54:02,436 - INFO - Saved model!
2024-12-05 17:59:12,737 - INFO - Epoch 5/200, Total Loss: 2.2142, Base Loss: 0.5176, Con Loss: 1.6966, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 17:59:12,738 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-05 17:59:12,738 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:00:49,707 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.9724 | Old 0.9513 | New 0.9830
2024-12-05 18:00:49,707 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.9573 | Old 0.9330 | New 0.9694
2024-12-05 18:02:27,284 - INFO - Weighted Accuracies: All 0.8503 | Old 0.9737 | New 0.7886
2024-12-05 18:07:37,888 - INFO - Epoch 6/200, Total Loss: 2.1731, Base Loss: 0.5105, Con Loss: 1.6626, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:07:37,889 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-05 18:07:37,889 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:09:15,459 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.9690 | Old 0.9457 | New 0.9806
2024-12-05 18:09:15,459 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.9546 | Old 0.9306 | New 0.9666
2024-12-05 18:10:52,638 - INFO - Weighted Accuracies: All 0.8451 | Old 0.9734 | New 0.7810
2024-12-05 18:16:02,863 - INFO - Epoch 7/200, Total Loss: 2.1162, Base Loss: 0.4870, Con Loss: 1.6292, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:16:02,863 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-05 18:16:02,863 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:17:40,554 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.9699 | Old 0.9393 | New 0.9853
2024-12-05 18:17:40,554 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.9583 | Old 0.9234 | New 0.9758
2024-12-05 18:19:18,368 - INFO - Weighted Accuracies: All 0.8554 | Old 0.9710 | New 0.7976
2024-12-05 18:19:19,066 - INFO - Saved model!
2024-12-05 18:24:29,207 - INFO - Epoch 8/200, Total Loss: 2.0802, Base Loss: 0.4852, Con Loss: 1.5950, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:24:29,207 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-05 18:24:29,207 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:26:06,804 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.9718 | Old 0.9474 | New 0.9840
2024-12-05 18:26:06,805 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.9604 | Old 0.9451 | New 0.9681
2024-12-05 18:27:44,112 - INFO - Weighted Accuracies: All 0.8511 | Old 0.9767 | New 0.7884
2024-12-05 18:32:54,163 - INFO - Epoch 9/200, Total Loss: 2.0531, Base Loss: 0.4827, Con Loss: 1.5704, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:32:54,163 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-05 18:32:54,163 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:34:31,642 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.9710 | Old 0.9433 | New 0.9849
2024-12-05 18:34:31,642 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.9579 | Old 0.9411 | New 0.9662
2024-12-05 18:36:09,256 - INFO - Weighted Accuracies: All 0.8570 | Old 0.9752 | New 0.7979
2024-12-05 18:36:09,998 - INFO - Saved model!
2024-12-05 18:41:20,652 - INFO - Epoch 10/200, Total Loss: 2.0245, Base Loss: 0.4768, Con Loss: 1.5477, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:41:20,652 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-05 18:41:20,652 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:42:58,394 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.9713 | Old 0.9451 | New 0.9843
2024-12-05 18:42:58,394 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.9599 | Old 0.9342 | New 0.9728
2024-12-05 18:44:36,177 - INFO - Weighted Accuracies: All 0.8290 | Old 0.9732 | New 0.7569
2024-12-05 18:49:46,313 - INFO - Epoch 11/200, Total Loss: 2.0017, Base Loss: 0.4765, Con Loss: 1.5252, Pseudo Loss Image: 0.0000, Pseudo Loss Image: 0.0000
2024-12-05 18:49:46,313 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-05 18:49:46,313 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 18:51:24,132 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.9678 | Old 0.9326 | New 0.9853
2024-12-05 18:51:24,132 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.9599 | Old 0.9190 | New 0.9804
2024-12-05 18:53:01,895 - INFO - Weighted Accuracies: All 0.8493 | Old 0.9663 | New 0.7908
2024-12-05 18:54:39,678 - INFO - len of text selected samples: 22500
2024-12-05 18:59:51,160 - INFO - Epoch 12/200, Total Loss: 2.2144, Base Loss: 0.4838, Con Loss: 1.5147, Pseudo Loss Image: 0.2159, Pseudo Loss Image: 0.2159
2024-12-05 18:59:51,161 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-05 18:59:51,161 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-05 19:01:29,046 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.9721 | Old 0.9470 | New 0.9846
2024-12-05 19:01:29,046 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.9567 | Old 0.9562 | New 0.9570
