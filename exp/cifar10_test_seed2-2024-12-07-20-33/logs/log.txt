2024-12-07 20:33:04,548 - INFO - Training cifar10_test_seed2 with the following settings:
2024-12-07 20:33:04,550 - INFO - Command-line arguments: output_dir=exp
 experiment_name=cifar10_test_seed2
 seed=2
 evaluate=False
 dataset_name=cifar10
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.1
 tau_t_start=0.07
 tau_t_end=0.04
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 5)
 unlabeled_classes=range(5, 10)
 num_labeled_classes=5
 num_unlabeled_classes=5
 log_path=exp/cifar10_test_seed2-2024-12-07-20-33/logs/log.txt
 model_path=exp/cifar10_test_seed2-2024-12-07-20-33/models/model.pth
 device=cuda
2024-12-07 20:33:04,555 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-07 20:33:06,999 - INFO - Building custom CLIP
2024-12-07 20:33:08,110 - INFO - Turning off gradients in both the image and the text encoder
2024-12-07 20:33:08,113 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 20:33:13,081 - INFO - len of train dataset: 50000
2024-12-07 20:33:13,082 - INFO - len of test dataset: 37500
2024-12-07 20:33:13,091 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 20:33:13,092 - INFO - Selecting 2250 high-confidence samples for co-teaching.
2024-12-07 20:34:58,516 - INFO - Before Train Accuracies: All 0.2439 | Old 0.1451 | New 0.2933
2024-12-07 20:34:58,518 - INFO - Before Train Accuracies: All 0.2188 | Old 0.1313 | New 0.2625
2024-12-07 20:40:11,173 - INFO - Epoch 1/200, Total Loss: 3.5024, Base Loss: 1.4393, Con Loss: 2.0631, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:40:11,173 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 20:40:11,173 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:41:49,096 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.9710 | Old 0.9522 | New 0.9805
2024-12-07 20:41:49,098 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.9449 | Old 0.9276 | New 0.9536
2024-12-07 20:43:26,209 - INFO - Weighted Accuracies: All 0.8473 | Old 0.9728 | New 0.7845
2024-12-07 20:43:26,798 - INFO - Saved model!
2024-12-07 20:48:38,512 - INFO - Epoch 2/200, Total Loss: 2.5019, Base Loss: 0.6189, Con Loss: 1.8830, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:48:38,512 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 20:48:38,512 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:50:16,302 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.9690 | Old 0.9381 | New 0.9844
2024-12-07 20:50:16,304 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.9493 | Old 0.9074 | New 0.9702
2024-12-07 20:51:53,942 - INFO - Weighted Accuracies: All 0.8094 | Old 0.9650 | New 0.7316
2024-12-07 20:57:04,557 - INFO - Epoch 3/200, Total Loss: 2.3813, Base Loss: 0.5725, Con Loss: 1.8088, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:57:04,557 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 20:57:04,557 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:58:42,508 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.9725 | Old 0.9508 | New 0.9834
2024-12-07 20:58:42,510 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.9563 | Old 0.9304 | New 0.9692
2024-12-07 21:00:20,886 - INFO - Weighted Accuracies: All 0.8319 | Old 0.9732 | New 0.7613
2024-12-07 21:05:34,282 - INFO - Epoch 4/200, Total Loss: 2.2899, Base Loss: 0.5479, Con Loss: 1.7420, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 21:05:34,282 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 21:05:34,283 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:07:11,855 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.9692 | Old 0.9434 | New 0.9821
2024-12-07 21:07:11,858 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.9546 | Old 0.9355 | New 0.9642
2024-12-07 21:08:51,796 - INFO - Weighted Accuracies: All 0.8457 | Old 0.9724 | New 0.7824
