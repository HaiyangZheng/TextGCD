2024-12-07 15:13:47,065 - INFO - Training cifar100_test_seed2 with the following settings:
2024-12-07 15:13:47,065 - INFO - Command-line arguments: output_dir=exp
 experiment_name=cifar100_test_seed2
 seed=2
 evaluate=False
 dataset_name=cifar100
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=range(0, 80)
 unlabeled_classes=range(80, 100)
 num_labeled_classes=80
 num_unlabeled_classes=20
 log_path=exp/cifar100_test_seed2-2024-12-07-15-13/logs/log.txt
 model_path=exp/cifar100_test_seed2-2024-12-07-15-13/models/model.pth
 device=cuda
2024-12-07 15:13:47,084 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-07 15:13:49,708 - INFO - Building custom CLIP
2024-12-07 15:13:51,062 - INFO - Turning off gradients in both the image and the text encoder
2024-12-07 15:13:51,063 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 15:13:57,445 - INFO - len of train dataset: 50000
2024-12-07 15:13:57,446 - INFO - len of test dataset: 30000
2024-12-07 15:13:57,456 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 15:13:57,457 - INFO - Selecting 180 high-confidence samples for co-teaching.
2024-12-07 15:15:24,915 - INFO - Before Train Accuracies: All 0.1179 | Old 0.0640 | New 0.2256
2024-12-07 15:15:24,915 - INFO - Before Train Accuracies: All 0.0738 | Old 0.0362 | New 0.1490
2024-12-07 15:20:42,663 - INFO - Epoch 1/200, Total Loss: 6.6190, Base Loss: 4.9804, Con Loss: 1.6385, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 15:20:42,663 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 15:20:42,663 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 15:22:03,042 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.6781 | Old 0.7202 | New 0.5937
2024-12-07 15:22:03,042 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.5707 | Old 0.6425 | New 0.4269
2024-12-07 15:23:23,410 - INFO - Weighted Accuracies: All 0.6443 | Old 0.7005 | New 0.5319
2024-12-07 15:23:24,075 - INFO - Saved model!
2024-12-07 15:28:37,488 - INFO - Epoch 2/200, Total Loss: 4.2299, Base Loss: 2.7026, Con Loss: 1.5273, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 15:28:37,488 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 15:28:37,488 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 15:29:56,901 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.7120 | Old 0.7883 | New 0.5594
2024-12-07 15:29:56,901 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.6267 | Old 0.7160 | New 0.4479
2024-12-07 15:31:16,218 - INFO - Weighted Accuracies: All 0.6465 | Old 0.7846 | New 0.3701
2024-12-07 15:31:16,904 - INFO - Saved model!
2024-12-07 15:36:30,612 - INFO - Epoch 3/200, Total Loss: 3.9013, Base Loss: 2.4497, Con Loss: 1.4516, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 15:36:30,612 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 15:36:30,612 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 15:37:49,860 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.7137 | Old 0.7950 | New 0.5512
2024-12-07 15:37:49,860 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.6374 | Old 0.7209 | New 0.4705
2024-12-07 15:39:08,859 - INFO - Weighted Accuracies: All 0.6536 | Old 0.7836 | New 0.3936
2024-12-07 15:39:09,548 - INFO - Saved model!
2024-12-07 15:44:24,805 - INFO - Epoch 4/200, Total Loss: 3.7254, Base Loss: 2.3198, Con Loss: 1.4056, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 15:44:24,805 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 15:44:24,805 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 15:45:45,110 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.7161 | Old 0.8087 | New 0.5309
2024-12-07 15:45:45,110 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.6408 | Old 0.7625 | New 0.3972
2024-12-07 15:47:05,312 - INFO - Weighted Accuracies: All 0.6513 | Old 0.8088 | New 0.3362
2024-12-07 15:52:21,193 - INFO - Epoch 5/200, Total Loss: 3.6256, Base Loss: 2.2511, Con Loss: 1.3745, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 15:52:21,194 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 15:52:21,194 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 15:53:41,460 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.7337 | Old 0.8121 | New 0.5770
2024-12-07 15:53:41,461 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.6519 | Old 0.7658 | New 0.4240
2024-12-07 15:55:02,020 - INFO - Weighted Accuracies: All 0.6444 | Old 0.8132 | New 0.3069
2024-12-07 16:00:18,757 - INFO - Epoch 6/200, Total Loss: 3.5561, Base Loss: 2.2059, Con Loss: 1.3502, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 16:00:18,757 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 16:00:18,757 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 16:01:39,237 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.7283 | Old 0.8095 | New 0.5660
2024-12-07 16:01:39,237 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.6490 | Old 0.7638 | New 0.4195
2024-12-07 16:03:00,121 - INFO - Weighted Accuracies: All 0.6644 | Old 0.8168 | New 0.3596
2024-12-07 16:03:00,919 - INFO - Saved model!
2024-12-07 16:08:16,088 - INFO - Epoch 7/200, Total Loss: 3.4992, Base Loss: 2.1711, Con Loss: 1.3280, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 16:08:16,088 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-07 16:08:16,088 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 16:09:36,586 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.7408 | Old 0.8129 | New 0.5966
2024-12-07 16:09:36,586 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.6599 | Old 0.7630 | New 0.4536
2024-12-07 16:10:55,789 - INFO - Weighted Accuracies: All 0.6614 | Old 0.8125 | New 0.3590
2024-12-07 16:16:09,045 - INFO - Epoch 8/200, Total Loss: 3.4344, Base Loss: 2.1248, Con Loss: 1.3096, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 16:16:09,045 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-07 16:16:09,045 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 16:17:28,352 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.7352 | Old 0.8114 | New 0.5830
2024-12-07 16:17:28,352 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.6556 | Old 0.7715 | New 0.4237
2024-12-07 16:18:47,206 - INFO - Weighted Accuracies: All 0.6682 | Old 0.8142 | New 0.3764
2024-12-07 16:18:47,900 - INFO - Saved model!
2024-12-07 16:24:01,060 - INFO - Epoch 9/200, Total Loss: 3.4037, Base Loss: 2.1077, Con Loss: 1.2960, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 16:24:01,060 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-07 16:24:01,060 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 16:25:20,495 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.7331 | Old 0.8203 | New 0.5588
2024-12-07 16:25:20,495 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.6632 | Old 0.7691 | New 0.4516
2024-12-07 16:26:41,006 - INFO - Weighted Accuracies: All 0.6669 | Old 0.8096 | New 0.3813
2024-12-07 16:31:57,175 - INFO - Epoch 10/200, Total Loss: 3.3845, Base Loss: 2.0916, Con Loss: 1.2929, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 16:31:57,176 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-07 16:31:57,176 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 16:33:18,111 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.7269 | Old 0.8218 | New 0.5371
2024-12-07 16:33:18,111 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.6652 | Old 0.7841 | New 0.4273
2024-12-07 16:34:39,125 - INFO - Weighted Accuracies: All 0.6752 | Old 0.8207 | New 0.3841
2024-12-07 16:34:39,911 - INFO - Saved model!
2024-12-07 16:39:56,029 - INFO - Epoch 11/200, Total Loss: 3.3302, Base Loss: 2.0607, Con Loss: 1.2695, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 16:39:56,029 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-07 16:39:56,029 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 16:41:16,584 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.7270 | Old 0.8191 | New 0.5429
2024-12-07 16:41:16,584 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.6742 | Old 0.7913 | New 0.4402
2024-12-07 16:42:37,220 - INFO - Weighted Accuracies: All 0.6690 | Old 0.8414 | New 0.3242
2024-12-07 16:43:57,791 - INFO - len of text selected samples: 18000
2024-12-07 16:49:15,076 - INFO - Epoch 12/200, Total Loss: 4.2516, Base Loss: 2.0278, Con Loss: 1.2837, Pseudo Loss Image: 0.9401, Pseudo Loss Text: 0.0000
2024-12-07 16:49:15,076 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-07 16:49:15,076 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 16:50:35,355 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.7258 | Old 0.8238 | New 0.5297
2024-12-07 16:50:35,355 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.7224 | Old 0.8054 | New 0.5563
2024-12-07 16:51:56,357 - INFO - Weighted Accuracies: All 0.7761 | Old 0.8626 | New 0.6033
2024-12-07 16:51:57,158 - INFO - Saved model!
2024-12-07 16:53:17,888 - INFO - len of text selected samples: 17996
2024-12-07 16:58:32,979 - INFO - Epoch 13/200, Total Loss: 3.9618, Base Loss: 1.9956, Con Loss: 1.2738, Pseudo Loss Image: 0.6924, Pseudo Loss Text: 0.0000
2024-12-07 16:58:32,979 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-12-07 16:58:32,979 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 16:59:52,329 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.7321 | Old 0.8248 | New 0.5467
2024-12-07 16:59:52,329 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.7417 | Old 0.8120 | New 0.6011
2024-12-07 17:01:11,249 - INFO - Weighted Accuracies: All 0.7857 | Old 0.8637 | New 0.6298
2024-12-07 17:01:11,947 - INFO - Saved model!
2024-12-07 17:02:31,330 - INFO - len of text selected samples: 18000
2024-12-07 17:07:45,252 - INFO - Epoch 14/200, Total Loss: 3.8718, Base Loss: 1.9854, Con Loss: 1.2558, Pseudo Loss Image: 0.6306, Pseudo Loss Text: 0.0000
2024-12-07 17:07:45,252 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-12-07 17:07:45,252 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 17:09:04,177 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.7441 | Old 0.8217 | New 0.5887
2024-12-07 17:09:04,178 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.7489 | Old 0.8087 | New 0.6292
2024-12-07 17:10:23,896 - INFO - Weighted Accuracies: All 0.7968 | Old 0.8606 | New 0.6694
2024-12-07 17:10:24,668 - INFO - Saved model!
2024-12-07 17:11:45,314 - INFO - len of text selected samples: 17998
