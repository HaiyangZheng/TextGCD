2024-12-07 20:35:23,020 - INFO - Training scars_test_seed2 with the following settings:
2024-12-07 20:35:23,021 - INFO - Command-line arguments: output_dir=exp
 experiment_name=scars_test_seed2
 seed=2
 evaluate=False
 dataset_name=scars
 backbone_name=ViT-B/16
 cub_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/CUB
 cub_retrieved_text_path=retrieved_text/cub_retrieved_text.npy
 flowers_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 flowers_retrieved_text_path=retrieved_text/flowers_retrieved_text.npy
 scars_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 scars_retrieved_text_path=retrieved_text/scars_retrieved_text.npy
 pets_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets
 pets_retrieved_text_path=retrieved_text/pets_retrieved_text.npy
 cifar10_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar10
 cifar10_retrieved_text_path=retrieved_text/cifar10_retrieved_text.npy
 cifar100_root=/leonardo_work/IscrC_Fed-GCD/GCD_datasets/cifar100
 cifar100_retrieved_text_path=retrieved_text/cifar100_retrieved_text.npy
 imagenet_root=/home/fandral/Nan/NCD_dataset
 imagenet_retrieved_text_path=retrieved_text/imagenet100_retrieved_text.npy
 osr_split_dir=data/ssb_splits
 epochs=200
 base_lr=0.0005
 classifier_lr=0.1
 momentum=0.9
 weight_decay=0.0001
 num_workers=8
 batch_size=128
 prop_train_labels=0.5
 use_ssb_splits=True
 transform=imagenet
 n_views=2
 selecting_ratio=0.6
 lambda_loss=0.2
 warm_up_epochs=10
 class_aligning_epochs=5
 num_attributes=2
 num_tags=3
 tau_s=0.1
 tau_u=0.05
 tau_t_start=0.035
 tau_t_end=0.02
 warmup_teacher_temp_epochs=30
 memax_weight=2
 image_size=224
 train_classes=[1, 11, 25, 38, 46, 50, 53, 75, 84, 100, 105, 117, 123, 129, 133, 134, 135, 136, 137, 138, 140, 144, 145, 146, 147, 149, 150, 151, 153, 160, 161, 162, 163, 164, 167, 168, 169, 174, 175, 180, 185, 186, 187, 192, 193, 0, 81, 97, 104, 122, 139, 141, 142, 143, 148, 152, 154, 155, 156, 157, 158, 159, 165, 166, 170, 171, 172, 173, 176, 177, 181, 184, 188, 191, 194, 195, 2, 7, 9, 16, 20, 26, 28, 44, 54, 95, 98, 102, 127, 178, 182, 22, 41, 82, 93, 112, 125, 189]
 unlabeled_classes=[23, 42, 83, 94, 113, 126, 190, 3, 8, 10, 17, 21, 27, 29, 45, 55, 96, 99, 103, 128, 179, 183, 4, 5, 6, 12, 13, 14, 15, 18, 19, 24, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 43, 47, 48, 49, 51, 52, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 76, 77, 78, 79, 80, 85, 86, 87, 88, 89, 90, 91, 92, 101, 106, 107, 108, 109, 110, 111, 114, 115, 116, 118, 119, 120, 121, 124, 130, 131, 132]
 num_labeled_classes=98
 num_unlabeled_classes=98
 log_path=exp/scars_test_seed2-2024-12-07-20-35/logs/log.txt
 model_path=exp/scars_test_seed2-2024-12-07-20-35/models/model.pth
 device=cuda
2024-12-07 20:35:23,025 - INFO - Loading CLIP (backbone: ViT-B/16)
2024-12-07 20:35:25,418 - INFO - Building custom CLIP
2024-12-07 20:35:26,515 - INFO - Turning off gradients in both the image and the text encoder
2024-12-07 20:35:26,518 - INFO - Parameters that require gradients: ['model.text_projection', 'model.visual.proj', 'model.visual.transformer.resblocks.11.attn.in_proj_weight', 'model.visual.transformer.resblocks.11.attn.in_proj_bias', 'model.visual.transformer.resblocks.11.attn.out_proj.weight', 'model.visual.transformer.resblocks.11.attn.out_proj.bias', 'model.visual.transformer.resblocks.11.ln_1.weight', 'model.visual.transformer.resblocks.11.ln_1.bias', 'model.visual.transformer.resblocks.11.mlp.c_fc.weight', 'model.visual.transformer.resblocks.11.mlp.c_fc.bias', 'model.visual.transformer.resblocks.11.mlp.c_proj.weight', 'model.visual.transformer.resblocks.11.mlp.c_proj.bias', 'model.visual.transformer.resblocks.11.ln_2.weight', 'model.visual.transformer.resblocks.11.ln_2.bias', 'model.transformer.resblocks.11.attn.in_proj_weight', 'model.transformer.resblocks.11.attn.in_proj_bias', 'model.transformer.resblocks.11.attn.out_proj.weight', 'model.transformer.resblocks.11.attn.out_proj.bias', 'model.transformer.resblocks.11.ln_1.weight', 'model.transformer.resblocks.11.ln_1.bias', 'model.transformer.resblocks.11.mlp.c_fc.weight', 'model.transformer.resblocks.11.mlp.c_fc.bias', 'model.transformer.resblocks.11.mlp.c_proj.weight', 'model.transformer.resblocks.11.mlp.c_proj.bias', 'model.transformer.resblocks.11.ln_2.weight', 'model.transformer.resblocks.11.ln_2.bias', 'image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 20:35:27,490 - INFO - len of train dataset: 8144
2024-12-07 20:35:27,492 - INFO - len of test dataset: 6144
2024-12-07 20:35:27,497 - INFO - Parameters in classifier with big lr: ['image_classifier.weight_g', 'image_classifier.weight_v', 'text_classifier.weight_g', 'text_classifier.weight_v']
2024-12-07 20:35:27,498 - INFO - Selecting 18 high-confidence samples for co-teaching.
2024-12-07 20:35:56,860 - INFO - Before Train Accuracies: All 0.1284 | Old 0.0330 | New 0.1745
2024-12-07 20:35:56,860 - INFO - Before Train Accuracies: All 0.0418 | Old 0.0195 | New 0.0526
2024-12-07 20:36:54,916 - INFO - Epoch 1/200, Total Loss: 11.7469, Base Loss: 9.9785, Con Loss: 1.7684, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:36:54,916 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 20:36:54,916 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:37:16,797 - INFO - Text classifier Epoch 0 Train Accuracies: All 0.3499 | Old 0.2799 | New 0.3838
2024-12-07 20:37:16,797 - INFO - Image classifier Epoch 0 Train Accuracies: All 0.1991 | Old 0.1654 | New 0.2153
2024-12-07 20:37:38,554 - INFO - Weighted Accuracies: All 0.2773 | Old 0.2419 | New 0.2945
2024-12-07 20:37:39,163 - INFO - Saved model!
2024-12-07 20:38:35,716 - INFO - Epoch 2/200, Total Loss: 9.5963, Base Loss: 7.9418, Con Loss: 1.6545, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:38:35,716 - INFO -    Param Group: classifier_head, Learning Rate: 0.1000
2024-12-07 20:38:35,716 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:38:57,478 - INFO - Text classifier Epoch 1 Train Accuracies: All 0.4422 | Old 0.5097 | New 0.4096
2024-12-07 20:38:57,478 - INFO - Image classifier Epoch 1 Train Accuracies: All 0.3006 | Old 0.3448 | New 0.2793
2024-12-07 20:39:19,431 - INFO - Weighted Accuracies: All 0.4009 | Old 0.4993 | New 0.3534
2024-12-07 20:39:20,103 - INFO - Saved model!
2024-12-07 20:40:15,908 - INFO - Epoch 3/200, Total Loss: 7.1171, Base Loss: 5.5129, Con Loss: 1.6043, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:40:15,908 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 20:40:15,908 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:40:37,609 - INFO - Text classifier Epoch 2 Train Accuracies: All 0.5257 | Old 0.5877 | New 0.4958
2024-12-07 20:40:37,609 - INFO - Image classifier Epoch 2 Train Accuracies: All 0.3545 | Old 0.4963 | New 0.2860
2024-12-07 20:40:59,581 - INFO - Weighted Accuracies: All 0.4434 | Old 0.5522 | New 0.3908
2024-12-07 20:41:00,258 - INFO - Saved model!
2024-12-07 20:41:56,850 - INFO - Epoch 4/200, Total Loss: 6.2667, Base Loss: 4.6894, Con Loss: 1.5773, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:41:56,850 - INFO -    Param Group: classifier_head, Learning Rate: 0.0999
2024-12-07 20:41:56,850 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:42:18,364 - INFO - Text classifier Epoch 3 Train Accuracies: All 0.5671 | Old 0.6692 | New 0.5177
2024-12-07 20:42:18,364 - INFO - Image classifier Epoch 3 Train Accuracies: All 0.3864 | Old 0.5357 | New 0.3143
2024-12-07 20:42:40,648 - INFO - Weighted Accuracies: All 0.4795 | Old 0.5777 | New 0.4321
2024-12-07 20:42:41,323 - INFO - Saved model!
2024-12-07 20:43:37,579 - INFO - Epoch 5/200, Total Loss: 5.8147, Base Loss: 4.2726, Con Loss: 1.5421, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:43:37,579 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 20:43:37,579 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:43:59,278 - INFO - Text classifier Epoch 4 Train Accuracies: All 0.6089 | Old 0.6592 | New 0.5846
2024-12-07 20:43:59,278 - INFO - Image classifier Epoch 4 Train Accuracies: All 0.4199 | Old 0.6107 | New 0.3278
2024-12-07 20:44:21,151 - INFO - Weighted Accuracies: All 0.5103 | Old 0.6512 | New 0.4422
2024-12-07 20:44:21,822 - INFO - Saved model!
2024-12-07 20:45:18,127 - INFO - Epoch 6/200, Total Loss: 5.4692, Base Loss: 3.9699, Con Loss: 1.4993, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:45:18,127 - INFO -    Param Group: classifier_head, Learning Rate: 0.0998
2024-12-07 20:45:18,127 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:45:40,668 - INFO - Text classifier Epoch 5 Train Accuracies: All 0.6354 | Old 0.6472 | New 0.6297
2024-12-07 20:45:40,669 - INFO - Image classifier Epoch 5 Train Accuracies: All 0.4323 | Old 0.6427 | New 0.3307
2024-12-07 20:46:02,471 - INFO - Weighted Accuracies: All 0.5256 | Old 0.6517 | New 0.4646
2024-12-07 20:46:03,146 - INFO - Saved model!
2024-12-07 20:46:59,199 - INFO - Epoch 7/200, Total Loss: 5.2497, Base Loss: 3.7578, Con Loss: 1.4919, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:46:59,199 - INFO -    Param Group: classifier_head, Learning Rate: 0.0997
2024-12-07 20:46:59,199 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:47:20,910 - INFO - Text classifier Epoch 6 Train Accuracies: All 0.6567 | Old 0.6692 | New 0.6507
2024-12-07 20:47:20,910 - INFO - Image classifier Epoch 6 Train Accuracies: All 0.4608 | Old 0.6762 | New 0.3567
2024-12-07 20:47:43,150 - INFO - Weighted Accuracies: All 0.5369 | Old 0.6857 | New 0.4651
2024-12-07 20:47:43,822 - INFO - Saved model!
2024-12-07 20:48:40,151 - INFO - Epoch 8/200, Total Loss: 5.1049, Base Loss: 3.6251, Con Loss: 1.4798, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:48:40,151 - INFO -    Param Group: classifier_head, Learning Rate: 0.0996
2024-12-07 20:48:40,151 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:49:02,012 - INFO - Text classifier Epoch 7 Train Accuracies: All 0.6686 | Old 0.7286 | New 0.6396
2024-12-07 20:49:02,012 - INFO - Image classifier Epoch 7 Train Accuracies: All 0.4666 | Old 0.7031 | New 0.3524
2024-12-07 20:49:23,919 - INFO - Weighted Accuracies: All 0.5356 | Old 0.6717 | New 0.4699
2024-12-07 20:50:20,148 - INFO - Epoch 9/200, Total Loss: 4.9302, Base Loss: 3.4686, Con Loss: 1.4616, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:50:20,148 - INFO -    Param Group: classifier_head, Learning Rate: 0.0995
2024-12-07 20:50:20,148 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:50:42,015 - INFO - Text classifier Epoch 8 Train Accuracies: All 0.6618 | Old 0.7486 | New 0.6198
2024-12-07 20:50:42,015 - INFO - Image classifier Epoch 8 Train Accuracies: All 0.4924 | Old 0.7036 | New 0.3903
2024-12-07 20:51:03,539 - INFO - Weighted Accuracies: All 0.5539 | Old 0.6692 | New 0.4982
2024-12-07 20:51:04,208 - INFO - Saved model!
2024-12-07 20:52:00,840 - INFO - Epoch 10/200, Total Loss: 4.8385, Base Loss: 3.3977, Con Loss: 1.4409, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:52:00,841 - INFO -    Param Group: classifier_head, Learning Rate: 0.0994
2024-12-07 20:52:00,841 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:52:22,933 - INFO - Text classifier Epoch 9 Train Accuracies: All 0.6790 | Old 0.7711 | New 0.6346
2024-12-07 20:52:22,933 - INFO - Image classifier Epoch 9 Train Accuracies: All 0.4915 | Old 0.7031 | New 0.3893
2024-12-07 20:52:44,900 - INFO - Weighted Accuracies: All 0.5490 | Old 0.6572 | New 0.4967
2024-12-07 20:53:40,720 - INFO - Epoch 11/200, Total Loss: 4.7401, Base Loss: 3.3071, Con Loss: 1.4331, Pseudo Loss Image: 0.0000, Pseudo Loss Text: 0.0000
2024-12-07 20:53:40,720 - INFO -    Param Group: classifier_head, Learning Rate: 0.0993
2024-12-07 20:53:40,720 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:54:02,740 - INFO - Text classifier Epoch 10 Train Accuracies: All 0.6877 | Old 0.7881 | New 0.6392
2024-12-07 20:54:02,740 - INFO - Image classifier Epoch 10 Train Accuracies: All 0.5054 | Old 0.7071 | New 0.4079
2024-12-07 20:54:24,976 - INFO - Weighted Accuracies: All 0.5345 | Old 0.7036 | New 0.4528
2024-12-07 20:54:46,767 - INFO - len of text selected samples: 3280
2024-12-07 20:55:43,723 - INFO - Epoch 12/200, Total Loss: 7.6491, Base Loss: 3.2613, Con Loss: 1.4389, Pseudo Loss Image: 2.9488, Pseudo Loss Text: 0.0000
2024-12-07 20:55:43,723 - INFO -    Param Group: classifier_head, Learning Rate: 0.0991
2024-12-07 20:55:43,723 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:56:05,518 - INFO - Text classifier Epoch 11 Train Accuracies: All 0.6812 | Old 0.8031 | New 0.6223
2024-12-07 20:56:05,518 - INFO - Image classifier Epoch 11 Train Accuracies: All 0.5384 | Old 0.7096 | New 0.4557
2024-12-07 20:56:27,313 - INFO - Weighted Accuracies: All 0.6761 | Old 0.7851 | New 0.6235
2024-12-07 20:56:27,984 - INFO - Saved model!
2024-12-07 20:56:49,934 - INFO - len of text selected samples: 3342
2024-12-07 20:57:46,533 - INFO - Epoch 13/200, Total Loss: 6.3268, Base Loss: 3.0989, Con Loss: 1.4399, Pseudo Loss Image: 1.7879, Pseudo Loss Text: 0.0000
2024-12-07 20:57:46,533 - INFO -    Param Group: classifier_head, Learning Rate: 0.0990
2024-12-07 20:57:46,533 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 20:58:08,296 - INFO - Text classifier Epoch 12 Train Accuracies: All 0.6882 | Old 0.8116 | New 0.6285
2024-12-07 20:58:08,297 - INFO - Image classifier Epoch 12 Train Accuracies: All 0.6247 | Old 0.7896 | New 0.5450
2024-12-07 20:58:30,129 - INFO - Weighted Accuracies: All 0.7057 | Old 0.8546 | New 0.6338
2024-12-07 20:58:30,916 - INFO - Saved model!
2024-12-07 20:58:52,726 - INFO - len of text selected samples: 3338
2024-12-07 20:59:48,875 - INFO - Epoch 14/200, Total Loss: 5.8153, Base Loss: 2.9879, Con Loss: 1.4350, Pseudo Loss Image: 1.3924, Pseudo Loss Text: 0.0000
2024-12-07 20:59:48,875 - INFO -    Param Group: classifier_head, Learning Rate: 0.0988
2024-12-07 20:59:48,875 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:00:11,522 - INFO - Text classifier Epoch 13 Train Accuracies: All 0.7051 | Old 0.8556 | New 0.6324
2024-12-07 21:00:11,522 - INFO - Image classifier Epoch 13 Train Accuracies: All 0.6737 | Old 0.8461 | New 0.5904
2024-12-07 21:00:35,949 - INFO - Weighted Accuracies: All 0.7267 | Old 0.8916 | New 0.6471
2024-12-07 21:00:36,647 - INFO - Saved model!
2024-12-07 21:01:00,339 - INFO - len of text selected samples: 3346
2024-12-07 21:01:57,546 - INFO - Epoch 15/200, Total Loss: 5.5712, Base Loss: 2.9445, Con Loss: 1.4275, Pseudo Loss Image: 1.1992, Pseudo Loss Text: 0.0000
2024-12-07 21:01:57,547 - INFO -    Param Group: classifier_head, Learning Rate: 0.0986
2024-12-07 21:01:57,547 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:02:19,636 - INFO - Text classifier Epoch 14 Train Accuracies: All 0.7137 | Old 0.8541 | New 0.6459
2024-12-07 21:02:19,637 - INFO - Image classifier Epoch 14 Train Accuracies: All 0.6805 | Old 0.8206 | New 0.6128
2024-12-07 21:02:41,501 - INFO - Weighted Accuracies: All 0.7279 | Old 0.8866 | New 0.6512
2024-12-07 21:02:42,176 - INFO - Saved model!
2024-12-07 21:03:03,873 - INFO - len of text selected samples: 3356
2024-12-07 21:04:00,517 - INFO - Epoch 16/200, Total Loss: 5.3718, Base Loss: 2.9180, Con Loss: 1.4027, Pseudo Loss Image: 1.0512, Pseudo Loss Text: 0.0000
2024-12-07 21:04:00,517 - INFO -    Param Group: classifier_head, Learning Rate: 0.0984
2024-12-07 21:04:00,517 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:04:22,441 - INFO - Text classifier Epoch 15 Train Accuracies: All 0.6974 | Old 0.8241 | New 0.6363
2024-12-07 21:04:22,442 - INFO - Image classifier Epoch 15 Train Accuracies: All 0.6916 | Old 0.8536 | New 0.6133
2024-12-07 21:04:44,441 - INFO - Weighted Accuracies: All 0.7365 | Old 0.9025 | New 0.6563
2024-12-07 21:04:45,126 - INFO - Saved model!
2024-12-07 21:05:28,987 - INFO - len of image selected samples: 3462
2024-12-07 21:05:28,989 - INFO - len of text selected samples: 3383
2024-12-07 21:06:25,219 - INFO - Epoch 17/200, Total Loss: 6.5464, Base Loss: 2.8872, Con Loss: 1.4235, Pseudo Loss Image: 0.9785, Pseudo Loss Text: 1.2571
2024-12-07 21:06:25,219 - INFO -    Param Group: classifier_head, Learning Rate: 0.0982
2024-12-07 21:06:25,219 - INFO -    Param Group: base_parameters, Learning Rate: 0.0005
2024-12-07 21:06:47,284 - INFO - Text classifier Epoch 16 Train Accuracies: All 0.7788 | Old 0.8876 | New 0.7263
2024-12-07 21:06:47,284 - INFO - Image classifier Epoch 16 Train Accuracies: All 0.6916 | Old 0.8551 | New 0.6126
2024-12-07 21:07:09,753 - INFO - Weighted Accuracies: All 0.7637 | Old 0.9005 | New 0.6976
2024-12-07 21:07:10,427 - INFO - Saved model!
2024-12-07 21:07:56,832 - INFO - len of image selected samples: 3463
2024-12-07 21:07:56,835 - INFO - len of text selected samples: 3368
